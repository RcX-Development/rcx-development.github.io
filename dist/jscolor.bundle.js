/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./js/jscolor/jscolor.js":
/*!*******************************!*\
  !*** ./js/jscolor/jscolor.js ***!
  \*******************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/**\r\n * jscolor - JavaScript Color Picker\r\n *\r\n * @link    http://jscolor.com\r\n * @license For open source use: GPLv3\r\n *          For commercial use: JSColor Commercial License\r\n * @author  Jan Odvarko - East Desire\r\n * @version 2.5.2\r\n *\r\n * See usage examples at http://jscolor.com/examples/\r\n */\r\n\r\n\r\n(function (global, factory) {\r\n\r\n\t'use strict';\r\n\r\n\tif (typeof module === 'object' && typeof module.exports === 'object') {\r\n\t\t// Export jscolor as a module\r\n\t\tmodule.exports = global.document ?\r\n\t\t\tfactory (global) :\r\n\t\t\tfunction (win) {\r\n\t\t\t\tif (!win.document) {\r\n\t\t\t\t\tthrow new Error('jscolor needs a window with document');\r\n\t\t\t\t}\r\n\t\t\t\treturn factory(win);\r\n\t\t\t}\r\n\t\treturn;\r\n\t}\r\n\r\n\t// Default use (no module export)\r\n\tfactory(global);\r\n\r\n})(typeof window !== 'undefined' ? window : undefined, function (window) { // BEGIN factory\r\n\r\n// BEGIN jscolor code\r\n\r\n\r\n'use strict';\r\n\r\n\r\nvar jscolor = (function () { // BEGIN jscolor\r\n\r\nvar jsc = {\r\n\r\n\r\n\tinitialized : false,\r\n\r\n\tinstances : [], // created instances of jscolor\r\n\r\n\treadyQueue : [], // functions waiting to be called after init\r\n\r\n\r\n\tregister : function () {\r\n\t\tif (typeof window !== 'undefined' && window.document) {\r\n\t\t\tif (window.document.readyState !== 'loading') {\r\n\t\t\t\tjsc.pub.init();\r\n\t\t\t} else {\r\n\t\t\t\twindow.document.addEventListener('DOMContentLoaded', jsc.pub.init, false);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tinstallBySelector : function (selector, rootNode) {\r\n\t\trootNode = rootNode ? jsc.node(rootNode) : window.document;\r\n\t\tif (!rootNode) {\r\n\t\t\tthrow new Error('Missing root node');\r\n\t\t}\r\n\r\n\t\tvar elms = rootNode.querySelectorAll(selector);\r\n\r\n\t\t// for backward compatibility with DEPRECATED installation/configuration using className\r\n\t\tvar matchClass = new RegExp('(^|\\\\s)(' + jsc.pub.lookupClass + ')(\\\\s*(\\\\{[^}]*\\\\})|\\\\s|$)', 'i');\r\n\r\n\t\tfor (var i = 0; i < elms.length; i += 1) {\r\n\r\n\t\t\tif (elms[i].jscolor && elms[i].jscolor instanceof jsc.pub) {\r\n\t\t\t\tcontinue; // jscolor already installed on this element\r\n\t\t\t}\r\n\r\n\t\t\tif (elms[i].type !== undefined && elms[i].type.toLowerCase() == 'color' && jsc.isColorAttrSupported) {\r\n\t\t\t\tcontinue; // skips inputs of type 'color' if supported by the browser\r\n\t\t\t}\r\n\r\n\t\t\tvar dataOpts, m;\r\n\r\n\t\t\tif (\r\n\t\t\t\t(dataOpts = jsc.getDataAttr(elms[i], 'jscolor')) !== null ||\r\n\t\t\t\t(elms[i].className && (m = elms[i].className.match(matchClass))) // installation using className (DEPRECATED)\r\n\t\t\t) {\r\n\t\t\t\tvar targetElm = elms[i];\r\n\r\n\t\t\t\tvar optsStr = '';\r\n\t\t\t\tif (dataOpts !== null) {\r\n\t\t\t\t\toptsStr = dataOpts;\r\n\r\n\t\t\t\t} else if (m) { // installation using className (DEPRECATED)\r\n\t\t\t\t\tconsole.warn('Installation using class name is DEPRECATED. Use data-jscolor=\"\" attribute instead.' + jsc.docsRef);\r\n\t\t\t\t\tif (m[4]) {\r\n\t\t\t\t\t\toptsStr = m[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar opts = null;\r\n\t\t\t\tif (optsStr.trim()) {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\topts = jsc.parseOptionsStr(optsStr);\r\n\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\tconsole.warn(e + '\\n' + optsStr);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttry {\r\n\t\t\t\t\tnew jsc.pub(targetElm, opts);\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\tconsole.warn(e);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tparseOptionsStr : function (str) {\r\n\t\tvar opts = null;\r\n\r\n\t\ttry {\r\n\t\t\topts = JSON.parse(str);\r\n\r\n\t\t} catch (eParse) {\r\n\t\t\tif (!jsc.pub.looseJSON) {\r\n\t\t\t\tthrow new Error('Could not parse jscolor options as JSON: ' + eParse);\r\n\t\t\t} else {\r\n\t\t\t\t// loose JSON syntax is enabled -> try to evaluate the options string as JavaScript object\r\n\t\t\t\ttry {\r\n\t\t\t\t\topts = (new Function ('var opts = (' + str + '); return typeof opts === \"object\" ? opts : {};'))();\r\n\t\t\t\t} catch (eEval) {\r\n\t\t\t\t\tthrow new Error('Could not evaluate jscolor options: ' + eEval);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn opts;\r\n\t},\r\n\r\n\r\n\tgetInstances : function () {\r\n\t\tvar inst = [];\r\n\t\tfor (var i = 0; i < jsc.instances.length; i += 1) {\r\n\t\t\t// if the targetElement still exists, the instance is considered \"alive\"\r\n\t\t\tif (jsc.instances[i] && jsc.instances[i].targetElement) {\r\n\t\t\t\tinst.push(jsc.instances[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn inst;\r\n\t},\r\n\r\n\r\n\tcreateEl : function (tagName) {\r\n\t\tvar el = window.document.createElement(tagName);\r\n\t\tjsc.setData(el, 'gui', true);\r\n\t\treturn el;\r\n\t},\r\n\r\n\r\n\tnode : function (nodeOrSelector) {\r\n\t\tif (!nodeOrSelector) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tif (typeof nodeOrSelector === 'string') {\r\n\t\t\t// query selector\r\n\t\t\tvar sel = nodeOrSelector;\r\n\t\t\tvar el = null;\r\n\t\t\ttry {\r\n\t\t\t\tel = window.document.querySelector(sel);\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.warn(e);\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\tif (!el) {\r\n\t\t\t\tconsole.warn('No element matches the selector: %s', sel);\r\n\t\t\t}\r\n\t\t\treturn el;\r\n\t\t}\r\n\r\n\t\tif (jsc.isNode(nodeOrSelector)) {\r\n\t\t\t// DOM node\r\n\t\t\treturn nodeOrSelector;\r\n\t\t}\r\n\r\n\t\tconsole.warn('Invalid node of type %s: %s', typeof nodeOrSelector, nodeOrSelector);\r\n\t\treturn null;\r\n\t},\r\n\r\n\r\n\t// See https://stackoverflow.com/questions/384286/\r\n\tisNode : function (val) {\r\n\t\tif (typeof Node === 'object') {\r\n\t\t\treturn val instanceof Node;\r\n\t\t}\r\n\t\treturn val && typeof val === 'object' && typeof val.nodeType === 'number' && typeof val.nodeName === 'string';\r\n\t},\r\n\r\n\r\n\tnodeName : function (node) {\r\n\t\tif (node && node.nodeName) {\r\n\t\t\treturn node.nodeName.toLowerCase();\r\n\t\t}\r\n\t\treturn false;\r\n\t},\r\n\r\n\r\n\tremoveChildren : function (node) {\r\n\t\twhile (node.firstChild) {\r\n\t\t\tnode.removeChild(node.firstChild);\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tisTextInput : function (el) {\r\n\t\treturn el && jsc.nodeName(el) === 'input' && el.type.toLowerCase() === 'text';\r\n\t},\r\n\r\n\r\n\tisButton : function (el) {\r\n\t\tif (!el) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tvar n = jsc.nodeName(el);\r\n\t\treturn (\r\n\t\t\t(n === 'button') ||\r\n\t\t\t(n === 'input' && ['button', 'submit', 'reset'].indexOf(el.type.toLowerCase()) > -1)\r\n\t\t);\r\n\t},\r\n\r\n\r\n\tisButtonEmpty : function (el) {\r\n\t\tswitch (jsc.nodeName(el)) {\r\n\t\t\tcase 'input': return (!el.value || el.value.trim() === '');\r\n\t\t\tcase 'button': return (el.textContent.trim() === '');\r\n\t\t}\r\n\t\treturn null; // could not determine element's text\r\n\t},\r\n\r\n\r\n\t// See https://github.com/WICG/EventListenerOptions/blob/gh-pages/explainer.md\r\n\tisPassiveEventSupported : (function () {\r\n\t\tvar supported = false;\r\n\r\n\t\ttry {\r\n\t\t\tvar opts = Object.defineProperty({}, 'passive', {\r\n\t\t\t\tget: function () { supported = true; }\r\n\t\t\t});\r\n\t\t\twindow.addEventListener('testPassive', null, opts);\r\n\t\t\twindow.removeEventListener('testPassive', null, opts);\r\n\t\t} catch (e) {}\r\n\r\n\t\treturn supported;\r\n\t})(),\r\n\r\n\r\n\tisColorAttrSupported : (function () {\r\n\t\tvar elm = window.document.createElement('input');\r\n\t\tif (elm.setAttribute) {\r\n\t\t\telm.setAttribute('type', 'color');\r\n\t\t\tif (elm.type.toLowerCase() == 'color') {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t})(),\r\n\r\n\r\n\tdataProp : '_data_jscolor',\r\n\r\n\r\n\t// usage:\r\n\t//   setData(obj, prop, value)\r\n\t//   setData(obj, {prop:value, ...})\r\n\t//\r\n\tsetData : function () {\r\n\t\tvar obj = arguments[0];\r\n\r\n\t\tif (arguments.length === 3) {\r\n\t\t\t// setting a single property\r\n\t\t\tvar data = obj.hasOwnProperty(jsc.dataProp) ? obj[jsc.dataProp] : (obj[jsc.dataProp] = {});\r\n\t\t\tvar prop = arguments[1];\r\n\t\t\tvar value = arguments[2];\r\n\r\n\t\t\tdata[prop] = value;\r\n\t\t\treturn true;\r\n\r\n\t\t} else if (arguments.length === 2 && typeof arguments[1] === 'object') {\r\n\t\t\t// setting multiple properties\r\n\t\t\tvar data = obj.hasOwnProperty(jsc.dataProp) ? obj[jsc.dataProp] : (obj[jsc.dataProp] = {});\r\n\t\t\tvar map = arguments[1];\r\n\r\n\t\t\tfor (var prop in map) {\r\n\t\t\t\tif (map.hasOwnProperty(prop)) {\r\n\t\t\t\t\tdata[prop] = map[prop];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tthrow new Error('Invalid arguments');\r\n\t},\r\n\r\n\r\n\t// usage:\r\n\t//   removeData(obj, prop, [prop...])\r\n\t//\r\n\tremoveData : function () {\r\n\t\tvar obj = arguments[0];\r\n\t\tif (!obj.hasOwnProperty(jsc.dataProp)) {\r\n\t\t\treturn true; // data object does not exist\r\n\t\t}\r\n\t\tfor (var i = 1; i < arguments.length; i += 1) {\r\n\t\t\tvar prop = arguments[i];\r\n\t\t\tdelete obj[jsc.dataProp][prop];\r\n\t\t}\r\n\t\treturn true;\r\n\t},\r\n\r\n\r\n\tgetData : function (obj, prop, setDefault) {\r\n\t\tif (!obj.hasOwnProperty(jsc.dataProp)) {\r\n\t\t\t// data object does not exist\r\n\t\t\tif (setDefault !== undefined) {\r\n\t\t\t\tobj[jsc.dataProp] = {}; // create data object\r\n\t\t\t} else {\r\n\t\t\t\treturn undefined; // no value to return\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar data = obj[jsc.dataProp];\r\n\r\n\t\tif (!data.hasOwnProperty(prop) && setDefault !== undefined) {\r\n\t\t\tdata[prop] = setDefault;\r\n\t\t}\r\n\t\treturn data[prop];\r\n\t},\r\n\r\n\r\n\tgetDataAttr : function (el, name) {\r\n\t\tvar attrName = 'data-' + name;\r\n\t\tvar attrValue = el.getAttribute(attrName);\r\n\t\treturn attrValue;\r\n\t},\r\n\r\n\r\n\tsetDataAttr : function (el, name, value) {\r\n\t\tvar attrName = 'data-' + name;\r\n\t\tel.setAttribute(attrName, value);\r\n\t},\r\n\r\n\r\n\t_attachedGroupEvents : {},\r\n\r\n\r\n\tattachGroupEvent : function (groupName, el, evnt, func) {\r\n\t\tif (!jsc._attachedGroupEvents.hasOwnProperty(groupName)) {\r\n\t\t\tjsc._attachedGroupEvents[groupName] = [];\r\n\t\t}\r\n\t\tjsc._attachedGroupEvents[groupName].push([el, evnt, func]);\r\n\t\tel.addEventListener(evnt, func, false);\r\n\t},\r\n\r\n\r\n\tdetachGroupEvents : function (groupName) {\r\n\t\tif (jsc._attachedGroupEvents.hasOwnProperty(groupName)) {\r\n\t\t\tfor (var i = 0; i < jsc._attachedGroupEvents[groupName].length; i += 1) {\r\n\t\t\t\tvar evt = jsc._attachedGroupEvents[groupName][i];\r\n\t\t\t\tevt[0].removeEventListener(evt[1], evt[2], false);\r\n\t\t\t}\r\n\t\t\tdelete jsc._attachedGroupEvents[groupName];\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tpreventDefault : function (e) {\r\n\t\tif (e.preventDefault) { e.preventDefault(); }\r\n\t\te.returnValue = false;\r\n\t},\r\n\r\n\r\n\ttriggerEvent : function (el, eventName, bubbles, cancelable) {\r\n\t\tif (!el) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar ev = null;\r\n\r\n\t\tif (typeof Event === 'function') {\r\n\t\t\tev = new Event(eventName, {\r\n\t\t\t\tbubbles: bubbles,\r\n\t\t\t\tcancelable: cancelable\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\t// IE\r\n\t\t\tev = window.document.createEvent('Event');\r\n\t\t\tev.initEvent(eventName, bubbles, cancelable);\r\n\t\t}\r\n\r\n\t\tif (!ev) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t// so that we know that the event was triggered internally\r\n\t\tjsc.setData(ev, 'internal', true);\r\n\r\n\t\tel.dispatchEvent(ev);\r\n\t\treturn true;\r\n\t},\r\n\r\n\r\n\ttriggerInputEvent : function (el, eventName, bubbles, cancelable) {\r\n\t\tif (!el) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (jsc.isTextInput(el)) {\r\n\t\t\tjsc.triggerEvent(el, eventName, bubbles, cancelable);\r\n\t\t}\r\n\t},\r\n\r\n\r\n\teventKey : function (ev) {\r\n\t\tvar keys = {\r\n\t\t\t9: 'Tab',\r\n\t\t\t13: 'Enter',\r\n\t\t\t27: 'Escape',\r\n\t\t};\r\n\t\tif (typeof ev.code === 'string') {\r\n\t\t\treturn ev.code;\r\n\t\t} else if (ev.keyCode !== undefined && keys.hasOwnProperty(ev.keyCode)) {\r\n\t\t\treturn keys[ev.keyCode];\r\n\t\t}\r\n\t\treturn null;\r\n\t},\r\n\r\n\r\n\tstrList : function (str) {\r\n\t\tif (!str) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\t\treturn str.replace(/^\\s+|\\s+$/g, '').split(/\\s+/);\r\n\t},\r\n\r\n\r\n\t// The className parameter (str) can only contain a single class name\r\n\thasClass : function (elm, className) {\r\n\t\tif (!className) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tif (elm.classList !== undefined) {\r\n\t\t\treturn elm.classList.contains(className);\r\n\t\t}\r\n\t\t// polyfill\r\n\t\treturn -1 != (' ' + elm.className.replace(/\\s+/g, ' ') + ' ').indexOf(' ' + className + ' ');\r\n\t},\r\n\r\n\r\n\t// The className parameter (str) can contain multiple class names separated by whitespace\r\n\taddClass : function (elm, className) {\r\n\t\tvar classNames = jsc.strList(className);\r\n\r\n\t\tif (elm.classList !== undefined) {\r\n\t\t\tfor (var i = 0; i < classNames.length; i += 1) {\r\n\t\t\t\telm.classList.add(classNames[i]);\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t// polyfill\r\n\t\tfor (var i = 0; i < classNames.length; i += 1) {\r\n\t\t\tif (!jsc.hasClass(elm, classNames[i])) {\r\n\t\t\t\telm.className += (elm.className ? ' ' : '') + classNames[i];\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\r\n\t// The className parameter (str) can contain multiple class names separated by whitespace\r\n\tremoveClass : function (elm, className) {\r\n\t\tvar classNames = jsc.strList(className);\r\n\r\n\t\tif (elm.classList !== undefined) {\r\n\t\t\tfor (var i = 0; i < classNames.length; i += 1) {\r\n\t\t\t\telm.classList.remove(classNames[i]);\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t// polyfill\r\n\t\tfor (var i = 0; i < classNames.length; i += 1) {\r\n\t\t\tvar repl = new RegExp(\r\n\t\t\t\t'^\\\\s*' + classNames[i] + '\\\\s*|' +\r\n\t\t\t\t'\\\\s*' + classNames[i] + '\\\\s*$|' +\r\n\t\t\t\t'\\\\s+' + classNames[i] + '(\\\\s+)',\r\n\t\t\t\t'g'\r\n\t\t\t);\r\n\t\t\telm.className = elm.className.replace(repl, '$1');\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tgetCompStyle : function (elm) {\r\n\t\tvar compStyle = window.getComputedStyle ? window.getComputedStyle(elm) : elm.currentStyle;\r\n\r\n\t\t// Note: In Firefox, getComputedStyle returns null in a hidden iframe,\r\n\t\t// that's why we need to check if the returned value is non-empty\r\n\t\tif (!compStyle) {\r\n\t\t\treturn {};\r\n\t\t}\r\n\t\treturn compStyle;\r\n\t},\r\n\r\n\r\n\t// Note:\r\n\t//   Setting a property to NULL reverts it to the state before it was first set\r\n\t//   with the 'reversible' flag enabled\r\n\t//\r\n\tsetStyle : function (elm, styles, important, reversible) {\r\n\t\t// using '' for standard priority (IE10 apparently doesn't like value undefined)\r\n\t\tvar priority = important ? 'important' : '';\r\n\t\tvar origStyle = null;\r\n\r\n\t\tfor (var prop in styles) {\r\n\t\t\tif (styles.hasOwnProperty(prop)) {\r\n\t\t\t\tvar setVal = null;\r\n\r\n\t\t\t\tif (styles[prop] === null) {\r\n\t\t\t\t\t// reverting a property value\r\n\r\n\t\t\t\t\tif (!origStyle) {\r\n\t\t\t\t\t\t// get the original style object, but dont't try to create it if it doesn't exist\r\n\t\t\t\t\t\torigStyle = jsc.getData(elm, 'origStyle');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (origStyle && origStyle.hasOwnProperty(prop)) {\r\n\t\t\t\t\t\t// we have property's original value -> use it\r\n\t\t\t\t\t\tsetVal = origStyle[prop];\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// setting a property value\r\n\r\n\t\t\t\t\tif (reversible) {\r\n\t\t\t\t\t\tif (!origStyle) {\r\n\t\t\t\t\t\t\t// get the original style object and if it doesn't exist, create it\r\n\t\t\t\t\t\t\torigStyle = jsc.getData(elm, 'origStyle', {});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!origStyle.hasOwnProperty(prop)) {\r\n\t\t\t\t\t\t\t// original property value not yet stored -> store it\r\n\t\t\t\t\t\t\torigStyle[prop] = elm.style[prop];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsetVal = styles[prop];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (setVal !== null) {\r\n\t\t\t\t\telm.style.setProperty(prop, setVal, priority);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tappendCss : function (css) {\r\n\t\tvar head = document.querySelector('head');\r\n\t\tvar style = document.createElement('style');\r\n\t\tstyle.innerText = css;\r\n\t\thead.appendChild(style);\r\n\t},\r\n\r\n\r\n\tappendDefaultCss : function (css) {\r\n\t\tjsc.appendCss(\r\n\t\t\t[\r\n\t\t\t\t'.jscolor-wrap, .jscolor-wrap div, .jscolor-wrap canvas { ' +\r\n\t\t\t\t'position:static; display:block; visibility:visible; overflow:visible; margin:0; padding:0; ' +\r\n\t\t\t\t'border:none; border-radius:0; outline:none; z-index:auto; float:none; ' +\r\n\t\t\t\t'width:auto; height:auto; left:auto; right:auto; top:auto; bottom:auto; min-width:0; min-height:0; max-width:none; max-height:none; ' +\r\n\t\t\t\t'background:none; clip:auto; opacity:1; transform:none; box-shadow:none; box-sizing:content-box; ' +\r\n\t\t\t\t'}',\r\n\t\t\t\t'.jscolor-wrap { clear:both; }',\r\n\t\t\t\t'.jscolor-wrap .jscolor-picker { position:relative; }',\r\n\t\t\t\t'.jscolor-wrap .jscolor-shadow { position:absolute; left:0; top:0; width:100%; height:100%; }',\r\n\t\t\t\t'.jscolor-wrap .jscolor-border { position:relative; }',\r\n\t\t\t\t'.jscolor-wrap .jscolor-palette { position:absolute; }',\r\n\t\t\t\t'.jscolor-wrap .jscolor-palette-sw { position:absolute; display:block; cursor:pointer; }',\r\n\t\t\t\t'.jscolor-wrap .jscolor-btn { position:absolute; overflow:hidden; white-space:nowrap; font:13px sans-serif; text-align:center; cursor:pointer; }',\r\n\t\t\t].join('\\n')\r\n\t\t);\r\n\t},\r\n\r\n\r\n\thexColor : function (r, g, b) {\r\n\t\treturn '#' + (\r\n\t\t\t('0' + Math.round(r).toString(16)).slice(-2) +\r\n\t\t\t('0' + Math.round(g).toString(16)).slice(-2) +\r\n\t\t\t('0' + Math.round(b).toString(16)).slice(-2)\r\n\t\t).toUpperCase();\r\n\t},\r\n\r\n\r\n\thexaColor : function (r, g, b, a) {\r\n\t\treturn '#' + (\r\n\t\t\t('0' + Math.round(r).toString(16)).slice(-2) +\r\n\t\t\t('0' + Math.round(g).toString(16)).slice(-2) +\r\n\t\t\t('0' + Math.round(b).toString(16)).slice(-2) +\r\n\t\t\t('0' + Math.round(a * 255).toString(16)).slice(-2)\r\n\t\t).toUpperCase();\r\n\t},\r\n\r\n\r\n\trgbColor : function (r, g, b) {\r\n\t\treturn 'rgb(' +\r\n\t\t\tMath.round(r) + ',' +\r\n\t\t\tMath.round(g) + ',' +\r\n\t\t\tMath.round(b) +\r\n\t\t')';\r\n\t},\r\n\r\n\r\n\trgbaColor : function (r, g, b, a) {\r\n\t\treturn 'rgba(' +\r\n\t\t\tMath.round(r) + ',' +\r\n\t\t\tMath.round(g) + ',' +\r\n\t\t\tMath.round(b) + ',' +\r\n\t\t\t(Math.round((a===undefined || a===null ? 1 : a) * 100) / 100) +\r\n\t\t')';\r\n\t},\r\n\r\n\r\n\tlinearGradient : (function () {\r\n\r\n\t\tfunction getFuncName () {\r\n\t\t\tvar stdName = 'linear-gradient';\r\n\t\t\tvar prefixes = ['', '-webkit-', '-moz-', '-o-', '-ms-'];\r\n\t\t\tvar helper = window.document.createElement('div');\r\n\r\n\t\t\tfor (var i = 0; i < prefixes.length; i += 1) {\r\n\t\t\t\tvar tryFunc = prefixes[i] + stdName;\r\n\t\t\t\tvar tryVal = tryFunc + '(to right, rgba(0,0,0,0), rgba(0,0,0,0))';\r\n\r\n\t\t\t\thelper.style.background = tryVal;\r\n\t\t\t\tif (helper.style.background) { // CSS background successfully set -> function name is supported\r\n\t\t\t\t\treturn tryFunc;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn stdName; // fallback to standard 'linear-gradient' without vendor prefix\r\n\t\t}\r\n\r\n\t\tvar funcName = getFuncName();\r\n\r\n\t\treturn function () {\r\n\t\t\treturn funcName + '(' + Array.prototype.join.call(arguments, ', ') + ')';\r\n\t\t};\r\n\r\n\t})(),\r\n\r\n\r\n\tsetBorderRadius : function (elm, value) {\r\n\t\tjsc.setStyle(elm, {'border-radius' : value || '0'});\r\n\t},\r\n\r\n\r\n\tsetBoxShadow : function (elm, value) {\r\n\t\tjsc.setStyle(elm, {'box-shadow': value || 'none'});\r\n\t},\r\n\r\n\r\n\tgetElementPos : function (e, relativeToViewport) {\r\n\t\tvar x=0, y=0;\r\n\t\tvar rect = e.getBoundingClientRect();\r\n\t\tx = rect.left;\r\n\t\ty = rect.top;\r\n\t\tif (!relativeToViewport) {\r\n\t\t\tvar viewPos = jsc.getViewPos();\r\n\t\t\tx += viewPos[0];\r\n\t\t\ty += viewPos[1];\r\n\t\t}\r\n\t\treturn [x, y];\r\n\t},\r\n\r\n\r\n\tgetElementSize : function (e) {\r\n\t\treturn [e.offsetWidth, e.offsetHeight];\r\n\t},\r\n\r\n\r\n\t// get pointer's X/Y coordinates relative to viewport\r\n\tgetAbsPointerPos : function (e) {\r\n\t\tvar x = 0, y = 0;\r\n\t\tif (typeof e.changedTouches !== 'undefined' && e.changedTouches.length) {\r\n\t\t\t// touch devices\r\n\t\t\tx = e.changedTouches[0].clientX;\r\n\t\t\ty = e.changedTouches[0].clientY;\r\n\t\t} else if (typeof e.clientX === 'number') {\r\n\t\t\tx = e.clientX;\r\n\t\t\ty = e.clientY;\r\n\t\t}\r\n\t\treturn { x: x, y: y };\r\n\t},\r\n\r\n\r\n\t// get pointer's X/Y coordinates relative to target element\r\n\tgetRelPointerPos : function (e) {\r\n\t\tvar target = e.target || e.srcElement;\r\n\t\tvar targetRect = target.getBoundingClientRect();\r\n\r\n\t\tvar x = 0, y = 0;\r\n\r\n\t\tvar clientX = 0, clientY = 0;\r\n\t\tif (typeof e.changedTouches !== 'undefined' && e.changedTouches.length) {\r\n\t\t\t// touch devices\r\n\t\t\tclientX = e.changedTouches[0].clientX;\r\n\t\t\tclientY = e.changedTouches[0].clientY;\r\n\t\t} else if (typeof e.clientX === 'number') {\r\n\t\t\tclientX = e.clientX;\r\n\t\t\tclientY = e.clientY;\r\n\t\t}\r\n\r\n\t\tx = clientX - targetRect.left;\r\n\t\ty = clientY - targetRect.top;\r\n\t\treturn { x: x, y: y };\r\n\t},\r\n\r\n\r\n\tgetViewPos : function () {\r\n\t\tvar doc = window.document.documentElement;\r\n\t\treturn [\r\n\t\t\t(window.pageXOffset || doc.scrollLeft) - (doc.clientLeft || 0),\r\n\t\t\t(window.pageYOffset || doc.scrollTop) - (doc.clientTop || 0)\r\n\t\t];\r\n\t},\r\n\r\n\r\n\tgetViewSize : function () {\r\n\t\tvar doc = window.document.documentElement;\r\n\t\treturn [\r\n\t\t\t(window.innerWidth || doc.clientWidth),\r\n\t\t\t(window.innerHeight || doc.clientHeight),\r\n\t\t];\r\n\t},\r\n\r\n\r\n\t// r: 0-255\r\n\t// g: 0-255\r\n\t// b: 0-255\r\n\t//\r\n\t// returns: [ 0-360, 0-100, 0-100 ]\r\n\t//\r\n\tRGB_HSV : function (r, g, b) {\r\n\t\tr /= 255;\r\n\t\tg /= 255;\r\n\t\tb /= 255;\r\n\t\tvar n = Math.min(Math.min(r,g),b);\r\n\t\tvar v = Math.max(Math.max(r,g),b);\r\n\t\tvar m = v - n;\r\n\t\tif (m === 0) { return [ null, 0, 100 * v ]; }\r\n\t\tvar h = r===n ? 3+(b-g)/m : (g===n ? 5+(r-b)/m : 1+(g-r)/m);\r\n\t\treturn [\r\n\t\t\t60 * (h===6?0:h),\r\n\t\t\t100 * (m/v),\r\n\t\t\t100 * v\r\n\t\t];\r\n\t},\r\n\r\n\r\n\t// h: 0-360\r\n\t// s: 0-100\r\n\t// v: 0-100\r\n\t//\r\n\t// returns: [ 0-255, 0-255, 0-255 ]\r\n\t//\r\n\tHSV_RGB : function (h, s, v) {\r\n\t\tvar u = 255 * (v / 100);\r\n\r\n\t\tif (h === null) {\r\n\t\t\treturn [ u, u, u ];\r\n\t\t}\r\n\r\n\t\th /= 60;\r\n\t\ts /= 100;\r\n\r\n\t\tvar i = Math.floor(h);\r\n\t\tvar f = i%2 ? h-i : 1-(h-i);\r\n\t\tvar m = u * (1 - s);\r\n\t\tvar n = u * (1 - s * f);\r\n\t\tswitch (i) {\r\n\t\t\tcase 6:\r\n\t\t\tcase 0: return [u,n,m];\r\n\t\t\tcase 1: return [n,u,m];\r\n\t\t\tcase 2: return [m,u,n];\r\n\t\t\tcase 3: return [m,n,u];\r\n\t\t\tcase 4: return [n,m,u];\r\n\t\t\tcase 5: return [u,m,n];\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tparseColorString : function (str) {\r\n\t\tvar ret = {\r\n\t\t\trgba: null,\r\n\t\t\tformat: null // 'hex' | 'hexa' | 'rgb' | 'rgba'\r\n\t\t};\r\n\r\n\t\tvar m;\r\n\r\n\t\tif (m = str.match(/^\\W*([0-9A-F]{3,8})\\W*$/i)) {\r\n\t\t\t// HEX notation\r\n\r\n\t\t\tif (m[1].length === 8) {\r\n\t\t\t\t// 8-char notation (= with alpha)\r\n\t\t\t\tret.format = 'hexa';\r\n\t\t\t\tret.rgba = [\r\n\t\t\t\t\tparseInt(m[1].slice(0,2),16),\r\n\t\t\t\t\tparseInt(m[1].slice(2,4),16),\r\n\t\t\t\t\tparseInt(m[1].slice(4,6),16),\r\n\t\t\t\t\tparseInt(m[1].slice(6,8),16) / 255\r\n\t\t\t\t];\r\n\r\n\t\t\t} else if (m[1].length === 6) {\r\n\t\t\t\t// 6-char notation\r\n\t\t\t\tret.format = 'hex';\r\n\t\t\t\tret.rgba = [\r\n\t\t\t\t\tparseInt(m[1].slice(0,2),16),\r\n\t\t\t\t\tparseInt(m[1].slice(2,4),16),\r\n\t\t\t\t\tparseInt(m[1].slice(4,6),16),\r\n\t\t\t\t\tnull\r\n\t\t\t\t];\r\n\r\n\t\t\t} else if (m[1].length === 3) {\r\n\t\t\t\t// 3-char notation\r\n\t\t\t\tret.format = 'hex';\r\n\t\t\t\tret.rgba = [\r\n\t\t\t\t\tparseInt(m[1].charAt(0) + m[1].charAt(0),16),\r\n\t\t\t\t\tparseInt(m[1].charAt(1) + m[1].charAt(1),16),\r\n\t\t\t\t\tparseInt(m[1].charAt(2) + m[1].charAt(2),16),\r\n\t\t\t\t\tnull\r\n\t\t\t\t];\r\n\r\n\t\t\t} else {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\treturn ret;\r\n\t\t}\r\n\r\n\t\tif (m = str.match(/^\\W*rgba?\\(([^)]*)\\)\\W*$/i)) {\r\n\t\t\t// rgb(...) or rgba(...) notation\r\n\r\n\t\t\tvar par = m[1].split(',');\r\n\t\t\tvar re = /^\\s*(\\d+|\\d*\\.\\d+|\\d+\\.\\d*)\\s*$/;\r\n\t\t\tvar mR, mG, mB, mA;\r\n\t\t\tif (\r\n\t\t\t\tpar.length >= 3 &&\r\n\t\t\t\t(mR = par[0].match(re)) &&\r\n\t\t\t\t(mG = par[1].match(re)) &&\r\n\t\t\t\t(mB = par[2].match(re))\r\n\t\t\t) {\r\n\t\t\t\tret.format = 'rgb';\r\n\t\t\t\tret.rgba = [\r\n\t\t\t\t\tparseFloat(mR[1]) || 0,\r\n\t\t\t\t\tparseFloat(mG[1]) || 0,\r\n\t\t\t\t\tparseFloat(mB[1]) || 0,\r\n\t\t\t\t\tnull\r\n\t\t\t\t];\r\n\r\n\t\t\t\tif (\r\n\t\t\t\t\tpar.length >= 4 &&\r\n\t\t\t\t\t(mA = par[3].match(re))\r\n\t\t\t\t) {\r\n\t\t\t\t\tret.format = 'rgba';\r\n\t\t\t\t\tret.rgba[3] = parseFloat(mA[1]) || 0;\r\n\t\t\t\t}\r\n\t\t\t\treturn ret;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t},\r\n\r\n\r\n\tparsePaletteValue : function (mixed) {\r\n\t\tvar vals = [];\r\n\r\n\t\tif (typeof mixed === 'string') { // input is a string of space separated color values\r\n\t\t\t// rgb() and rgba() may contain spaces too, so let's find all color values by regex\r\n\t\t\tmixed.replace(/#[0-9A-F]{3}\\b|#[0-9A-F]{6}([0-9A-F]{2})?\\b|rgba?\\(([^)]*)\\)/ig, function (val) {\r\n\t\t\t\tvals.push(val);\r\n\t\t\t});\r\n\t\t} else if (Array.isArray(mixed)) { // input is an array of color values\r\n\t\t\tvals = mixed;\r\n\t\t}\r\n\r\n\t\t// convert all values into uniform color format\r\n\r\n\t\tvar colors = [];\r\n\r\n\t\tfor (var i = 0; i < vals.length; i++) {\r\n\t\t\tvar color = jsc.parseColorString(vals[i]);\r\n\t\t\tif (color) {\r\n\t\t\t\tcolors.push(color);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn colors;\r\n\t},\r\n\r\n\r\n\tcontainsTranparentColor : function (colors) {\r\n\t\tfor (var i = 0; i < colors.length; i++) {\r\n\t\t\tvar a = colors[i].rgba[3];\r\n\t\t\tif (a !== null && a < 1.0) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t},\r\n\r\n\r\n\tisAlphaFormat : function (format) {\r\n\t\tswitch (format.toLowerCase()) {\r\n\t\tcase 'hexa':\r\n\t\tcase 'rgba':\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t},\r\n\r\n\r\n\t// Canvas scaling for retina displays\r\n\t//\r\n\t// adapted from https://www.html5rocks.com/en/tutorials/canvas/hidpi/\r\n\t//\r\n\tscaleCanvasForHighDPR : function (canvas) {\r\n\t\tvar dpr = window.devicePixelRatio || 1;\r\n\t\tcanvas.width *= dpr;\r\n\t\tcanvas.height *= dpr;\r\n\t\tvar ctx = canvas.getContext('2d');\r\n\t\tctx.scale(dpr, dpr);\r\n\t},\r\n\r\n\r\n\tgenColorPreviewCanvas : function (color, separatorPos, specWidth, scaleForHighDPR) {\r\n\r\n\t\tvar sepW = Math.round(jsc.pub.previewSeparator.length);\r\n\t\tvar sqSize = jsc.pub.chessboardSize;\r\n\t\tvar sqColor1 = jsc.pub.chessboardColor1;\r\n\t\tvar sqColor2 = jsc.pub.chessboardColor2;\r\n\r\n\t\tvar cWidth = specWidth ? specWidth : sqSize * 2;\r\n\t\tvar cHeight = sqSize * 2;\r\n\r\n\t\tvar canvas = jsc.createEl('canvas');\r\n\t\tvar ctx = canvas.getContext('2d');\r\n\r\n\t\tcanvas.width = cWidth;\r\n\t\tcanvas.height = cHeight;\r\n\t\tif (scaleForHighDPR) {\r\n\t\t\tjsc.scaleCanvasForHighDPR(canvas);\r\n\t\t}\r\n\r\n\t\t// transparency chessboard - background\r\n\t\tctx.fillStyle = sqColor1;\r\n\t\tctx.fillRect(0, 0, cWidth, cHeight);\r\n\r\n\t\t// transparency chessboard - squares\r\n\t\tctx.fillStyle = sqColor2;\r\n\t\tfor (var x = 0; x < cWidth; x += sqSize * 2) {\r\n\t\t\tctx.fillRect(x, 0, sqSize, sqSize);\r\n\t\t\tctx.fillRect(x + sqSize, sqSize, sqSize, sqSize);\r\n\t\t}\r\n\r\n\t\tif (color) {\r\n\t\t\t// actual color in foreground\r\n\t\t\tctx.fillStyle = color;\r\n\t\t\tctx.fillRect(0, 0, cWidth, cHeight);\r\n\t\t}\r\n\r\n\t\tvar start = null;\r\n\t\tswitch (separatorPos) {\r\n\t\t\tcase 'left':\r\n\t\t\t\tstart = 0;\r\n\t\t\t\tctx.clearRect(0, 0, sepW/2, cHeight);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'right':\r\n\t\t\t\tstart = cWidth - sepW;\r\n\t\t\t\tctx.clearRect(cWidth - (sepW/2), 0, sepW/2, cHeight);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\tif (start !== null) {\r\n\t\t\tctx.lineWidth = 1;\r\n\t\t\tfor (var i = 0; i < jsc.pub.previewSeparator.length; i += 1) {\r\n\t\t\t\tctx.beginPath();\r\n\t\t\t\tctx.strokeStyle = jsc.pub.previewSeparator[i];\r\n\t\t\t\tctx.moveTo(0.5 + start + i, 0);\r\n\t\t\t\tctx.lineTo(0.5 + start + i, cHeight);\r\n\t\t\t\tctx.stroke();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tcanvas: canvas,\r\n\t\t\twidth: cWidth,\r\n\t\t\theight: cHeight,\r\n\t\t};\r\n\t},\r\n\r\n\r\n\t// if position or width is not set => fill the entire element (0%-100%)\r\n\tgenColorPreviewGradient : function (color, position, width) {\r\n\t\tvar params = [];\r\n\r\n\t\tif (position && width) {\r\n\t\t\tparams = [\r\n\t\t\t\t'to ' + {'left':'right', 'right':'left'}[position],\r\n\t\t\t\tcolor + ' 0%',\r\n\t\t\t\tcolor + ' ' + width + 'px',\r\n\t\t\t\t'rgba(0,0,0,0) ' + (width + 1) + 'px',\r\n\t\t\t\t'rgba(0,0,0,0) 100%',\r\n\t\t\t];\r\n\t\t} else {\r\n\t\t\tparams = [\r\n\t\t\t\t'to right',\r\n\t\t\t\tcolor + ' 0%',\r\n\t\t\t\tcolor + ' 100%',\r\n\t\t\t];\r\n\t\t}\r\n\r\n\t\treturn jsc.linearGradient.apply(this, params);\r\n\t},\r\n\r\n\r\n\tredrawPosition : function () {\r\n\r\n\t\tif (!jsc.picker || !jsc.picker.owner) {\r\n\t\t\treturn; // picker is not shown\r\n\t\t}\r\n\r\n\t\tvar thisObj = jsc.picker.owner;\r\n\r\n\t\tif (thisObj.container !== window.document.body) {\r\n\r\n\t\t\tjsc._drawPosition(thisObj, 0, 0, 'relative', false);\r\n\r\n\t\t} else {\r\n\r\n\t\t\tvar tp, vp;\r\n\r\n\t\t\tif (thisObj.fixed) {\r\n\t\t\t\t// Fixed elements are positioned relative to viewport,\r\n\t\t\t\t// therefore we can ignore the scroll offset\r\n\t\t\t\ttp = jsc.getElementPos(thisObj.targetElement, true); // target pos\r\n\t\t\t\tvp = [0, 0]; // view pos\r\n\t\t\t} else {\r\n\t\t\t\ttp = jsc.getElementPos(thisObj.targetElement); // target pos\r\n\t\t\t\tvp = jsc.getViewPos(); // view pos\r\n\t\t\t}\r\n\r\n\t\t\tvar ts = jsc.getElementSize(thisObj.targetElement); // target size\r\n\t\t\tvar vs = jsc.getViewSize(); // view size\r\n\t\t\tvar pd = jsc.getPickerDims(thisObj);\r\n\t\t\tvar ps = [pd.borderW, pd.borderH]; // picker outer size\r\n\t\t\tvar a, b, c;\r\n\t\t\tswitch (thisObj.position.toLowerCase()) {\r\n\t\t\t\tcase 'left': a=1; b=0; c=-1; break;\r\n\t\t\t\tcase 'right':a=1; b=0; c=1; break;\r\n\t\t\t\tcase 'top':  a=0; b=1; c=-1; break;\r\n\t\t\t\tdefault:     a=0; b=1; c=1; break;\r\n\t\t\t}\r\n\t\t\tvar l = (ts[b]+ps[b])/2;\r\n\r\n\t\t\t// compute picker position\r\n\t\t\tif (!thisObj.smartPosition) {\r\n\t\t\t\tvar pp = [\r\n\t\t\t\t\ttp[a],\r\n\t\t\t\t\ttp[b]+ts[b]-l+l*c\r\n\t\t\t\t];\r\n\t\t\t} else {\r\n\t\t\t\tvar pp = [\r\n\t\t\t\t\t-vp[a]+tp[a]+ps[a] > vs[a] ?\r\n\t\t\t\t\t\t(-vp[a]+tp[a]+ts[a]/2 > vs[a]/2 && tp[a]+ts[a]-ps[a] >= 0 ? tp[a]+ts[a]-ps[a] : tp[a]) :\r\n\t\t\t\t\t\ttp[a],\r\n\t\t\t\t\t-vp[b]+tp[b]+ts[b]+ps[b]-l+l*c > vs[b] ?\r\n\t\t\t\t\t\t(-vp[b]+tp[b]+ts[b]/2 > vs[b]/2 && tp[b]+ts[b]-l-l*c >= 0 ? tp[b]+ts[b]-l-l*c : tp[b]+ts[b]-l+l*c) :\r\n\t\t\t\t\t\t(tp[b]+ts[b]-l+l*c >= 0 ? tp[b]+ts[b]-l+l*c : tp[b]+ts[b]-l-l*c)\r\n\t\t\t\t];\r\n\t\t\t}\r\n\r\n\t\t\tvar x = pp[a];\r\n\t\t\tvar y = pp[b];\r\n\t\t\tvar positionValue = thisObj.fixed ? 'fixed' : 'absolute';\r\n\t\t\tvar contractShadow =\r\n\t\t\t\t(pp[0] + ps[0] > tp[0] || pp[0] < tp[0] + ts[0]) &&\r\n\t\t\t\t(pp[1] + ps[1] < tp[1] + ts[1]);\r\n\r\n\t\t\tjsc._drawPosition(thisObj, x, y, positionValue, contractShadow);\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\r\n\t_drawPosition : function (thisObj, x, y, positionValue, contractShadow) {\r\n\t\tvar vShadow = contractShadow ? 0 : thisObj.shadowBlur; // px\r\n\r\n\t\tjsc.picker.wrap.style.position = positionValue;\r\n\r\n\t\tif ( // To avoid unnecessary repositioning during scroll\r\n\t\t\tMath.round(parseFloat(jsc.picker.wrap.style.left)) !== Math.round(x) ||\r\n\t\t\tMath.round(parseFloat(jsc.picker.wrap.style.top)) !== Math.round(y)\r\n\t\t) {\r\n\t\t\tjsc.picker.wrap.style.left = x + 'px';\r\n\t\t\tjsc.picker.wrap.style.top = y + 'px';\r\n\t\t}\r\n\r\n\t\tjsc.setBoxShadow(\r\n\t\t\tjsc.picker.boxS,\r\n\t\t\tthisObj.shadow ?\r\n\t\t\t\tnew jsc.BoxShadow(0, vShadow, thisObj.shadowBlur, 0, thisObj.shadowColor) :\r\n\t\t\t\tnull);\r\n\t},\r\n\r\n\r\n\tgetPickerDims : function (thisObj) {\r\n\t\tvar w = 2 * thisObj.controlBorderWidth + thisObj.width;\r\n\t\tvar h = 2 * thisObj.controlBorderWidth + thisObj.height;\r\n\r\n\t\tvar sliderSpace = 2 * thisObj.controlBorderWidth + 2 * jsc.getControlPadding(thisObj) + thisObj.sliderSize;\r\n\r\n\t\tif (jsc.getSliderChannel(thisObj)) {\r\n\t\t\tw += sliderSpace;\r\n\t\t}\r\n\t\tif (thisObj.hasAlphaChannel()) {\r\n\t\t\tw += sliderSpace;\r\n\t\t}\r\n\r\n\t\tvar pal = jsc.getPaletteDims(thisObj, w);\r\n\r\n\t\tif (pal.height) {\r\n\t\t\th += pal.height + thisObj.padding;\r\n\t\t}\r\n\t\tif (thisObj.closeButton) {\r\n\t\t\th += 2 * thisObj.controlBorderWidth + thisObj.padding + thisObj.buttonHeight;\r\n\t\t}\r\n\r\n\t\tvar pW = w + (2 * thisObj.padding);\r\n\t\tvar pH = h + (2 * thisObj.padding);\r\n\r\n\t\treturn {\r\n\t\t\tcontentW: w,\r\n\t\t\tcontentH: h,\r\n\t\t\tpaddedW: pW,\r\n\t\t\tpaddedH: pH,\r\n\t\t\tborderW: pW + (2 * thisObj.borderWidth),\r\n\t\t\tborderH: pH + (2 * thisObj.borderWidth),\r\n\t\t\tpalette: pal,\r\n\t\t};\r\n\t},\r\n\r\n\r\n\tgetPaletteDims : function (thisObj, width) {\r\n\t\tvar cols = 0, rows = 0, cellW = 0, cellH = 0, height = 0;\r\n\t\tvar sampleCount = thisObj._palette ? thisObj._palette.length : 0;\r\n\r\n\t\tif (sampleCount) {\r\n\t\t\tcols = thisObj.paletteCols;\r\n\t\t\trows = cols > 0 ? Math.ceil(sampleCount / cols) : 0;\r\n\r\n\t\t\t// color sample's dimensions (includes border)\r\n\t\t\tcellW = Math.max(1, Math.floor((width - ((cols - 1) * thisObj.paletteSpacing)) / cols));\r\n\t\t\tcellH = thisObj.paletteHeight ? Math.min(thisObj.paletteHeight, cellW) : cellW;\r\n\t\t}\r\n\r\n\t\tif (rows) {\r\n\t\t\theight =\r\n\t\t\t\trows * cellH +\r\n\t\t\t\t(rows - 1) * thisObj.paletteSpacing;\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tcols: cols,\r\n\t\t\trows: rows,\r\n\t\t\tcellW: cellW,\r\n\t\t\tcellH: cellH,\r\n\t\t\twidth: width,\r\n\t\t\theight: height,\r\n\t\t};\r\n\t},\r\n\r\n\r\n\tgetControlPadding : function (thisObj) {\r\n\t\treturn Math.max(\r\n\t\t\tthisObj.padding / 2,\r\n\t\t\t(2 * thisObj.pointerBorderWidth + thisObj.pointerThickness) - thisObj.controlBorderWidth\r\n\t\t);\r\n\t},\r\n\r\n\r\n\tgetPadYChannel : function (thisObj) {\r\n\t\tswitch (thisObj.mode.charAt(1).toLowerCase()) {\r\n\t\t\tcase 'v': return 'v'; break;\r\n\t\t}\r\n\t\treturn 's';\r\n\t},\r\n\r\n\r\n\tgetSliderChannel : function (thisObj) {\r\n\t\tif (thisObj.mode.length > 2) {\r\n\t\t\tswitch (thisObj.mode.charAt(2).toLowerCase()) {\r\n\t\t\t\tcase 's': return 's'; break;\r\n\t\t\t\tcase 'v': return 'v'; break;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t},\r\n\r\n\r\n\t// calls function specified in picker's property\r\n\ttriggerCallback : function (thisObj, prop) {\r\n\t\tif (!thisObj[prop]) {\r\n\t\t\treturn; // callback func not specified\r\n\t\t}\r\n\t\tvar callback = null;\r\n\r\n\t\tif (typeof thisObj[prop] === 'string') {\r\n\t\t\t// string with code\r\n\t\t\ttry {\r\n\t\t\t\tcallback = new Function (thisObj[prop]);\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.error(e);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t// function\r\n\t\t\tcallback = thisObj[prop];\r\n\t\t}\r\n\r\n\t\tif (callback) {\r\n\t\t\tcallback.call(thisObj);\r\n\t\t}\r\n\t},\r\n\r\n\r\n\t// Triggers a color change related event(s) on all picker instances.\r\n\t// It is possible to specify multiple events separated with a space.\r\n\ttriggerGlobal : function (eventNames) {\r\n\t\tvar inst = jsc.getInstances();\r\n\t\tfor (var i = 0; i < inst.length; i += 1) {\r\n\t\t\tinst[i].trigger(eventNames);\r\n\t\t}\r\n\t},\r\n\r\n\r\n\t_pointerMoveEvent : {\r\n\t\tmouse: 'mousemove',\r\n\t\ttouch: 'touchmove'\r\n\t},\r\n\t_pointerEndEvent : {\r\n\t\tmouse: 'mouseup',\r\n\t\ttouch: 'touchend'\r\n\t},\r\n\r\n\r\n\t_pointerOrigin : null,\r\n\r\n\r\n\tonDocumentKeyUp : function (e) {\r\n\t\tif (['Tab', 'Escape'].indexOf(jsc.eventKey(e)) !== -1) {\r\n\t\t\tif (jsc.picker && jsc.picker.owner) {\r\n\t\t\t\tjsc.picker.owner.tryHide();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tonWindowResize : function (e) {\r\n\t\tjsc.redrawPosition();\r\n\t},\r\n\r\n\r\n\tonWindowScroll : function (e) {\r\n\t\tjsc.redrawPosition();\r\n\t},\r\n\r\n\r\n\tonParentScroll : function (e) {\r\n\t\t// hide the picker when one of the parent elements is scrolled\r\n\t\tif (jsc.picker && jsc.picker.owner) {\r\n\t\t\tjsc.picker.owner.tryHide();\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tonDocumentMouseDown : function (e) {\r\n\t\tvar target = e.target || e.srcElement;\r\n\r\n\t\tif (target.jscolor && target.jscolor instanceof jsc.pub) { // clicked targetElement -> show picker\r\n\t\t\tif (target.jscolor.showOnClick && !target.disabled) {\r\n\t\t\t\ttarget.jscolor.show();\r\n\t\t\t}\r\n\t\t} else if (jsc.getData(target, 'gui')) { // clicked jscolor's GUI element\r\n\t\t\tvar control = jsc.getData(target, 'control');\r\n\t\t\tif (control) {\r\n\t\t\t\t// jscolor's control\r\n\t\t\t\tjsc.onControlPointerStart(e, target, jsc.getData(target, 'control'), 'mouse');\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t// mouse is outside the picker's controls -> hide the color picker!\r\n\t\t\tif (jsc.picker && jsc.picker.owner) {\r\n\t\t\t\tjsc.picker.owner.tryHide();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tonPickerTouchStart : function (e) {\r\n\t\tvar target = e.target || e.srcElement;\r\n\r\n\t\tif (jsc.getData(target, 'control')) {\r\n\t\t\tjsc.onControlPointerStart(e, target, jsc.getData(target, 'control'), 'touch');\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tonControlPointerStart : function (e, target, controlName, pointerType) {\r\n\t\tvar thisObj = jsc.getData(target, 'instance');\r\n\r\n\t\tjsc.preventDefault(e);\r\n\r\n\t\tvar registerDragEvents = function (doc, offset) {\r\n\t\t\tjsc.attachGroupEvent('drag', doc, jsc._pointerMoveEvent[pointerType],\r\n\t\t\t\tjsc.onDocumentPointerMove(e, target, controlName, pointerType, offset));\r\n\t\t\tjsc.attachGroupEvent('drag', doc, jsc._pointerEndEvent[pointerType],\r\n\t\t\t\tjsc.onDocumentPointerEnd(e, target, controlName, pointerType));\r\n\t\t};\r\n\r\n\t\tregisterDragEvents(window.document, [0, 0]);\r\n\r\n\t\tif (window.parent && window.frameElement) {\r\n\t\t\tvar rect = window.frameElement.getBoundingClientRect();\r\n\t\t\tvar ofs = [-rect.left, -rect.top];\r\n\t\t\tregisterDragEvents(window.parent.window.document, ofs);\r\n\t\t}\r\n\r\n\t\tvar abs = jsc.getAbsPointerPos(e);\r\n\t\tvar rel = jsc.getRelPointerPos(e);\r\n\t\tjsc._pointerOrigin = {\r\n\t\t\tx: abs.x - rel.x,\r\n\t\t\ty: abs.y - rel.y\r\n\t\t};\r\n\r\n\t\tswitch (controlName) {\r\n\t\tcase 'pad':\r\n\t\t\t// if the value slider is at the bottom, move it up\r\n\t\t\tif (jsc.getSliderChannel(thisObj) === 'v' && thisObj.channels.v === 0) {\r\n\t\t\t\tthisObj.fromHSVA(null, null, 100, null);\r\n\t\t\t}\r\n\t\t\tjsc.setPad(thisObj, e, 0, 0);\r\n\t\t\tbreak;\r\n\r\n\t\tcase 'sld':\r\n\t\t\tjsc.setSld(thisObj, e, 0);\r\n\t\t\tbreak;\r\n\r\n\t\tcase 'asld':\r\n\t\t\tjsc.setASld(thisObj, e, 0);\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tthisObj.trigger('input');\r\n\t},\r\n\r\n\r\n\tonDocumentPointerMove : function (e, target, controlName, pointerType, offset) {\r\n\t\treturn function (e) {\r\n\t\t\tvar thisObj = jsc.getData(target, 'instance');\r\n\t\t\tswitch (controlName) {\r\n\t\t\tcase 'pad':\r\n\t\t\t\tjsc.setPad(thisObj, e, offset[0], offset[1]);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'sld':\r\n\t\t\t\tjsc.setSld(thisObj, e, offset[1]);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'asld':\r\n\t\t\t\tjsc.setASld(thisObj, e, offset[1]);\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tthisObj.trigger('input');\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tonDocumentPointerEnd : function (e, target, controlName, pointerType) {\r\n\t\treturn function (e) {\r\n\t\t\tvar thisObj = jsc.getData(target, 'instance');\r\n\t\t\tjsc.detachGroupEvents('drag');\r\n\r\n\t\t\t// Always trigger changes AFTER detaching outstanding mouse handlers,\r\n\t\t\t// in case some color change that occured in user-defined onChange/onInput handler\r\n\t\t\t// intruded into current mouse events\r\n\t\t\tthisObj.trigger('input');\r\n\t\t\tthisObj.trigger('change');\r\n\t\t};\r\n\t},\r\n\r\n\r\n\tonPaletteSampleClick : function (e) {\r\n\t\tvar target = e.currentTarget;\r\n\t\tvar thisObj = jsc.getData(target, 'instance');\r\n\t\tvar color = jsc.getData(target, 'color');\r\n\r\n\t\t// when format is flexible, use the original format of this color sample\r\n\t\tif (thisObj.format.toLowerCase() === 'any') {\r\n\t\t\tthisObj._setFormat(color.format); // adapt format\r\n\t\t\tif (!jsc.isAlphaFormat(thisObj.getFormat())) {\r\n\t\t\t\tcolor.rgba[3] = 1.0; // when switching to a format that doesn't support alpha, set full opacity\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// if this color doesn't specify alpha, use alpha of 1.0 (if applicable)\r\n\t\tif (color.rgba[3] === null) {\r\n\t\t\tif (thisObj.paletteSetsAlpha === true || (thisObj.paletteSetsAlpha === 'auto' && thisObj._paletteHasTransparency)) {\r\n\t\t\t\tcolor.rgba[3] = 1.0;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthisObj.fromRGBA.apply(thisObj, color.rgba);\r\n\r\n\t\tthisObj.trigger('input');\r\n\t\tthisObj.trigger('change');\r\n\r\n\t\tif (thisObj.hideOnPaletteClick) {\r\n\t\t\tthisObj.hide();\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tsetPad : function (thisObj, e, ofsX, ofsY) {\r\n\t\tvar pointerAbs = jsc.getAbsPointerPos(e);\r\n\t\tvar x = ofsX + pointerAbs.x - jsc._pointerOrigin.x - thisObj.padding - thisObj.controlBorderWidth;\r\n\t\tvar y = ofsY + pointerAbs.y - jsc._pointerOrigin.y - thisObj.padding - thisObj.controlBorderWidth;\r\n\r\n\t\tvar xVal = x * (360 / (thisObj.width - 1));\r\n\t\tvar yVal = 100 - (y * (100 / (thisObj.height - 1)));\r\n\r\n\t\tswitch (jsc.getPadYChannel(thisObj)) {\r\n\t\tcase 's': thisObj.fromHSVA(xVal, yVal, null, null); break;\r\n\t\tcase 'v': thisObj.fromHSVA(xVal, null, yVal, null); break;\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tsetSld : function (thisObj, e, ofsY) {\r\n\t\tvar pointerAbs = jsc.getAbsPointerPos(e);\r\n\t\tvar y = ofsY + pointerAbs.y - jsc._pointerOrigin.y - thisObj.padding - thisObj.controlBorderWidth;\r\n\t\tvar yVal = 100 - (y * (100 / (thisObj.height - 1)));\r\n\r\n\t\tswitch (jsc.getSliderChannel(thisObj)) {\r\n\t\tcase 's': thisObj.fromHSVA(null, yVal, null, null); break;\r\n\t\tcase 'v': thisObj.fromHSVA(null, null, yVal, null); break;\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tsetASld : function (thisObj, e, ofsY) {\r\n\t\tvar pointerAbs = jsc.getAbsPointerPos(e);\r\n\t\tvar y = ofsY + pointerAbs.y - jsc._pointerOrigin.y - thisObj.padding - thisObj.controlBorderWidth;\r\n\t\tvar yVal = 1.0 - (y * (1.0 / (thisObj.height - 1)));\r\n\r\n\t\tif (yVal < 1.0) {\r\n\t\t\t// if format is flexible and the current format doesn't support alpha, switch to a suitable one\r\n\t\t\tvar fmt = thisObj.getFormat();\r\n\t\t\tif (thisObj.format.toLowerCase() === 'any' && !jsc.isAlphaFormat(fmt)) {\r\n\t\t\t\tthisObj._setFormat(fmt === 'hex' ? 'hexa' : 'rgba');\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthisObj.fromHSVA(null, null, null, yVal);\r\n\t},\r\n\r\n\r\n\tcreatePadCanvas : function () {\r\n\r\n\t\tvar ret = {\r\n\t\t\telm: null,\r\n\t\t\tdraw: null\r\n\t\t};\r\n\r\n\t\tvar canvas = jsc.createEl('canvas');\r\n\t\tvar ctx = canvas.getContext('2d');\r\n\r\n\t\tvar drawFunc = function (width, height, type) {\r\n\t\t\tcanvas.width = width;\r\n\t\t\tcanvas.height = height;\r\n\r\n\t\t\tctx.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n\t\t\tvar hGrad = ctx.createLinearGradient(0, 0, canvas.width, 0);\r\n\t\t\thGrad.addColorStop(0 / 6, '#F00');\r\n\t\t\thGrad.addColorStop(1 / 6, '#FF0');\r\n\t\t\thGrad.addColorStop(2 / 6, '#0F0');\r\n\t\t\thGrad.addColorStop(3 / 6, '#0FF');\r\n\t\t\thGrad.addColorStop(4 / 6, '#00F');\r\n\t\t\thGrad.addColorStop(5 / 6, '#F0F');\r\n\t\t\thGrad.addColorStop(6 / 6, '#F00');\r\n\r\n\t\t\tctx.fillStyle = hGrad;\r\n\t\t\tctx.fillRect(0, 0, canvas.width, canvas.height);\r\n\r\n\t\t\tvar vGrad = ctx.createLinearGradient(0, 0, 0, canvas.height);\r\n\t\t\tswitch (type.toLowerCase()) {\r\n\t\t\tcase 's':\r\n\t\t\t\tvGrad.addColorStop(0, 'rgba(255,255,255,0)');\r\n\t\t\t\tvGrad.addColorStop(1, 'rgba(255,255,255,1)');\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'v':\r\n\t\t\t\tvGrad.addColorStop(0, 'rgba(0,0,0,0)');\r\n\t\t\t\tvGrad.addColorStop(1, 'rgba(0,0,0,1)');\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tctx.fillStyle = vGrad;\r\n\t\t\tctx.fillRect(0, 0, canvas.width, canvas.height);\r\n\t\t};\r\n\r\n\t\tret.elm = canvas;\r\n\t\tret.draw = drawFunc;\r\n\r\n\t\treturn ret;\r\n\t},\r\n\r\n\r\n\tcreateSliderGradient : function () {\r\n\r\n\t\tvar ret = {\r\n\t\t\telm: null,\r\n\t\t\tdraw: null\r\n\t\t};\r\n\r\n\t\tvar canvas = jsc.createEl('canvas');\r\n\t\tvar ctx = canvas.getContext('2d');\r\n\r\n\t\tvar drawFunc = function (width, height, color1, color2) {\r\n\t\t\tcanvas.width = width;\r\n\t\t\tcanvas.height = height;\r\n\r\n\t\t\tctx.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n\t\t\tvar grad = ctx.createLinearGradient(0, 0, 0, canvas.height);\r\n\t\t\tgrad.addColorStop(0, color1);\r\n\t\t\tgrad.addColorStop(1, color2);\r\n\r\n\t\t\tctx.fillStyle = grad;\r\n\t\t\tctx.fillRect(0, 0, canvas.width, canvas.height);\r\n\t\t};\r\n\r\n\t\tret.elm = canvas;\r\n\t\tret.draw = drawFunc;\r\n\r\n\t\treturn ret;\r\n\t},\r\n\r\n\r\n\tcreateASliderGradient : function () {\r\n\r\n\t\tvar ret = {\r\n\t\t\telm: null,\r\n\t\t\tdraw: null\r\n\t\t};\r\n\r\n\t\tvar canvas = jsc.createEl('canvas');\r\n\t\tvar ctx = canvas.getContext('2d');\r\n\r\n\t\tvar drawFunc = function (width, height, color) {\r\n\t\t\tcanvas.width = width;\r\n\t\t\tcanvas.height = height;\r\n\r\n\t\t\tctx.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n\t\t\tvar sqSize = canvas.width / 2;\r\n\t\t\tvar sqColor1 = jsc.pub.chessboardColor1;\r\n\t\t\tvar sqColor2 = jsc.pub.chessboardColor2;\r\n\r\n\t\t\t// dark gray background\r\n\t\t\tctx.fillStyle = sqColor1;\r\n\t\t\tctx.fillRect(0, 0, canvas.width, canvas.height);\r\n\r\n\t\t\tif (sqSize > 0) { // to avoid infinite loop\r\n\t\t\t\tfor (var y = 0; y < canvas.height; y += sqSize * 2) {\r\n\t\t\t\t\t// light gray squares\r\n\t\t\t\t\tctx.fillStyle = sqColor2;\r\n\t\t\t\t\tctx.fillRect(0, y, sqSize, sqSize);\r\n\t\t\t\t\tctx.fillRect(sqSize, y + sqSize, sqSize, sqSize);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar grad = ctx.createLinearGradient(0, 0, 0, canvas.height);\r\n\t\t\tgrad.addColorStop(0, color);\r\n\t\t\tgrad.addColorStop(1, 'rgba(0,0,0,0)');\r\n\r\n\t\t\tctx.fillStyle = grad;\r\n\t\t\tctx.fillRect(0, 0, canvas.width, canvas.height);\r\n\t\t};\r\n\r\n\t\tret.elm = canvas;\r\n\t\tret.draw = drawFunc;\r\n\r\n\t\treturn ret;\r\n\t},\r\n\r\n\r\n\tBoxShadow : (function () {\r\n\t\tvar BoxShadow = function (hShadow, vShadow, blur, spread, color, inset) {\r\n\t\t\tthis.hShadow = hShadow;\r\n\t\t\tthis.vShadow = vShadow;\r\n\t\t\tthis.blur = blur;\r\n\t\t\tthis.spread = spread;\r\n\t\t\tthis.color = color;\r\n\t\t\tthis.inset = !!inset;\r\n\t\t};\r\n\r\n\t\tBoxShadow.prototype.toString = function () {\r\n\t\t\tvar vals = [\r\n\t\t\t\tMath.round(this.hShadow) + 'px',\r\n\t\t\t\tMath.round(this.vShadow) + 'px',\r\n\t\t\t\tMath.round(this.blur) + 'px',\r\n\t\t\t\tMath.round(this.spread) + 'px',\r\n\t\t\t\tthis.color\r\n\t\t\t];\r\n\t\t\tif (this.inset) {\r\n\t\t\t\tvals.push('inset');\r\n\t\t\t}\r\n\t\t\treturn vals.join(' ');\r\n\t\t};\r\n\r\n\t\treturn BoxShadow;\r\n\t})(),\r\n\r\n\r\n\tflags : {\r\n\t\tleaveValue : 1 << 0,\r\n\t\tleaveAlpha : 1 << 1,\r\n\t\tleavePreview : 1 << 2,\r\n\t},\r\n\r\n\r\n\tenumOpts : {\r\n\t\tformat: ['auto', 'any', 'hex', 'hexa', 'rgb', 'rgba'],\r\n\t\tpreviewPosition: ['left', 'right'],\r\n\t\tmode: ['hsv', 'hvs', 'hs', 'hv'],\r\n\t\tposition: ['left', 'right', 'top', 'bottom'],\r\n\t\talphaChannel: ['auto', true, false],\r\n\t\tpaletteSetsAlpha: ['auto', true, false],\r\n\t},\r\n\r\n\r\n\tdeprecatedOpts : {\r\n\t\t// <old_option>: <new_option>  (<new_option> can be null)\r\n\t\t'styleElement': 'previewElement',\r\n\t\t'onFineChange': 'onInput',\r\n\t\t'overwriteImportant': 'forceStyle',\r\n\t\t'closable': 'closeButton',\r\n\t\t'insetWidth': 'controlBorderWidth',\r\n\t\t'insetColor': 'controlBorderColor',\r\n\t\t'refine': null,\r\n\t},\r\n\r\n\r\n\tdocsRef : ' ' + 'See https://jscolor.com/docs/',\r\n\r\n\r\n\t//\r\n\t// Usage:\r\n\t// var myPicker = new JSColor(<targetElement> [, <options>])\r\n\t//\r\n\t// (constructor is accessible via both 'jscolor' and 'JSColor' name)\r\n\t//\r\n\r\n\tpub : function (targetElement, opts) {\r\n\r\n\t\tvar THIS = this;\r\n\r\n\t\tif (!opts) {\r\n\t\t\topts = {};\r\n\t\t}\r\n\r\n\t\tthis.channels = {\r\n\t\t\tr: 255, // red [0-255]\r\n\t\t\tg: 255, // green [0-255]\r\n\t\t\tb: 255, // blue [0-255]\r\n\t\t\th: 0, // hue [0-360]\r\n\t\t\ts: 0, // saturation [0-100]\r\n\t\t\tv: 100, // value (brightness) [0-100]\r\n\t\t\ta: 1.0, // alpha (opacity) [0.0 - 1.0]\r\n\t\t};\r\n\r\n\t\t// General options\r\n\t\t//\r\n\t\tthis.format = 'auto'; // 'auto' | 'any' | 'hex' | 'hexa' | 'rgb' | 'rgba' - Format of the input/output value\r\n\t\tthis.value = undefined; // INITIAL color value in any supported format. To change it later, use method fromString(), fromHSVA(), fromRGBA() or channel()\r\n\t\tthis.alpha = undefined; // INITIAL alpha value. To change it later, call method channel('A', <value>)\r\n\t\tthis.random = false; // whether to randomize the initial color. Either true | false, or an array of ranges: [minV, maxV, minS, maxS, minH, maxH, minA, maxA]\r\n\t\tthis.onChange = undefined; // called when color changes. Value can be either a function or a string with JS code.\r\n\t\tthis.onInput = undefined; // called repeatedly as the color is being changed, e.g. while dragging a slider. Value can be either a function or a string with JS code.\r\n\t\tthis.valueElement = undefined; // element that will be used to display and input the color value\r\n\t\tthis.alphaElement = undefined; // element that will be used to display and input the alpha (opacity) value\r\n\t\tthis.previewElement = undefined; // element that will preview the picked color using CSS background\r\n\t\tthis.previewPosition = 'left'; // 'left' | 'right' - position of the color preview in previewElement\r\n\t\tthis.previewSize = 32; // (px) width of the color preview displayed in previewElement\r\n\t\tthis.previewPadding = 8; // (px) space between color preview and content of the previewElement\r\n\t\tthis.required = true; // whether the associated text input must always contain a color value. If false, the input can be left empty.\r\n\t\tthis.hash = true; // whether to prefix the HEX color code with # symbol (only applicable for HEX format)\r\n\t\tthis.uppercase = true; // whether to show the HEX color code in upper case (only applicable for HEX format)\r\n\t\tthis.forceStyle = true; // whether to overwrite CSS style of the previewElement using !important flag\r\n\r\n\t\t// Color Picker options\r\n\t\t//\r\n\t\tthis.width = 181; // width of the color spectrum (in px)\r\n\t\tthis.height = 101; // height of the color spectrum (in px)\r\n\t\tthis.mode = 'HSV'; // 'HSV' | 'HVS' | 'HS' | 'HV' - layout of the color picker controls\r\n\t\tthis.alphaChannel = 'auto'; // 'auto' | true | false - if alpha channel is enabled, the alpha slider will be visible. If 'auto', it will be determined according to color format\r\n\t\tthis.position = 'bottom'; // 'left' | 'right' | 'top' | 'bottom' - position relative to the target element\r\n\t\tthis.smartPosition = true; // automatically change picker position when there is not enough space for it\r\n\t\tthis.showOnClick = true; // whether to show the picker when user clicks its target element\r\n\t\tthis.hideOnLeave = true; // whether to automatically hide the picker when user leaves its target element (e.g. upon clicking the document)\r\n\t\tthis.palette = []; // colors to be displayed in the palette, specified as an array or a string of space separated color values (in any supported format)\r\n\t\tthis.paletteCols = 10; // number of columns in the palette\r\n\t\tthis.paletteSetsAlpha = 'auto'; // 'auto' | true | false - if true, palette colors that don't specify alpha will set alpha to 1.0\r\n\t\tthis.paletteHeight = 16; // maximum height (px) of a row in the palette\r\n\t\tthis.paletteSpacing = 4; // distance (px) between color samples in the palette\r\n\t\tthis.hideOnPaletteClick = false; // when set to true, clicking the palette will also hide the color picker\r\n\t\tthis.sliderSize = 16; // px\r\n\t\tthis.crossSize = 8; // px\r\n\t\tthis.closeButton = false; // whether to display the Close button\r\n\t\tthis.closeText = 'Close';\r\n\t\tthis.buttonColor = 'rgba(0,0,0,1)'; // CSS color\r\n\t\tthis.buttonHeight = 18; // px\r\n\t\tthis.padding = 12; // px\r\n\t\tthis.backgroundColor = 'rgba(255,255,255,1)'; // CSS color\r\n\t\tthis.borderWidth = 1; // px\r\n\t\tthis.borderColor = 'rgba(187,187,187,1)'; // CSS color\r\n\t\tthis.borderRadius = 8; // px\r\n\t\tthis.controlBorderWidth = 1; // px\r\n\t\tthis.controlBorderColor = 'rgba(187,187,187,1)'; // CSS color\r\n\t\tthis.shadow = true; // whether to display a shadow\r\n\t\tthis.shadowBlur = 15; // px\r\n\t\tthis.shadowColor = 'rgba(0,0,0,0.2)'; // CSS color\r\n\t\tthis.pointerColor = 'rgba(76,76,76,1)'; // CSS color\r\n\t\tthis.pointerBorderWidth = 1; // px\r\n\t\tthis.pointerBorderColor = 'rgba(255,255,255,1)'; // CSS color\r\n\t\tthis.pointerThickness = 2; // px\r\n\t\tthis.zIndex = 5000;\r\n\t\tthis.container = undefined; // where to append the color picker (BODY element by default)\r\n\r\n\t\t// Experimental\r\n\t\t//\r\n\t\tthis.minS = 0; // min allowed saturation (0 - 100)\r\n\t\tthis.maxS = 100; // max allowed saturation (0 - 100)\r\n\t\tthis.minV = 0; // min allowed value (brightness) (0 - 100)\r\n\t\tthis.maxV = 100; // max allowed value (brightness) (0 - 100)\r\n\t\tthis.minA = 0.0; // min allowed alpha (opacity) (0.0 - 1.0)\r\n\t\tthis.maxA = 1.0; // max allowed alpha (opacity) (0.0 - 1.0)\r\n\r\n\r\n\t\t// Getter: option(name)\r\n\t\t// Setter: option(name, value)\r\n\t\t//         option({name:value, ...})\r\n\t\t//\r\n\t\tthis.option = function () {\r\n\t\t\tif (!arguments.length) {\r\n\t\t\t\tthrow new Error('No option specified');\r\n\t\t\t}\r\n\r\n\t\t\tif (arguments.length === 1 && typeof arguments[0] === 'string') {\r\n\t\t\t\t// getting a single option\r\n\t\t\t\ttry {\r\n\t\t\t\t\treturn getOption(arguments[0]);\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\tconsole.warn(e);\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\r\n\t\t\t} else if (arguments.length >= 2 && typeof arguments[0] === 'string') {\r\n\t\t\t\t// setting a single option\r\n\t\t\t\ttry {\r\n\t\t\t\t\tif (!setOption(arguments[0], arguments[1])) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\tconsole.warn(e);\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tthis.redraw(); // immediately redraws the picker, if it's displayed\r\n\t\t\t\tthis.exposeColor(); // in case some preview-related or format-related option was changed\r\n\t\t\t\treturn true;\r\n\r\n\t\t\t} else if (arguments.length === 1 && typeof arguments[0] === 'object') {\r\n\t\t\t\t// setting multiple options\r\n\t\t\t\tvar opts = arguments[0];\r\n\t\t\t\tvar success = true;\r\n\t\t\t\tfor (var opt in opts) {\r\n\t\t\t\t\tif (opts.hasOwnProperty(opt)) {\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tif (!setOption(opt, opts[opt])) {\r\n\t\t\t\t\t\t\t\tsuccess = false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\t\tconsole.warn(e);\r\n\t\t\t\t\t\t\tsuccess = false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.redraw(); // immediately redraws the picker, if it's displayed\r\n\t\t\t\tthis.exposeColor(); // in case some preview-related or format-related option was changed\r\n\t\t\t\treturn success;\r\n\t\t\t}\r\n\r\n\t\t\tthrow new Error('Invalid arguments');\r\n\t\t}\r\n\r\n\r\n\t\t// Getter: channel(name)\r\n\t\t// Setter: channel(name, value)\r\n\t\t//\r\n\t\tthis.channel = function (name, value) {\r\n\t\t\tif (typeof name !== 'string') {\r\n\t\t\t\tthrow new Error('Invalid value for channel name: ' + name);\r\n\t\t\t}\r\n\r\n\t\t\tif (value === undefined) {\r\n\t\t\t\t// getting channel value\r\n\t\t\t\tif (!this.channels.hasOwnProperty(name.toLowerCase())) {\r\n\t\t\t\t\tconsole.warn('Getting unknown channel: ' + name);\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\treturn this.channels[name.toLowerCase()];\r\n\r\n\t\t\t} else {\r\n\t\t\t\t// setting channel value\r\n\t\t\t\tvar res = false;\r\n\t\t\t\tswitch (name.toLowerCase()) {\r\n\t\t\t\t\tcase 'r': res = this.fromRGBA(value, null, null, null); break;\r\n\t\t\t\t\tcase 'g': res = this.fromRGBA(null, value, null, null); break;\r\n\t\t\t\t\tcase 'b': res = this.fromRGBA(null, null, value, null); break;\r\n\t\t\t\t\tcase 'h': res = this.fromHSVA(value, null, null, null); break;\r\n\t\t\t\t\tcase 's': res = this.fromHSVA(null, value, null, null); break;\r\n\t\t\t\t\tcase 'v': res = this.fromHSVA(null, null, value, null); break;\r\n\t\t\t\t\tcase 'a': res = this.fromHSVA(null, null, null, value); break;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tconsole.warn('Setting unknown channel: ' + name);\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tif (res) {\r\n\t\t\t\t\tthis.redraw(); // immediately redraws the picker, if it's displayed\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\r\n\t\t// Triggers given input event(s) by:\r\n\t\t// - executing on<Event> callback specified as picker's option\r\n\t\t// - triggering standard DOM event listeners attached to the value element\r\n\t\t//\r\n\t\t// It is possible to specify multiple events separated with a space.\r\n\t\t//\r\n\t\tthis.trigger = function (eventNames) {\r\n\t\t\tvar evs = jsc.strList(eventNames);\r\n\t\t\tfor (var i = 0; i < evs.length; i += 1) {\r\n\t\t\t\tvar ev = evs[i].toLowerCase();\r\n\r\n\t\t\t\t// trigger a callback\r\n\t\t\t\tvar callbackProp = null;\r\n\t\t\t\tswitch (ev) {\r\n\t\t\t\t\tcase 'input': callbackProp = 'onInput'; break;\r\n\t\t\t\t\tcase 'change': callbackProp = 'onChange'; break;\r\n\t\t\t\t}\r\n\t\t\t\tif (callbackProp) {\r\n\t\t\t\t\tjsc.triggerCallback(this, callbackProp);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// trigger standard DOM event listeners on the value element\r\n\t\t\t\tjsc.triggerInputEvent(this.valueElement, ev, true, true);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\r\n\t\t// h: 0-360\r\n\t\t// s: 0-100\r\n\t\t// v: 0-100\r\n\t\t// a: 0.0-1.0\r\n\t\t//\r\n\t\tthis.fromHSVA = function (h, s, v, a, flags) { // null = don't change\r\n\t\t\tif (h === undefined) { h = null; }\r\n\t\t\tif (s === undefined) { s = null; }\r\n\t\t\tif (v === undefined) { v = null; }\r\n\t\t\tif (a === undefined) { a = null; }\r\n\r\n\t\t\tif (h !== null) {\r\n\t\t\t\tif (isNaN(h)) { return false; }\r\n\t\t\t\tthis.channels.h = Math.max(0, Math.min(360, h));\r\n\t\t\t}\r\n\t\t\tif (s !== null) {\r\n\t\t\t\tif (isNaN(s)) { return false; }\r\n\t\t\t\tthis.channels.s = Math.max(0, Math.min(100, this.maxS, s), this.minS);\r\n\t\t\t}\r\n\t\t\tif (v !== null) {\r\n\t\t\t\tif (isNaN(v)) { return false; }\r\n\t\t\t\tthis.channels.v = Math.max(0, Math.min(100, this.maxV, v), this.minV);\r\n\t\t\t}\r\n\t\t\tif (a !== null) {\r\n\t\t\t\tif (isNaN(a)) { return false; }\r\n\t\t\t\tthis.channels.a = this.hasAlphaChannel() ?\r\n\t\t\t\t\tMath.max(0, Math.min(1, this.maxA, a), this.minA) :\r\n\t\t\t\t\t1.0; // if alpha channel is disabled, the color should stay 100% opaque\r\n\t\t\t}\r\n\r\n\t\t\tvar rgb = jsc.HSV_RGB(\r\n\t\t\t\tthis.channels.h,\r\n\t\t\t\tthis.channels.s,\r\n\t\t\t\tthis.channels.v\r\n\t\t\t);\r\n\t\t\tthis.channels.r = rgb[0];\r\n\t\t\tthis.channels.g = rgb[1];\r\n\t\t\tthis.channels.b = rgb[2];\r\n\r\n\t\t\tthis.exposeColor(flags);\r\n\t\t\treturn true;\r\n\t\t};\r\n\r\n\r\n\t\t// r: 0-255\r\n\t\t// g: 0-255\r\n\t\t// b: 0-255\r\n\t\t// a: 0.0-1.0\r\n\t\t//\r\n\t\tthis.fromRGBA = function (r, g, b, a, flags) { // null = don't change\r\n\t\t\tif (r === undefined) { r = null; }\r\n\t\t\tif (g === undefined) { g = null; }\r\n\t\t\tif (b === undefined) { b = null; }\r\n\t\t\tif (a === undefined) { a = null; }\r\n\r\n\t\t\tif (r !== null) {\r\n\t\t\t\tif (isNaN(r)) { return false; }\r\n\t\t\t\tr = Math.max(0, Math.min(255, r));\r\n\t\t\t}\r\n\t\t\tif (g !== null) {\r\n\t\t\t\tif (isNaN(g)) { return false; }\r\n\t\t\t\tg = Math.max(0, Math.min(255, g));\r\n\t\t\t}\r\n\t\t\tif (b !== null) {\r\n\t\t\t\tif (isNaN(b)) { return false; }\r\n\t\t\t\tb = Math.max(0, Math.min(255, b));\r\n\t\t\t}\r\n\t\t\tif (a !== null) {\r\n\t\t\t\tif (isNaN(a)) { return false; }\r\n\t\t\t\tthis.channels.a = this.hasAlphaChannel() ?\r\n\t\t\t\t\tMath.max(0, Math.min(1, this.maxA, a), this.minA) :\r\n\t\t\t\t\t1.0; // if alpha channel is disabled, the color should stay 100% opaque\r\n\t\t\t}\r\n\r\n\t\t\tvar hsv = jsc.RGB_HSV(\r\n\t\t\t\tr===null ? this.channels.r : r,\r\n\t\t\t\tg===null ? this.channels.g : g,\r\n\t\t\t\tb===null ? this.channels.b : b\r\n\t\t\t);\r\n\t\t\tif (hsv[0] !== null) {\r\n\t\t\t\tthis.channels.h = Math.max(0, Math.min(360, hsv[0]));\r\n\t\t\t}\r\n\t\t\tif (hsv[2] !== 0) { // fully black color stays black through entire saturation range, so let's not change saturation\r\n\t\t\t\tthis.channels.s = Math.max(0, this.minS, Math.min(100, this.maxS, hsv[1]));\r\n\t\t\t}\r\n\t\t\tthis.channels.v = Math.max(0, this.minV, Math.min(100, this.maxV, hsv[2]));\r\n\r\n\t\t\t// update RGB according to final HSV, as some values might be trimmed\r\n\t\t\tvar rgb = jsc.HSV_RGB(this.channels.h, this.channels.s, this.channels.v);\r\n\t\t\tthis.channels.r = rgb[0];\r\n\t\t\tthis.channels.g = rgb[1];\r\n\t\t\tthis.channels.b = rgb[2];\r\n\r\n\t\t\tthis.exposeColor(flags);\r\n\t\t\treturn true;\r\n\t\t};\r\n\r\n\r\n\t\t// DEPRECATED. Use .fromHSVA() instead\r\n\t\t//\r\n\t\tthis.fromHSV = function (h, s, v, flags) {\r\n\t\t\tconsole.warn('fromHSV() method is DEPRECATED. Using fromHSVA() instead.' + jsc.docsRef);\r\n\t\t\treturn this.fromHSVA(h, s, v, null, flags);\r\n\t\t};\r\n\r\n\r\n\t\t// DEPRECATED. Use .fromRGBA() instead\r\n\t\t//\r\n\t\tthis.fromRGB = function (r, g, b, flags) {\r\n\t\t\tconsole.warn('fromRGB() method is DEPRECATED. Using fromRGBA() instead.' + jsc.docsRef);\r\n\t\t\treturn this.fromRGBA(r, g, b, null, flags);\r\n\t\t};\r\n\r\n\r\n\t\tthis.fromString = function (str, flags) {\r\n\t\t\tif (!this.required && str.trim() === '') {\r\n\t\t\t\t// setting empty string to an optional color input\r\n\t\t\t\tthis.setPreviewElementBg(null);\r\n\t\t\t\tthis.setValueElementValue('');\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\r\n\t\t\tvar color = jsc.parseColorString(str);\r\n\t\t\tif (!color) {\r\n\t\t\t\treturn false; // could not parse\r\n\t\t\t}\r\n\t\t\tif (this.format.toLowerCase() === 'any') {\r\n\t\t\t\tthis._setFormat(color.format); // adapt format\r\n\t\t\t\tif (!jsc.isAlphaFormat(this.getFormat())) {\r\n\t\t\t\t\tcolor.rgba[3] = 1.0; // when switching to a format that doesn't support alpha, set full opacity\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.fromRGBA(\r\n\t\t\t\tcolor.rgba[0],\r\n\t\t\t\tcolor.rgba[1],\r\n\t\t\t\tcolor.rgba[2],\r\n\t\t\t\tcolor.rgba[3],\r\n\t\t\t\tflags\r\n\t\t\t);\r\n\t\t\treturn true;\r\n\t\t};\r\n\r\n\r\n\t\tthis.randomize = function (minV, maxV, minS, maxS, minH, maxH, minA, maxA) {\r\n\t\t\tif (minV === undefined) { minV = 0; }\r\n\t\t\tif (maxV === undefined) { maxV = 100; }\r\n\t\t\tif (minS === undefined) { minS = 0; }\r\n\t\t\tif (maxS === undefined) { maxS = 100; }\r\n\t\t\tif (minH === undefined) { minH = 0; }\r\n\t\t\tif (maxH === undefined) { maxH = 359; }\r\n\t\t\tif (minA === undefined) { minA = 1; }\r\n\t\t\tif (maxA === undefined) { maxA = 1; }\r\n\r\n\t\t\tthis.fromHSVA(\r\n\t\t\t\tminH + Math.floor(Math.random() * (maxH - minH + 1)),\r\n\t\t\t\tminS + Math.floor(Math.random() * (maxS - minS + 1)),\r\n\t\t\t\tminV + Math.floor(Math.random() * (maxV - minV + 1)),\r\n\t\t\t\t((100 * minA) + Math.floor(Math.random() * (100 * (maxA - minA) + 1))) / 100\r\n\t\t\t);\r\n\t\t};\r\n\r\n\r\n\t\tthis.toString = function (format) {\r\n\t\t\tif (format === undefined) {\r\n\t\t\t\tformat = this.getFormat(); // format not specified -> use the current format\r\n\t\t\t}\r\n\t\t\tswitch (format.toLowerCase()) {\r\n\t\t\t\tcase 'hex': return this.toHEXString(); break;\r\n\t\t\t\tcase 'hexa': return this.toHEXAString(); break;\r\n\t\t\t\tcase 'rgb': return this.toRGBString(); break;\r\n\t\t\t\tcase 'rgba': return this.toRGBAString(); break;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t};\r\n\r\n\r\n\t\tthis.toHEXString = function () {\r\n\t\t\treturn jsc.hexColor(\r\n\t\t\t\tthis.channels.r,\r\n\t\t\t\tthis.channels.g,\r\n\t\t\t\tthis.channels.b\r\n\t\t\t);\r\n\t\t};\r\n\r\n\r\n\t\tthis.toHEXAString = function () {\r\n\t\t\treturn jsc.hexaColor(\r\n\t\t\t\tthis.channels.r,\r\n\t\t\t\tthis.channels.g,\r\n\t\t\t\tthis.channels.b,\r\n\t\t\t\tthis.channels.a\r\n\t\t\t);\r\n\t\t};\r\n\r\n\r\n\t\tthis.toRGBString = function () {\r\n\t\t\treturn jsc.rgbColor(\r\n\t\t\t\tthis.channels.r,\r\n\t\t\t\tthis.channels.g,\r\n\t\t\t\tthis.channels.b\r\n\t\t\t);\r\n\t\t};\r\n\r\n\r\n\t\tthis.toRGBAString = function () {\r\n\t\t\treturn jsc.rgbaColor(\r\n\t\t\t\tthis.channels.r,\r\n\t\t\t\tthis.channels.g,\r\n\t\t\t\tthis.channels.b,\r\n\t\t\t\tthis.channels.a\r\n\t\t\t);\r\n\t\t};\r\n\r\n\r\n\t\tthis.toGrayscale = function () {\r\n\t\t\treturn (\r\n\t\t\t\t0.213 * this.channels.r +\r\n\t\t\t\t0.715 * this.channels.g +\r\n\t\t\t\t0.072 * this.channels.b\r\n\t\t\t);\r\n\t\t};\r\n\r\n\r\n\t\tthis.toCanvas = function () {\r\n\t\t\treturn jsc.genColorPreviewCanvas(this.toRGBAString()).canvas;\r\n\t\t};\r\n\r\n\r\n\t\tthis.toDataURL = function () {\r\n\t\t\treturn this.toCanvas().toDataURL();\r\n\t\t};\r\n\r\n\r\n\t\tthis.toBackground = function () {\r\n\t\t\treturn jsc.pub.background(this.toRGBAString());\r\n\t\t};\r\n\r\n\r\n\t\tthis.isLight = function () {\r\n\t\t\treturn this.toGrayscale() > 255 / 2;\r\n\t\t};\r\n\r\n\r\n\t\tthis.hide = function () {\r\n\t\t\tif (isPickerOwner()) {\r\n\t\t\t\tdetachPicker();\r\n\t\t\t}\r\n\t\t};\r\n\r\n\r\n\t\tthis.show = function () {\r\n\t\t\tdrawPicker();\r\n\t\t};\r\n\r\n\r\n\t\tthis.redraw = function () {\r\n\t\t\tif (isPickerOwner()) {\r\n\t\t\t\tdrawPicker();\r\n\t\t\t}\r\n\t\t};\r\n\r\n\r\n\t\tthis.getFormat = function () {\r\n\t\t\treturn this._currentFormat;\r\n\t\t};\r\n\r\n\r\n\t\tthis._setFormat = function (format) {\r\n\t\t\tthis._currentFormat = format.toLowerCase();\r\n\t\t};\r\n\r\n\r\n\t\tthis.hasAlphaChannel = function () {\r\n\t\t\tif (this.alphaChannel === 'auto') {\r\n\t\t\t\treturn (\r\n\t\t\t\t\tthis.format.toLowerCase() === 'any' || // format can change on the fly (e.g. from hex to rgba), so let's consider the alpha channel enabled\r\n\t\t\t\t\tjsc.isAlphaFormat(this.getFormat()) || // the current format supports alpha channel\r\n\t\t\t\t\tthis.alpha !== undefined || // initial alpha value is set, so we're working with alpha channel\r\n\t\t\t\t\tthis.alphaElement !== undefined // the alpha value is redirected, so we're working with alpha channel\r\n\t\t\t\t);\r\n\t\t\t}\r\n\r\n\t\t\treturn this.alphaChannel; // the alpha channel is explicitly set\r\n\t\t};\r\n\r\n\r\n\t\tthis.processValueInput = function (str) {\r\n\t\t\tif (!this.fromString(str)) {\r\n\t\t\t\t// could not parse the color value - let's just expose the current color\r\n\t\t\t\tthis.exposeColor();\r\n\t\t\t}\r\n\t\t};\r\n\r\n\r\n\t\tthis.processAlphaInput = function (str) {\r\n\t\t\tif (!this.fromHSVA(null, null, null, parseFloat(str))) {\r\n\t\t\t\t// could not parse the alpha value - let's just expose the current color\r\n\t\t\t\tthis.exposeColor();\r\n\t\t\t}\r\n\t\t};\r\n\r\n\r\n\t\tthis.exposeColor = function (flags) {\r\n\t\t\tvar colorStr = this.toString();\r\n\t\t\tvar fmt = this.getFormat();\r\n\r\n\t\t\t// reflect current color in data- attribute\r\n\t\t\tjsc.setDataAttr(this.targetElement, 'current-color', colorStr);\r\n\r\n\t\t\tif (!(flags & jsc.flags.leaveValue) && this.valueElement) {\r\n\t\t\t\tif (fmt === 'hex' || fmt === 'hexa') {\r\n\t\t\t\t\tif (!this.uppercase) { colorStr = colorStr.toLowerCase(); }\r\n\t\t\t\t\tif (!this.hash) { colorStr = colorStr.replace(/^#/, ''); }\r\n\t\t\t\t}\r\n\t\t\t\tthis.setValueElementValue(colorStr);\r\n\t\t\t}\r\n\r\n\t\t\tif (!(flags & jsc.flags.leaveAlpha) && this.alphaElement) {\r\n\t\t\t\tvar alphaVal = Math.round(this.channels.a * 100) / 100;\r\n\t\t\t\tthis.setAlphaElementValue(alphaVal);\r\n\t\t\t}\r\n\r\n\t\t\tif (!(flags & jsc.flags.leavePreview) && this.previewElement) {\r\n\t\t\t\tvar previewPos = null; // 'left' | 'right' (null -> fill the entire element)\r\n\r\n\t\t\t\tif (\r\n\t\t\t\t\tjsc.isTextInput(this.previewElement) || // text input\r\n\t\t\t\t\t(jsc.isButton(this.previewElement) && !jsc.isButtonEmpty(this.previewElement)) // button with text\r\n\t\t\t\t) {\r\n\t\t\t\t\tpreviewPos = this.previewPosition;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.setPreviewElementBg(this.toRGBAString());\r\n\t\t\t}\r\n\r\n\t\t\tif (isPickerOwner()) {\r\n\t\t\t\tredrawPad();\r\n\t\t\t\tredrawSld();\r\n\t\t\t\tredrawASld();\r\n\t\t\t}\r\n\t\t};\r\n\r\n\r\n\t\tthis.setPreviewElementBg = function (color) {\r\n\t\t\tif (!this.previewElement) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar position = null; // color preview position:  null | 'left' | 'right'\r\n\t\t\tvar width = null; // color preview width:  px | null = fill the entire element\r\n\t\t\tif (\r\n\t\t\t\tjsc.isTextInput(this.previewElement) || // text input\r\n\t\t\t\t(jsc.isButton(this.previewElement) && !jsc.isButtonEmpty(this.previewElement)) // button with text\r\n\t\t\t) {\r\n\t\t\t\tposition = this.previewPosition;\r\n\t\t\t\twidth = this.previewSize;\r\n\t\t\t}\r\n\r\n\t\t\tvar backgrounds = [];\r\n\r\n\t\t\tif (!color) {\r\n\t\t\t\t// there is no color preview to display -> let's remove any previous background image\r\n\t\t\t\tbackgrounds.push({\r\n\t\t\t\t\timage: 'none',\r\n\t\t\t\t\tposition: 'left top',\r\n\t\t\t\t\tsize: 'auto',\r\n\t\t\t\t\trepeat: 'no-repeat',\r\n\t\t\t\t\torigin: 'padding-box',\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\t// CSS gradient for background color preview\r\n\t\t\t\tbackgrounds.push({\r\n\t\t\t\t\timage: jsc.genColorPreviewGradient(\r\n\t\t\t\t\t\tcolor,\r\n\t\t\t\t\t\tposition,\r\n\t\t\t\t\t\twidth ? width - jsc.pub.previewSeparator.length : null\r\n\t\t\t\t\t),\r\n\t\t\t\t\tposition: 'left top',\r\n\t\t\t\t\tsize: 'auto',\r\n\t\t\t\t\trepeat: position ? 'repeat-y' : 'repeat',\r\n\t\t\t\t\torigin: 'padding-box',\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// data URL of generated PNG image with a gray transparency chessboard\r\n\t\t\t\tvar preview = jsc.genColorPreviewCanvas(\r\n\t\t\t\t\t'rgba(0,0,0,0)',\r\n\t\t\t\t\tposition ? {'left':'right', 'right':'left'}[position] : null,\r\n\t\t\t\t\twidth,\r\n\t\t\t\t\ttrue\r\n\t\t\t\t);\r\n\t\t\t\tbackgrounds.push({\r\n\t\t\t\t\timage: 'url(\\'' + preview.canvas.toDataURL() + '\\')',\r\n\t\t\t\t\tposition: (position || 'left') + ' top',\r\n\t\t\t\t\tsize: preview.width + 'px ' + preview.height + 'px',\r\n\t\t\t\t\trepeat: position ? 'repeat-y' : 'repeat',\r\n\t\t\t\t\torigin: 'padding-box',\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tvar bg = {\r\n\t\t\t\timage: [],\r\n\t\t\t\tposition: [],\r\n\t\t\t\tsize: [],\r\n\t\t\t\trepeat: [],\r\n\t\t\t\torigin: [],\r\n\t\t\t};\r\n\t\t\tfor (var i = 0; i < backgrounds.length; i += 1) {\r\n\t\t\t\tbg.image.push(backgrounds[i].image);\r\n\t\t\t\tbg.position.push(backgrounds[i].position);\r\n\t\t\t\tbg.size.push(backgrounds[i].size);\r\n\t\t\t\tbg.repeat.push(backgrounds[i].repeat);\r\n\t\t\t\tbg.origin.push(backgrounds[i].origin);\r\n\t\t\t}\r\n\r\n\t\t\t// set previewElement's background-images\r\n\t\t\tvar sty = {\r\n\t\t\t\t'background-image': bg.image.join(', '),\r\n\t\t\t\t'background-position': bg.position.join(', '),\r\n\t\t\t\t'background-size': bg.size.join(', '),\r\n\t\t\t\t'background-repeat': bg.repeat.join(', '),\r\n\t\t\t\t'background-origin': bg.origin.join(', '),\r\n\t\t\t};\r\n\t\t\tjsc.setStyle(this.previewElement, sty, this.forceStyle);\r\n\r\n\r\n\t\t\t// set/restore previewElement's padding\r\n\t\t\tvar padding = {\r\n\t\t\t\tleft: null,\r\n\t\t\t\tright: null,\r\n\t\t\t};\r\n\t\t\tif (position) {\r\n\t\t\t\tpadding[position] = (this.previewSize + this.previewPadding) + 'px';\r\n\t\t\t}\r\n\r\n\t\t\tvar sty = {\r\n\t\t\t\t'padding-left': padding.left,\r\n\t\t\t\t'padding-right': padding.right,\r\n\t\t\t};\r\n\t\t\tjsc.setStyle(this.previewElement, sty, this.forceStyle, true);\r\n\t\t};\r\n\r\n\r\n\t\tthis.setValueElementValue = function (str) {\r\n\t\t\tif (this.valueElement) {\r\n\t\t\t\tif (jsc.nodeName(this.valueElement) === 'input') {\r\n\t\t\t\t\tthis.valueElement.value = str;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.valueElement.innerHTML = str;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\r\n\r\n\t\tthis.setAlphaElementValue = function (str) {\r\n\t\t\tif (this.alphaElement) {\r\n\t\t\t\tif (jsc.nodeName(this.alphaElement) === 'input') {\r\n\t\t\t\t\tthis.alphaElement.value = str;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.alphaElement.innerHTML = str;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\r\n\r\n\t\tthis._processParentElementsInDOM = function () {\r\n\t\t\tif (this._parentElementsProcessed) { return; }\r\n\t\t\tthis._parentElementsProcessed = true;\r\n\r\n\t\t\tvar elm = this.targetElement;\r\n\t\t\tdo {\r\n\t\t\t\t// If the target element or one of its parent nodes has fixed position,\r\n\t\t\t\t// then use fixed positioning instead\r\n\t\t\t\tvar compStyle = jsc.getCompStyle(elm);\r\n\t\t\t\tif (compStyle.position && compStyle.position.toLowerCase() === 'fixed') {\r\n\t\t\t\t\tthis.fixed = true;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (elm !== this.targetElement) {\r\n\t\t\t\t\t// Ensure to attach onParentScroll only once to each parent element\r\n\t\t\t\t\t// (multiple targetElements can share the same parent nodes)\r\n\t\t\t\t\t//\r\n\t\t\t\t\t// Note: It's not just offsetParents that can be scrollable,\r\n\t\t\t\t\t// that's why we loop through all parent nodes\r\n\t\t\t\t\tif (!jsc.getData(elm, 'hasScrollListener')) {\r\n\t\t\t\t\t\telm.addEventListener('scroll', jsc.onParentScroll, false);\r\n\t\t\t\t\t\tjsc.setData(elm, 'hasScrollListener', true);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} while ((elm = elm.parentNode) && jsc.nodeName(elm) !== 'body');\r\n\t\t};\r\n\r\n\r\n\t\tthis.tryHide = function () {\r\n\t\t\tif (this.hideOnLeave) {\r\n\t\t\t\tthis.hide();\r\n\t\t\t}\r\n\t\t};\r\n\r\n\r\n\t\tthis.set__palette = function (val) {\r\n\t\t\tthis.palette = val;\r\n\t\t\tthis._palette = jsc.parsePaletteValue(val);\r\n\t\t\tthis._paletteHasTransparency = jsc.containsTranparentColor(this._palette);\r\n\t\t};\r\n\r\n\r\n\t\tfunction setOption (option, value) {\r\n\t\t\tif (typeof option !== 'string') {\r\n\t\t\t\tthrow new Error('Invalid value for option name: ' + option);\r\n\t\t\t}\r\n\r\n\t\t\t// enum option\r\n\t\t\tif (jsc.enumOpts.hasOwnProperty(option)) {\r\n\t\t\t\tif (typeof value === 'string') { // enum string values are case insensitive\r\n\t\t\t\t\tvalue = value.toLowerCase();\r\n\t\t\t\t}\r\n\t\t\t\tif (jsc.enumOpts[option].indexOf(value) === -1) {\r\n\t\t\t\t\tthrow new Error('Option \\'' + option + '\\' has invalid value: ' + value);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// deprecated option\r\n\t\t\tif (jsc.deprecatedOpts.hasOwnProperty(option)) {\r\n\t\t\t\tvar oldOpt = option;\r\n\t\t\t\tvar newOpt = jsc.deprecatedOpts[option];\r\n\t\t\t\tif (newOpt) {\r\n\t\t\t\t\t// if we have a new name for this option, let's log a warning and use the new name\r\n\t\t\t\t\tconsole.warn('Option \\'%s\\' is DEPRECATED, using \\'%s\\' instead.' + jsc.docsRef, oldOpt, newOpt);\r\n\t\t\t\t\toption = newOpt;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// new name not available for the option\r\n\t\t\t\t\tthrow new Error('Option \\'' + option + '\\' is DEPRECATED');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar setter = 'set__' + option;\r\n\r\n\t\t\tif (typeof THIS[setter] === 'function') { // a setter exists for this option\r\n\t\t\t\tTHIS[setter](value);\r\n\t\t\t\treturn true;\r\n\r\n\t\t\t} else if (option in THIS) { // option exists as a property\r\n\t\t\t\tTHIS[option] = value;\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\r\n\t\t\tthrow new Error('Unrecognized configuration option: ' + option);\r\n\t\t}\r\n\r\n\r\n\t\tfunction getOption (option) {\r\n\t\t\tif (typeof option !== 'string') {\r\n\t\t\t\tthrow new Error('Invalid value for option name: ' + option);\r\n\t\t\t}\r\n\r\n\t\t\t// deprecated option\r\n\t\t\tif (jsc.deprecatedOpts.hasOwnProperty(option)) {\r\n\t\t\t\tvar oldOpt = option;\r\n\t\t\t\tvar newOpt = jsc.deprecatedOpts[option];\r\n\t\t\t\tif (newOpt) {\r\n\t\t\t\t\t// if we have a new name for this option, let's log a warning and use the new name\r\n\t\t\t\t\tconsole.warn('Option \\'%s\\' is DEPRECATED, using \\'%s\\' instead.' + jsc.docsRef, oldOpt, newOpt);\r\n\t\t\t\t\toption = newOpt;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// new name not available for the option\r\n\t\t\t\t\tthrow new Error('Option \\'' + option + '\\' is DEPRECATED');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar getter = 'get__' + option;\r\n\r\n\t\t\tif (typeof THIS[getter] === 'function') { // a getter exists for this option\r\n\t\t\t\treturn THIS[getter](value);\r\n\r\n\t\t\t} else if (option in THIS) { // option exists as a property\r\n\t\t\t\treturn THIS[option];\r\n\t\t\t}\r\n\r\n\t\t\tthrow new Error('Unrecognized configuration option: ' + option);\r\n\t\t}\r\n\r\n\r\n\t\tfunction detachPicker () {\r\n\t\t\tjsc.removeClass(THIS.targetElement, jsc.pub.activeClassName);\r\n\t\t\tjsc.picker.wrap.parentNode.removeChild(jsc.picker.wrap);\r\n\t\t\tdelete jsc.picker.owner;\r\n\t\t}\r\n\r\n\r\n\t\tfunction drawPicker () {\r\n\r\n\t\t\t// At this point, when drawing the picker, we know what the parent elements are\r\n\t\t\t// and we can do all related DOM operations, such as registering events on them\r\n\t\t\t// or checking their positioning\r\n\t\t\tTHIS._processParentElementsInDOM();\r\n\r\n\t\t\tif (!jsc.picker) {\r\n\t\t\t\tjsc.picker = {\r\n\t\t\t\t\towner: null, // owner picker instance\r\n\t\t\t\t\twrap : jsc.createEl('div'),\r\n\t\t\t\t\tbox : jsc.createEl('div'),\r\n\t\t\t\t\tboxS : jsc.createEl('div'), // shadow area\r\n\t\t\t\t\tboxB : jsc.createEl('div'), // border\r\n\t\t\t\t\tpad : jsc.createEl('div'),\r\n\t\t\t\t\tpadB : jsc.createEl('div'), // border\r\n\t\t\t\t\tpadM : jsc.createEl('div'), // mouse/touch area\r\n\t\t\t\t\tpadCanvas : jsc.createPadCanvas(),\r\n\t\t\t\t\tcross : jsc.createEl('div'),\r\n\t\t\t\t\tcrossBY : jsc.createEl('div'), // border Y\r\n\t\t\t\t\tcrossBX : jsc.createEl('div'), // border X\r\n\t\t\t\t\tcrossLY : jsc.createEl('div'), // line Y\r\n\t\t\t\t\tcrossLX : jsc.createEl('div'), // line X\r\n\t\t\t\t\tsld : jsc.createEl('div'), // slider\r\n\t\t\t\t\tsldB : jsc.createEl('div'), // border\r\n\t\t\t\t\tsldM : jsc.createEl('div'), // mouse/touch area\r\n\t\t\t\t\tsldGrad : jsc.createSliderGradient(),\r\n\t\t\t\t\tsldPtrS : jsc.createEl('div'), // slider pointer spacer\r\n\t\t\t\t\tsldPtrIB : jsc.createEl('div'), // slider pointer inner border\r\n\t\t\t\t\tsldPtrMB : jsc.createEl('div'), // slider pointer middle border\r\n\t\t\t\t\tsldPtrOB : jsc.createEl('div'), // slider pointer outer border\r\n\t\t\t\t\tasld : jsc.createEl('div'), // alpha slider\r\n\t\t\t\t\tasldB : jsc.createEl('div'), // border\r\n\t\t\t\t\tasldM : jsc.createEl('div'), // mouse/touch area\r\n\t\t\t\t\tasldGrad : jsc.createASliderGradient(),\r\n\t\t\t\t\tasldPtrS : jsc.createEl('div'), // slider pointer spacer\r\n\t\t\t\t\tasldPtrIB : jsc.createEl('div'), // slider pointer inner border\r\n\t\t\t\t\tasldPtrMB : jsc.createEl('div'), // slider pointer middle border\r\n\t\t\t\t\tasldPtrOB : jsc.createEl('div'), // slider pointer outer border\r\n\t\t\t\t\tpal : jsc.createEl('div'), // palette\r\n\t\t\t\t\tbtn : jsc.createEl('div'),\r\n\t\t\t\t\tbtnT : jsc.createEl('div'), // text\r\n\t\t\t\t};\r\n\r\n\t\t\t\tjsc.picker.pad.appendChild(jsc.picker.padCanvas.elm);\r\n\t\t\t\tjsc.picker.padB.appendChild(jsc.picker.pad);\r\n\t\t\t\tjsc.picker.cross.appendChild(jsc.picker.crossBY);\r\n\t\t\t\tjsc.picker.cross.appendChild(jsc.picker.crossBX);\r\n\t\t\t\tjsc.picker.cross.appendChild(jsc.picker.crossLY);\r\n\t\t\t\tjsc.picker.cross.appendChild(jsc.picker.crossLX);\r\n\t\t\t\tjsc.picker.padB.appendChild(jsc.picker.cross);\r\n\t\t\t\tjsc.picker.box.appendChild(jsc.picker.padB);\r\n\t\t\t\tjsc.picker.box.appendChild(jsc.picker.padM);\r\n\r\n\t\t\t\tjsc.picker.sld.appendChild(jsc.picker.sldGrad.elm);\r\n\t\t\t\tjsc.picker.sldB.appendChild(jsc.picker.sld);\r\n\t\t\t\tjsc.picker.sldB.appendChild(jsc.picker.sldPtrOB);\r\n\t\t\t\tjsc.picker.sldPtrOB.appendChild(jsc.picker.sldPtrMB);\r\n\t\t\t\tjsc.picker.sldPtrMB.appendChild(jsc.picker.sldPtrIB);\r\n\t\t\t\tjsc.picker.sldPtrIB.appendChild(jsc.picker.sldPtrS);\r\n\t\t\t\tjsc.picker.box.appendChild(jsc.picker.sldB);\r\n\t\t\t\tjsc.picker.box.appendChild(jsc.picker.sldM);\r\n\r\n\t\t\t\tjsc.picker.asld.appendChild(jsc.picker.asldGrad.elm);\r\n\t\t\t\tjsc.picker.asldB.appendChild(jsc.picker.asld);\r\n\t\t\t\tjsc.picker.asldB.appendChild(jsc.picker.asldPtrOB);\r\n\t\t\t\tjsc.picker.asldPtrOB.appendChild(jsc.picker.asldPtrMB);\r\n\t\t\t\tjsc.picker.asldPtrMB.appendChild(jsc.picker.asldPtrIB);\r\n\t\t\t\tjsc.picker.asldPtrIB.appendChild(jsc.picker.asldPtrS);\r\n\t\t\t\tjsc.picker.box.appendChild(jsc.picker.asldB);\r\n\t\t\t\tjsc.picker.box.appendChild(jsc.picker.asldM);\r\n\r\n\t\t\t\tjsc.picker.box.appendChild(jsc.picker.pal);\r\n\r\n\t\t\t\tjsc.picker.btn.appendChild(jsc.picker.btnT);\r\n\t\t\t\tjsc.picker.box.appendChild(jsc.picker.btn);\r\n\r\n\t\t\t\tjsc.picker.boxB.appendChild(jsc.picker.box);\r\n\t\t\t\tjsc.picker.wrap.appendChild(jsc.picker.boxS);\r\n\t\t\t\tjsc.picker.wrap.appendChild(jsc.picker.boxB);\r\n\r\n\t\t\t\tjsc.picker.wrap.addEventListener('touchstart', jsc.onPickerTouchStart,\r\n\t\t\t\t\tjsc.isPassiveEventSupported ? {passive: false} : false);\r\n\t\t\t}\r\n\r\n\t\t\tvar p = jsc.picker;\r\n\r\n\t\t\tvar displaySlider = !!jsc.getSliderChannel(THIS);\r\n\t\t\tvar displayAlphaSlider = THIS.hasAlphaChannel();\r\n\t\t\tvar pickerDims = jsc.getPickerDims(THIS);\r\n\t\t\tvar crossOuterSize = (2 * THIS.pointerBorderWidth + THIS.pointerThickness + 2 * THIS.crossSize);\r\n\t\t\tvar controlPadding = jsc.getControlPadding(THIS);\r\n\t\t\tvar borderRadius = Math.min(\r\n\t\t\t\tTHIS.borderRadius,\r\n\t\t\t\tMath.round(THIS.padding * Math.PI)); // px\r\n\t\t\tvar padCursor = 'crosshair';\r\n\r\n\t\t\t// wrap\r\n\t\t\tp.wrap.className = 'jscolor-wrap';\r\n\t\t\tp.wrap.style.width = pickerDims.borderW + 'px';\r\n\t\t\tp.wrap.style.height = pickerDims.borderH + 'px';\r\n\t\t\tp.wrap.style.zIndex = THIS.zIndex;\r\n\r\n\t\t\t// picker\r\n\t\t\tp.box.className = 'jscolor-picker';\r\n\t\t\tp.box.style.width = pickerDims.paddedW + 'px';\r\n\t\t\tp.box.style.height = pickerDims.paddedH + 'px';\r\n\r\n\t\t\t// picker shadow\r\n\t\t\tp.boxS.className = 'jscolor-shadow';\r\n\t\t\tjsc.setBorderRadius(p.boxS, borderRadius + 'px');\r\n\r\n\t\t\t// picker border\r\n\t\t\tp.boxB.className = 'jscolor-border';\r\n\t\t\tp.boxB.style.border = THIS.borderWidth + 'px solid';\r\n\t\t\tp.boxB.style.borderColor = THIS.borderColor;\r\n\t\t\tp.boxB.style.background = THIS.backgroundColor;\r\n\t\t\tjsc.setBorderRadius(p.boxB, borderRadius + 'px');\r\n\r\n\t\t\t// IE hack:\r\n\t\t\t// If the element is transparent, IE will trigger the event on the elements under it,\r\n\t\t\t// e.g. on Canvas or on elements with border\r\n\t\t\tp.padM.style.background = 'rgba(255,0,0,.2)';\r\n\t\t\tp.sldM.style.background = 'rgba(0,255,0,.2)';\r\n\t\t\tp.asldM.style.background = 'rgba(0,0,255,.2)';\r\n\r\n\t\t\tp.padM.style.opacity =\r\n\t\t\tp.sldM.style.opacity =\r\n\t\t\tp.asldM.style.opacity =\r\n\t\t\t\t'0';\r\n\r\n\t\t\t// pad\r\n\t\t\tp.pad.style.position = 'relative';\r\n\t\t\tp.pad.style.width = THIS.width + 'px';\r\n\t\t\tp.pad.style.height = THIS.height + 'px';\r\n\r\n\t\t\t// pad - color spectrum (HSV and HVS)\r\n\t\t\tp.padCanvas.draw(THIS.width, THIS.height, jsc.getPadYChannel(THIS));\r\n\r\n\t\t\t// pad border\r\n\t\t\tp.padB.style.position = 'absolute';\r\n\t\t\tp.padB.style.left = THIS.padding + 'px';\r\n\t\t\tp.padB.style.top = THIS.padding + 'px';\r\n\t\t\tp.padB.style.border = THIS.controlBorderWidth + 'px solid';\r\n\t\t\tp.padB.style.borderColor = THIS.controlBorderColor;\r\n\r\n\t\t\t// pad mouse area\r\n\t\t\tp.padM.style.position = 'absolute';\r\n\t\t\tp.padM.style.left = 0 + 'px';\r\n\t\t\tp.padM.style.top = 0 + 'px';\r\n\t\t\tp.padM.style.width = (THIS.padding + 2 * THIS.controlBorderWidth + THIS.width + controlPadding) + 'px';\r\n\t\t\tp.padM.style.height = (2 * THIS.controlBorderWidth + 2 * THIS.padding + THIS.height) + 'px';\r\n\t\t\tp.padM.style.cursor = padCursor;\r\n\t\t\tjsc.setData(p.padM, {\r\n\t\t\t\tinstance: THIS,\r\n\t\t\t\tcontrol: 'pad',\r\n\t\t\t})\r\n\r\n\t\t\t// pad cross\r\n\t\t\tp.cross.style.position = 'absolute';\r\n\t\t\tp.cross.style.left =\r\n\t\t\tp.cross.style.top =\r\n\t\t\t\t'0';\r\n\t\t\tp.cross.style.width =\r\n\t\t\tp.cross.style.height =\r\n\t\t\t\tcrossOuterSize + 'px';\r\n\r\n\t\t\t// pad cross border Y and X\r\n\t\t\tp.crossBY.style.position =\r\n\t\t\tp.crossBX.style.position =\r\n\t\t\t\t'absolute';\r\n\t\t\tp.crossBY.style.background =\r\n\t\t\tp.crossBX.style.background =\r\n\t\t\t\tTHIS.pointerBorderColor;\r\n\t\t\tp.crossBY.style.width =\r\n\t\t\tp.crossBX.style.height =\r\n\t\t\t\t(2 * THIS.pointerBorderWidth + THIS.pointerThickness) + 'px';\r\n\t\t\tp.crossBY.style.height =\r\n\t\t\tp.crossBX.style.width =\r\n\t\t\t\tcrossOuterSize + 'px';\r\n\t\t\tp.crossBY.style.left =\r\n\t\t\tp.crossBX.style.top =\r\n\t\t\t\t(Math.floor(crossOuterSize / 2) - Math.floor(THIS.pointerThickness / 2) - THIS.pointerBorderWidth) + 'px';\r\n\t\t\tp.crossBY.style.top =\r\n\t\t\tp.crossBX.style.left =\r\n\t\t\t\t'0';\r\n\r\n\t\t\t// pad cross line Y and X\r\n\t\t\tp.crossLY.style.position =\r\n\t\t\tp.crossLX.style.position =\r\n\t\t\t\t'absolute';\r\n\t\t\tp.crossLY.style.background =\r\n\t\t\tp.crossLX.style.background =\r\n\t\t\t\tTHIS.pointerColor;\r\n\t\t\tp.crossLY.style.height =\r\n\t\t\tp.crossLX.style.width =\r\n\t\t\t\t(crossOuterSize - 2 * THIS.pointerBorderWidth) + 'px';\r\n\t\t\tp.crossLY.style.width =\r\n\t\t\tp.crossLX.style.height =\r\n\t\t\t\tTHIS.pointerThickness + 'px';\r\n\t\t\tp.crossLY.style.left =\r\n\t\t\tp.crossLX.style.top =\r\n\t\t\t\t(Math.floor(crossOuterSize / 2) - Math.floor(THIS.pointerThickness / 2)) + 'px';\r\n\t\t\tp.crossLY.style.top =\r\n\t\t\tp.crossLX.style.left =\r\n\t\t\t\tTHIS.pointerBorderWidth + 'px';\r\n\r\n\r\n\t\t\t// slider\r\n\t\t\tp.sld.style.overflow = 'hidden';\r\n\t\t\tp.sld.style.width = THIS.sliderSize + 'px';\r\n\t\t\tp.sld.style.height = THIS.height + 'px';\r\n\r\n\t\t\t// slider gradient\r\n\t\t\tp.sldGrad.draw(THIS.sliderSize, THIS.height, '#000', '#000');\r\n\r\n\t\t\t// slider border\r\n\t\t\tp.sldB.style.display = displaySlider ? 'block' : 'none';\r\n\t\t\tp.sldB.style.position = 'absolute';\r\n\t\t\tp.sldB.style.left = (THIS.padding + THIS.width + 2 * THIS.controlBorderWidth + 2 * controlPadding) + 'px';\r\n\t\t\tp.sldB.style.top = THIS.padding + 'px';\r\n\t\t\tp.sldB.style.border = THIS.controlBorderWidth + 'px solid';\r\n\t\t\tp.sldB.style.borderColor = THIS.controlBorderColor;\r\n\r\n\t\t\t// slider mouse area\r\n\t\t\tp.sldM.style.display = displaySlider ? 'block' : 'none';\r\n\t\t\tp.sldM.style.position = 'absolute';\r\n\t\t\tp.sldM.style.left = (THIS.padding + THIS.width + 2 * THIS.controlBorderWidth + controlPadding) + 'px';\r\n\t\t\tp.sldM.style.top = 0 + 'px';\r\n\t\t\tp.sldM.style.width = (\r\n\t\t\t\t\t(THIS.sliderSize + 2 * controlPadding + 2 * THIS.controlBorderWidth) +\r\n\t\t\t\t\t(displayAlphaSlider ? 0 : Math.max(0, THIS.padding - controlPadding)) // remaining padding to the right edge\r\n\t\t\t\t) + 'px';\r\n\t\t\tp.sldM.style.height = (2 * THIS.controlBorderWidth + 2 * THIS.padding + THIS.height) + 'px';\r\n\t\t\tp.sldM.style.cursor = 'default';\r\n\t\t\tjsc.setData(p.sldM, {\r\n\t\t\t\tinstance: THIS,\r\n\t\t\t\tcontrol: 'sld',\r\n\t\t\t});\r\n\r\n\t\t\t// slider pointer inner and outer border\r\n\t\t\tp.sldPtrIB.style.border =\r\n\t\t\tp.sldPtrOB.style.border =\r\n\t\t\t\tTHIS.pointerBorderWidth + 'px solid ' + THIS.pointerBorderColor;\r\n\r\n\t\t\t// slider pointer outer border\r\n\t\t\tp.sldPtrOB.style.position = 'absolute';\r\n\t\t\tp.sldPtrOB.style.left = -(2 * THIS.pointerBorderWidth + THIS.pointerThickness) + 'px';\r\n\t\t\tp.sldPtrOB.style.top = '0';\r\n\r\n\t\t\t// slider pointer middle border\r\n\t\t\tp.sldPtrMB.style.border = THIS.pointerThickness + 'px solid ' + THIS.pointerColor;\r\n\r\n\t\t\t// slider pointer spacer\r\n\t\t\tp.sldPtrS.style.width = THIS.sliderSize + 'px';\r\n\t\t\tp.sldPtrS.style.height = jsc.pub.sliderInnerSpace + 'px';\r\n\r\n\r\n\t\t\t// alpha slider\r\n\t\t\tp.asld.style.overflow = 'hidden';\r\n\t\t\tp.asld.style.width = THIS.sliderSize + 'px';\r\n\t\t\tp.asld.style.height = THIS.height + 'px';\r\n\r\n\t\t\t// alpha slider gradient\r\n\t\t\tp.asldGrad.draw(THIS.sliderSize, THIS.height, '#000');\r\n\r\n\t\t\t// alpha slider border\r\n\t\t\tp.asldB.style.display = displayAlphaSlider ? 'block' : 'none';\r\n\t\t\tp.asldB.style.position = 'absolute';\r\n\t\t\tp.asldB.style.left = (\r\n\t\t\t\t\t(THIS.padding + THIS.width + 2 * THIS.controlBorderWidth + controlPadding) +\r\n\t\t\t\t\t(displaySlider ? (THIS.sliderSize + 3 * controlPadding + 2 * THIS.controlBorderWidth) : 0)\r\n\t\t\t\t) + 'px';\r\n\t\t\tp.asldB.style.top = THIS.padding + 'px';\r\n\t\t\tp.asldB.style.border = THIS.controlBorderWidth + 'px solid';\r\n\t\t\tp.asldB.style.borderColor = THIS.controlBorderColor;\r\n\r\n\t\t\t// alpha slider mouse area\r\n\t\t\tp.asldM.style.display = displayAlphaSlider ? 'block' : 'none';\r\n\t\t\tp.asldM.style.position = 'absolute';\r\n\t\t\tp.asldM.style.left = (\r\n\t\t\t\t\t(THIS.padding + THIS.width + 2 * THIS.controlBorderWidth + controlPadding) +\r\n\t\t\t\t\t(displaySlider ? (THIS.sliderSize + 2 * controlPadding + 2 * THIS.controlBorderWidth) : 0)\r\n\t\t\t\t) + 'px';\r\n\t\t\tp.asldM.style.top = 0 + 'px';\r\n\t\t\tp.asldM.style.width = (\r\n\t\t\t\t\t(THIS.sliderSize + 2 * controlPadding + 2 * THIS.controlBorderWidth) +\r\n\t\t\t\t\tMath.max(0, THIS.padding - controlPadding) // remaining padding to the right edge\r\n\t\t\t\t) + 'px';\r\n\t\t\tp.asldM.style.height = (2 * THIS.controlBorderWidth + 2 * THIS.padding + THIS.height) + 'px';\r\n\t\t\tp.asldM.style.cursor = 'default';\r\n\t\t\tjsc.setData(p.asldM, {\r\n\t\t\t\tinstance: THIS,\r\n\t\t\t\tcontrol: 'asld',\r\n\t\t\t})\r\n\r\n\t\t\t// alpha slider pointer inner and outer border\r\n\t\t\tp.asldPtrIB.style.border =\r\n\t\t\tp.asldPtrOB.style.border =\r\n\t\t\t\tTHIS.pointerBorderWidth + 'px solid ' + THIS.pointerBorderColor;\r\n\r\n\t\t\t// alpha slider pointer outer border\r\n\t\t\tp.asldPtrOB.style.position = 'absolute';\r\n\t\t\tp.asldPtrOB.style.left = -(2 * THIS.pointerBorderWidth + THIS.pointerThickness) + 'px';\r\n\t\t\tp.asldPtrOB.style.top = '0';\r\n\r\n\t\t\t// alpha slider pointer middle border\r\n\t\t\tp.asldPtrMB.style.border = THIS.pointerThickness + 'px solid ' + THIS.pointerColor;\r\n\r\n\t\t\t// alpha slider pointer spacer\r\n\t\t\tp.asldPtrS.style.width = THIS.sliderSize + 'px';\r\n\t\t\tp.asldPtrS.style.height = jsc.pub.sliderInnerSpace + 'px';\r\n\r\n\r\n\t\t\t// palette\r\n\t\t\tp.pal.className = 'jscolor-palette';\r\n\t\t\tp.pal.style.display = pickerDims.palette.rows ? 'block' : 'none';\r\n\t\t\tp.pal.style.left = THIS.padding + 'px';\r\n\t\t\tp.pal.style.top = (2 * THIS.controlBorderWidth + 2 * THIS.padding + THIS.height) + 'px';\r\n\r\n\t\t\t// palette's color samples\r\n\r\n\t\t\tp.pal.innerHTML = '';\r\n\r\n\t\t\tvar chessboard = jsc.genColorPreviewCanvas('rgba(0,0,0,0)');\r\n\r\n\t\t\tvar si = 0; // color sample's index\r\n\t\t\tfor (var r = 0; r < pickerDims.palette.rows; r++) {\r\n\t\t\t\tfor (var c = 0; c < pickerDims.palette.cols && si < THIS._palette.length; c++, si++) {\r\n\t\t\t\t\tvar sampleColor = THIS._palette[si];\r\n\t\t\t\t\tvar sampleCssColor = jsc.rgbaColor.apply(null, sampleColor.rgba);\r\n\r\n\t\t\t\t\tvar sc = jsc.createEl('div'); // color sample's color\r\n\t\t\t\t\tsc.style.width = (pickerDims.palette.cellW - 2 * THIS.controlBorderWidth) + 'px';\r\n\t\t\t\t\tsc.style.height = (pickerDims.palette.cellH - 2 * THIS.controlBorderWidth) + 'px';\r\n\t\t\t\t\tsc.style.backgroundColor = sampleCssColor;\r\n\r\n\t\t\t\t\tvar sw = jsc.createEl('div'); // color sample's wrap\r\n\t\t\t\t\tsw.className = 'jscolor-palette-sw';\r\n\t\t\t\t\tsw.style.left =\r\n\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\tpickerDims.palette.cols <= 1 ? 0 :\r\n\t\t\t\t\t\t\tMath.round(10 * (c * ((pickerDims.contentW - pickerDims.palette.cellW) / (pickerDims.palette.cols - 1)))) / 10\r\n\t\t\t\t\t\t) + 'px';\r\n\t\t\t\t\tsw.style.top = (r * (pickerDims.palette.cellH + THIS.paletteSpacing)) + 'px';\r\n\t\t\t\t\tsw.style.border = THIS.controlBorderWidth + 'px solid';\r\n\t\t\t\t\tsw.style.borderColor = THIS.controlBorderColor;\r\n\t\t\t\t\tif (sampleColor.rgba[3] !== null && sampleColor.rgba[3] < 1.0) { // only create chessboard background if the sample has transparency\r\n\t\t\t\t\t\tsw.style.backgroundImage = 'url(\\'' + chessboard.canvas.toDataURL() + '\\')';\r\n\t\t\t\t\t\tsw.style.backgroundRepeat = 'repeat';\r\n\t\t\t\t\t\tsw.style.backgroundPosition = 'center center';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tjsc.setData(sw, {\r\n\t\t\t\t\t\tinstance: THIS,\r\n\t\t\t\t\t\tcontrol: 'palette-sw',\r\n\t\t\t\t\t\tcolor: sampleColor,\r\n\t\t\t\t\t});\r\n\t\t\t\t\tsw.addEventListener('click', jsc.onPaletteSampleClick, false);\r\n\t\t\t\t\tsw.appendChild(sc);\r\n\t\t\t\t\tp.pal.appendChild(sw);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\r\n\t\t\t// the Close button\r\n\t\t\tfunction setBtnBorder () {\r\n\t\t\t\tvar insetColors = THIS.controlBorderColor.split(/\\s+/);\r\n\t\t\t\tvar outsetColor = insetColors.length < 2 ? insetColors[0] : insetColors[1] + ' ' + insetColors[0] + ' ' + insetColors[0] + ' ' + insetColors[1];\r\n\t\t\t\tp.btn.style.borderColor = outsetColor;\r\n\t\t\t}\r\n\t\t\tvar btnPadding = 15; // px\r\n\t\t\tp.btn.className = 'jscolor-btn jscolor-btn-close';\r\n\t\t\tp.btn.style.display = THIS.closeButton ? 'block' : 'none';\r\n\t\t\tp.btn.style.left = THIS.padding + 'px';\r\n\t\t\tp.btn.style.bottom = THIS.padding + 'px';\r\n\t\t\tp.btn.style.padding = '0 ' + btnPadding + 'px';\r\n\t\t\tp.btn.style.maxWidth = (pickerDims.contentW - 2 * THIS.controlBorderWidth - 2 * btnPadding) + 'px';\r\n\t\t\tp.btn.style.height = THIS.buttonHeight + 'px';\r\n\t\t\tp.btn.style.border = THIS.controlBorderWidth + 'px solid';\r\n\t\t\tsetBtnBorder();\r\n\t\t\tp.btn.style.color = THIS.buttonColor;\r\n\t\t\tp.btn.onmousedown = function () {\r\n\t\t\t\tTHIS.hide();\r\n\t\t\t};\r\n\t\t\tp.btnT.style.display = 'inline';\r\n\t\t\tp.btnT.style.lineHeight = THIS.buttonHeight + 'px';\r\n\t\t\tp.btnT.innerText = THIS.closeText;\r\n\r\n\t\t\t// reposition the pointers\r\n\t\t\tredrawPad();\r\n\t\t\tredrawSld();\r\n\t\t\tredrawASld();\r\n\r\n\t\t\t// If we are changing the owner without first closing the picker,\r\n\t\t\t// make sure to first deal with the old owner\r\n\t\t\tif (jsc.picker.owner && jsc.picker.owner !== THIS) {\r\n\t\t\t\tjsc.removeClass(jsc.picker.owner.targetElement, jsc.pub.activeClassName);\r\n\t\t\t}\r\n\r\n\t\t\t// Set a new picker owner\r\n\t\t\tjsc.picker.owner = THIS;\r\n\r\n\t\t\t// The redrawPosition() method needs picker.owner to be set, that's why we call it here,\r\n\t\t\t// after setting the owner\r\n\t\t\tjsc.redrawPosition();\r\n\r\n\t\t\tif (p.wrap.parentNode !== THIS.container) {\r\n\t\t\t\tTHIS.container.appendChild(p.wrap);\r\n\t\t\t}\r\n\r\n\t\t\tjsc.addClass(THIS.targetElement, jsc.pub.activeClassName);\r\n\t\t}\r\n\r\n\r\n\t\tfunction redrawPad () {\r\n\t\t\t// redraw the pad pointer\r\n\t\t\tvar yChannel = jsc.getPadYChannel(THIS);\r\n\t\t\tvar x = Math.round((THIS.channels.h / 360) * (THIS.width - 1));\r\n\t\t\tvar y = Math.round((1 - THIS.channels[yChannel] / 100) * (THIS.height - 1));\r\n\t\t\tvar crossOuterSize = (2 * THIS.pointerBorderWidth + THIS.pointerThickness + 2 * THIS.crossSize);\r\n\t\t\tvar ofs = -Math.floor(crossOuterSize / 2);\r\n\t\t\tjsc.picker.cross.style.left = (x + ofs) + 'px';\r\n\t\t\tjsc.picker.cross.style.top = (y + ofs) + 'px';\r\n\r\n\t\t\t// redraw the slider\r\n\t\t\tswitch (jsc.getSliderChannel(THIS)) {\r\n\t\t\tcase 's':\r\n\t\t\t\tvar rgb1 = jsc.HSV_RGB(THIS.channels.h, 100, THIS.channels.v);\r\n\t\t\t\tvar rgb2 = jsc.HSV_RGB(THIS.channels.h, 0, THIS.channels.v);\r\n\t\t\t\tvar color1 = 'rgb(' +\r\n\t\t\t\t\tMath.round(rgb1[0]) + ',' +\r\n\t\t\t\t\tMath.round(rgb1[1]) + ',' +\r\n\t\t\t\t\tMath.round(rgb1[2]) + ')';\r\n\t\t\t\tvar color2 = 'rgb(' +\r\n\t\t\t\t\tMath.round(rgb2[0]) + ',' +\r\n\t\t\t\t\tMath.round(rgb2[1]) + ',' +\r\n\t\t\t\t\tMath.round(rgb2[2]) + ')';\r\n\t\t\t\tjsc.picker.sldGrad.draw(THIS.sliderSize, THIS.height, color1, color2);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'v':\r\n\t\t\t\tvar rgb = jsc.HSV_RGB(THIS.channels.h, THIS.channels.s, 100);\r\n\t\t\t\tvar color1 = 'rgb(' +\r\n\t\t\t\t\tMath.round(rgb[0]) + ',' +\r\n\t\t\t\t\tMath.round(rgb[1]) + ',' +\r\n\t\t\t\t\tMath.round(rgb[2]) + ')';\r\n\t\t\t\tvar color2 = '#000';\r\n\t\t\t\tjsc.picker.sldGrad.draw(THIS.sliderSize, THIS.height, color1, color2);\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\t// redraw the alpha slider\r\n\t\t\tjsc.picker.asldGrad.draw(THIS.sliderSize, THIS.height, THIS.toHEXString());\r\n\t\t}\r\n\r\n\r\n\t\tfunction redrawSld () {\r\n\t\t\tvar sldChannel = jsc.getSliderChannel(THIS);\r\n\t\t\tif (sldChannel) {\r\n\t\t\t\t// redraw the slider pointer\r\n\t\t\t\tvar y = Math.round((1 - THIS.channels[sldChannel] / 100) * (THIS.height - 1));\r\n\t\t\t\tjsc.picker.sldPtrOB.style.top = (y - (2 * THIS.pointerBorderWidth + THIS.pointerThickness) - Math.floor(jsc.pub.sliderInnerSpace / 2)) + 'px';\r\n\t\t\t}\r\n\r\n\t\t\t// redraw the alpha slider\r\n\t\t\tjsc.picker.asldGrad.draw(THIS.sliderSize, THIS.height, THIS.toHEXString());\r\n\t\t}\r\n\r\n\r\n\t\tfunction redrawASld () {\r\n\t\t\tvar y = Math.round((1 - THIS.channels.a) * (THIS.height - 1));\r\n\t\t\tjsc.picker.asldPtrOB.style.top = (y - (2 * THIS.pointerBorderWidth + THIS.pointerThickness) - Math.floor(jsc.pub.sliderInnerSpace / 2)) + 'px';\r\n\t\t}\r\n\r\n\r\n\t\tfunction isPickerOwner () {\r\n\t\t\treturn jsc.picker && jsc.picker.owner === THIS;\r\n\t\t}\r\n\r\n\r\n\t\tfunction onValueKeyDown (ev) {\r\n\t\t\tif (jsc.eventKey(ev) === 'Enter') {\r\n\t\t\t\tif (THIS.valueElement) {\r\n\t\t\t\t\tTHIS.processValueInput(THIS.valueElement.value);\r\n\t\t\t\t}\r\n\t\t\t\tTHIS.tryHide();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t\tfunction onAlphaKeyDown (ev) {\r\n\t\t\tif (jsc.eventKey(ev) === 'Enter') {\r\n\t\t\t\tif (THIS.alphaElement) {\r\n\t\t\t\t\tTHIS.processAlphaInput(THIS.alphaElement.value);\r\n\t\t\t\t}\r\n\t\t\t\tTHIS.tryHide();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t\tfunction onValueChange (ev) {\r\n\t\t\tif (jsc.getData(ev, 'internal')) {\r\n\t\t\t\treturn; // skip if the event was internally triggered by jscolor\r\n\t\t\t}\r\n\r\n\t\t\tvar oldVal = THIS.valueElement.value;\r\n\r\n\t\t\tTHIS.processValueInput(THIS.valueElement.value); // this might change the value\r\n\r\n\t\t\tjsc.triggerCallback(THIS, 'onChange');\r\n\r\n\t\t\tif (THIS.valueElement.value !== oldVal) {\r\n\t\t\t\t// value was additionally changed -> let's trigger the change event again, even though it was natively dispatched\r\n\t\t\t\tjsc.triggerInputEvent(THIS.valueElement, 'change', true, true);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t\tfunction onAlphaChange (ev) {\r\n\t\t\tif (jsc.getData(ev, 'internal')) {\r\n\t\t\t\treturn; // skip if the event was internally triggered by jscolor\r\n\t\t\t}\r\n\r\n\t\t\tvar oldVal = THIS.alphaElement.value;\r\n\r\n\t\t\tTHIS.processAlphaInput(THIS.alphaElement.value); // this might change the value\r\n\r\n\t\t\tjsc.triggerCallback(THIS, 'onChange');\r\n\r\n\t\t\t// triggering valueElement's onChange (because changing alpha changes the entire color, e.g. with rgba format)\r\n\t\t\tjsc.triggerInputEvent(THIS.valueElement, 'change', true, true);\r\n\r\n\t\t\tif (THIS.alphaElement.value !== oldVal) {\r\n\t\t\t\t// value was additionally changed -> let's trigger the change event again, even though it was natively dispatched\r\n\t\t\t\tjsc.triggerInputEvent(THIS.alphaElement, 'change', true, true);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t\tfunction onValueInput (ev) {\r\n\t\t\tif (jsc.getData(ev, 'internal')) {\r\n\t\t\t\treturn; // skip if the event was internally triggered by jscolor\r\n\t\t\t}\r\n\r\n\t\t\tif (THIS.valueElement) {\r\n\t\t\t\tTHIS.fromString(THIS.valueElement.value, jsc.flags.leaveValue);\r\n\t\t\t}\r\n\r\n\t\t\tjsc.triggerCallback(THIS, 'onInput');\r\n\r\n\t\t\t// triggering valueElement's onInput\r\n\t\t\t// (not needed, it was dispatched normally by the browser)\r\n\t\t}\r\n\r\n\r\n\t\tfunction onAlphaInput (ev) {\r\n\t\t\tif (jsc.getData(ev, 'internal')) {\r\n\t\t\t\treturn; // skip if the event was internally triggered by jscolor\r\n\t\t\t}\r\n\r\n\t\t\tif (THIS.alphaElement) {\r\n\t\t\t\tTHIS.fromHSVA(null, null, null, parseFloat(THIS.alphaElement.value), jsc.flags.leaveAlpha);\r\n\t\t\t}\r\n\r\n\t\t\tjsc.triggerCallback(THIS, 'onInput');\r\n\r\n\t\t\t// triggering valueElement's onInput (because changing alpha changes the entire color, e.g. with rgba format)\r\n\t\t\tjsc.triggerInputEvent(THIS.valueElement, 'input', true, true);\r\n\t\t}\r\n\r\n\r\n\t\t// let's process the DEPRECATED 'options' property (this will be later removed)\r\n\t\tif (jsc.pub.options) {\r\n\t\t\t// let's set custom default options, if specified\r\n\t\t\tfor (var opt in jsc.pub.options) {\r\n\t\t\t\tif (jsc.pub.options.hasOwnProperty(opt)) {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tsetOption(opt, jsc.pub.options[opt]);\r\n\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\tconsole.warn(e);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t\t// let's apply configuration presets\r\n\t\t//\r\n\t\tvar presetsArr = [];\r\n\r\n\t\tif (opts.preset) {\r\n\t\t\tif (typeof opts.preset === 'string') {\r\n\t\t\t\tpresetsArr = opts.preset.split(/\\s+/);\r\n\t\t\t} else if (Array.isArray(opts.preset)) {\r\n\t\t\t\tpresetsArr = opts.preset.slice(); // slice() to clone\r\n\t\t\t} else {\r\n\t\t\t\tconsole.warn('Unrecognized preset value');\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// always use the 'default' preset. If it's not listed, append it to the end.\r\n\t\tif (presetsArr.indexOf('default') === -1) {\r\n\t\t\tpresetsArr.push('default');\r\n\t\t}\r\n\r\n\t\t// let's apply the presets in reverse order, so that should there be any overlapping options,\r\n\t\t// the formerly listed preset will override the latter\r\n\t\tfor (var i = presetsArr.length - 1; i >= 0; i -= 1) {\r\n\t\t\tvar pres = presetsArr[i];\r\n\t\t\tif (!pres) {\r\n\t\t\t\tcontinue; // preset is empty string\r\n\t\t\t}\r\n\t\t\tif (!jsc.pub.presets.hasOwnProperty(pres)) {\r\n\t\t\t\tconsole.warn('Unknown preset: %s', pres);\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tfor (var opt in jsc.pub.presets[pres]) {\r\n\t\t\t\tif (jsc.pub.presets[pres].hasOwnProperty(opt)) {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tsetOption(opt, jsc.pub.presets[pres][opt]);\r\n\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\tconsole.warn(e);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t\t// let's set specific options for this color picker\r\n\t\tvar nonProperties = [\r\n\t\t\t// these options won't be set as instance properties\r\n\t\t\t'preset',\r\n\t\t];\r\n\t\tfor (var opt in opts) {\r\n\t\t\tif (opts.hasOwnProperty(opt)) {\r\n\t\t\t\tif (nonProperties.indexOf(opt) === -1) {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tsetOption(opt, opts[opt]);\r\n\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\tconsole.warn(e);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t\t//\r\n\t\t// Install the color picker on chosen element(s)\r\n\t\t//\r\n\r\n\r\n\t\t// Determine picker's container element\r\n\t\tif (this.container === undefined) {\r\n\t\t\tthis.container = window.document.body; // default container is BODY element\r\n\r\n\t\t} else { // explicitly set to custom element\r\n\t\t\tthis.container = jsc.node(this.container);\r\n\t\t}\r\n\r\n\t\tif (!this.container) {\r\n\t\t\tthrow new Error('Cannot instantiate color picker without a container element');\r\n\t\t}\r\n\r\n\r\n\t\t// Fetch the target element\r\n\t\tthis.targetElement = jsc.node(targetElement);\r\n\r\n\t\tif (!this.targetElement) {\r\n\t\t\t// temporarily customized error message to help with migrating from versions prior to 2.2\r\n\t\t\tif (typeof targetElement === 'string' && /^[a-zA-Z][\\w:.-]*$/.test(targetElement)) {\r\n\t\t\t\t// targetElement looks like valid ID\r\n\t\t\t\tvar possiblyId = targetElement;\r\n\t\t\t\tthrow new Error('If \\'' + possiblyId + '\\' is supposed to be an ID, please use \\'#' + possiblyId + '\\' or any valid CSS selector.');\r\n\t\t\t}\r\n\r\n\t\t\tthrow new Error('Cannot instantiate color picker without a target element');\r\n\t\t}\r\n\r\n\t\tif (this.targetElement.jscolor && this.targetElement.jscolor instanceof jsc.pub) {\r\n\t\t\tthrow new Error('Color picker already installed on this element');\r\n\t\t}\r\n\r\n\r\n\t\t// link this instance with the target element\r\n\t\tthis.targetElement.jscolor = this;\r\n\t\tjsc.addClass(this.targetElement, jsc.pub.className);\r\n\r\n\t\t// register this instance\r\n\t\tjsc.instances.push(this);\r\n\r\n\r\n\t\t// if target is BUTTON\r\n\t\tif (jsc.isButton(this.targetElement)) {\r\n\r\n\t\t\tif (this.targetElement.type.toLowerCase() !== 'button') {\r\n\t\t\t\t// on buttons, always force type to be 'button', e.g. in situations the target <button> has no type\r\n\t\t\t\t// and thus defaults to 'submit' and would submit the form when clicked\r\n\t\t\t\tthis.targetElement.type = 'button';\r\n\t\t\t}\r\n\r\n\t\t\tif (jsc.isButtonEmpty(this.targetElement)) { // empty button\r\n\t\t\t\t// it is important to clear element's contents first.\r\n\t\t\t\t// if we're re-instantiating color pickers on DOM that has been modified by changing page's innerHTML,\r\n\t\t\t\t// we would keep adding more non-breaking spaces to element's content (because element's contents survive\r\n\t\t\t\t// innerHTML changes, but picker instances don't)\r\n\t\t\t\tjsc.removeChildren(this.targetElement);\r\n\r\n\t\t\t\t// let's insert a non-breaking space\r\n\t\t\t\tthis.targetElement.appendChild(window.document.createTextNode('\\xa0'));\r\n\r\n\t\t\t\t// set min-width = previewSize, if not already greater\r\n\t\t\t\tvar compStyle = jsc.getCompStyle(this.targetElement);\r\n\t\t\t\tvar currMinWidth = parseFloat(compStyle['min-width']) || 0;\r\n\t\t\t\tif (currMinWidth < this.previewSize) {\r\n\t\t\t\t\tjsc.setStyle(this.targetElement, {\r\n\t\t\t\t\t\t'min-width': this.previewSize + 'px',\r\n\t\t\t\t\t}, this.forceStyle);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Determine the value element\r\n\t\tif (this.valueElement === undefined) {\r\n\t\t\tif (jsc.isTextInput(this.targetElement)) {\r\n\t\t\t\t// for text inputs, default valueElement is targetElement\r\n\t\t\t\tthis.valueElement = this.targetElement;\r\n\t\t\t} else {\r\n\t\t\t\t// leave it undefined\r\n\t\t\t}\r\n\r\n\t\t} else if (this.valueElement === null) { // explicitly set to null\r\n\t\t\t// leave it null\r\n\r\n\t\t} else { // explicitly set to custom element\r\n\t\t\tthis.valueElement = jsc.node(this.valueElement);\r\n\t\t}\r\n\r\n\t\t// Determine the alpha element\r\n\t\tif (this.alphaElement) {\r\n\t\t\tthis.alphaElement = jsc.node(this.alphaElement);\r\n\t\t}\r\n\r\n\t\t// Determine the preview element\r\n\t\tif (this.previewElement === undefined) {\r\n\t\t\tthis.previewElement = this.targetElement; // default previewElement is targetElement\r\n\r\n\t\t} else if (this.previewElement === null) { // explicitly set to null\r\n\t\t\t// leave it null\r\n\r\n\t\t} else { // explicitly set to custom element\r\n\t\t\tthis.previewElement = jsc.node(this.previewElement);\r\n\t\t}\r\n\r\n\t\t// valueElement\r\n\t\tif (this.valueElement && jsc.isTextInput(this.valueElement)) {\r\n\r\n\t\t\t// If the value element has onInput event already set, we need to detach it and attach AFTER our listener.\r\n\t\t\t// otherwise the picker instance would still contain the old color when accessed from the onInput handler.\r\n\t\t\tvar valueElementOrigEvents = {\r\n\t\t\t\tonInput: this.valueElement.oninput\r\n\t\t\t};\r\n\t\t\tthis.valueElement.oninput = null;\r\n\r\n\t\t\tthis.valueElement.addEventListener('keydown', onValueKeyDown, false);\r\n\t\t\tthis.valueElement.addEventListener('change', onValueChange, false);\r\n\t\t\tthis.valueElement.addEventListener('input', onValueInput, false);\r\n\t\t\t// the original event listener must be attached AFTER our handler (to let it first set picker's color)\r\n\t\t\tif (valueElementOrigEvents.onInput) {\r\n\t\t\t\tthis.valueElement.addEventListener('input', valueElementOrigEvents.onInput, false);\r\n\t\t\t}\r\n\r\n\t\t\tthis.valueElement.setAttribute('autocomplete', 'off');\r\n\t\t\tthis.valueElement.setAttribute('autocorrect', 'off');\r\n\t\t\tthis.valueElement.setAttribute('autocapitalize', 'off');\r\n\t\t\tthis.valueElement.setAttribute('spellcheck', false);\r\n\t\t}\r\n\r\n\t\t// alphaElement\r\n\t\tif (this.alphaElement && jsc.isTextInput(this.alphaElement)) {\r\n\t\t\tthis.alphaElement.addEventListener('keydown', onAlphaKeyDown, false);\r\n\t\t\tthis.alphaElement.addEventListener('change', onAlphaChange, false);\r\n\t\t\tthis.alphaElement.addEventListener('input', onAlphaInput, false);\r\n\r\n\t\t\tthis.alphaElement.setAttribute('autocomplete', 'off');\r\n\t\t\tthis.alphaElement.setAttribute('autocorrect', 'off');\r\n\t\t\tthis.alphaElement.setAttribute('autocapitalize', 'off');\r\n\t\t\tthis.alphaElement.setAttribute('spellcheck', false);\r\n\t\t}\r\n\r\n\t\t// determine initial color value\r\n\t\t//\r\n\t\tvar initValue = 'FFFFFF';\r\n\r\n\t\tif (this.value !== undefined) {\r\n\t\t\tinitValue = this.value; // get initial color from the 'value' property\r\n\t\t} else if (this.valueElement && this.valueElement.value !== undefined) {\r\n\t\t\tinitValue = this.valueElement.value; // get initial color from valueElement's value\r\n\t\t}\r\n\r\n\t\t// determine initial alpha value\r\n\t\t//\r\n\t\tvar initAlpha = undefined;\r\n\r\n\t\tif (this.alpha !== undefined) {\r\n\t\t\tinitAlpha = (''+this.alpha); // get initial alpha value from the 'alpha' property\r\n\t\t} else if (this.alphaElement && this.alphaElement.value !== undefined) {\r\n\t\t\tinitAlpha = this.alphaElement.value; // get initial color from alphaElement's value\r\n\t\t}\r\n\r\n\t\t// determine current format based on the initial color value\r\n\t\t//\r\n\t\tthis._currentFormat = null;\r\n\r\n\t\tif (['auto', 'any'].indexOf(this.format.toLowerCase()) > -1) {\r\n\t\t\t// format is 'auto' or 'any' -> let's auto-detect current format\r\n\t\t\tvar color = jsc.parseColorString(initValue);\r\n\t\t\tthis._currentFormat = color ? color.format : 'hex';\r\n\t\t} else {\r\n\t\t\t// format is specified\r\n\t\t\tthis._currentFormat = this.format.toLowerCase();\r\n\t\t}\r\n\r\n\r\n\t\t// let's parse the initial color value and expose color's preview\r\n\t\tthis.processValueInput(initValue);\r\n\r\n\t\t// let's also parse and expose the initial alpha value, if any\r\n\t\t//\r\n\t\t// Note: If the initial color value contains alpha value in it (e.g. in rgba format),\r\n\t\t// this will overwrite it. So we should only process alpha input if there was initial\r\n\t\t// alpha explicitly set, otherwise we could needlessly lose initial value's alpha\r\n\t\tif (initAlpha !== undefined) {\r\n\t\t\tthis.processAlphaInput(initAlpha);\r\n\t\t}\r\n\r\n\t\tif (this.random) {\r\n\t\t\t// randomize the initial color value\r\n\t\t\tthis.randomize.apply(this, Array.isArray(this.random) ? this.random : []);\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\n\r\n//================================\r\n// Public properties and methods\r\n//================================\r\n\r\n//\r\n// These will be publicly available via jscolor.<name> and JSColor.<name>\r\n//\r\n\r\n\r\n// class that will be set to elements having jscolor installed on them\r\njsc.pub.className = 'jscolor';\r\n\r\n\r\n// class that will be set to elements having jscolor active on them\r\njsc.pub.activeClassName = 'jscolor-active';\r\n\r\n\r\n// whether to try to parse the options string by evaluating it using 'new Function()'\r\n// in case it could not be parsed with JSON.parse()\r\njsc.pub.looseJSON = true;\r\n\r\n\r\n// presets\r\njsc.pub.presets = {};\r\n\r\n// built-in presets\r\njsc.pub.presets['default'] = {}; // baseline for customization\r\n\r\njsc.pub.presets['light'] = { // default color scheme\r\n\tbackgroundColor: 'rgba(255,255,255,1)',\r\n\tcontrolBorderColor: 'rgba(187,187,187,1)',\r\n\tbuttonColor: 'rgba(0,0,0,1)',\r\n};\r\njsc.pub.presets['dark'] = {\r\n\tbackgroundColor: 'rgba(51,51,51,1)',\r\n\tcontrolBorderColor: 'rgba(153,153,153,1)',\r\n\tbuttonColor: 'rgba(240,240,240,1)',\r\n};\r\n\r\njsc.pub.presets['small'] = { width:101, height:101, padding:10, sliderSize:14, paletteCols:8 };\r\njsc.pub.presets['medium'] = { width:181, height:101, padding:12, sliderSize:16, paletteCols:10 }; // default size\r\njsc.pub.presets['large'] = { width:271, height:151, padding:12, sliderSize:24, paletteCols:15 };\r\n\r\njsc.pub.presets['thin'] = { borderWidth:1, controlBorderWidth:1, pointerBorderWidth:1 }; // default thickness\r\njsc.pub.presets['thick'] = { borderWidth:2, controlBorderWidth:2, pointerBorderWidth:2 };\r\n\r\n\r\n// size of space in the sliders\r\njsc.pub.sliderInnerSpace = 3; // px\r\n\r\n// transparency chessboard\r\njsc.pub.chessboardSize = 8; // px\r\njsc.pub.chessboardColor1 = '#666666';\r\njsc.pub.chessboardColor2 = '#999999';\r\n\r\n// preview separator\r\njsc.pub.previewSeparator = ['rgba(255,255,255,.65)', 'rgba(128,128,128,.65)'];\r\n\r\n\r\n// Initializes jscolor\r\njsc.pub.init = function () {\r\n\tif (jsc.initialized) {\r\n\t\treturn;\r\n\t}\r\n\r\n\t// attach some necessary handlers\r\n\twindow.document.addEventListener('mousedown', jsc.onDocumentMouseDown, false);\r\n\twindow.document.addEventListener('keyup', jsc.onDocumentKeyUp, false);\r\n\twindow.addEventListener('resize', jsc.onWindowResize, false);\r\n\twindow.addEventListener('scroll', jsc.onWindowScroll, false);\r\n\r\n\t// append default CSS to HEAD\r\n\tjsc.appendDefaultCss();\r\n\r\n\t// install jscolor on current DOM\r\n\tjsc.pub.install();\r\n\r\n\tjsc.initialized = true;\r\n\r\n\t// call functions waiting in the queue\r\n\twhile (jsc.readyQueue.length) {\r\n\t\tvar func = jsc.readyQueue.shift();\r\n\t\tfunc();\r\n\t}\r\n};\r\n\r\n\r\n// Installs jscolor on current DOM tree\r\njsc.pub.install = function (rootNode) {\r\n\tvar success = true;\r\n\r\n\ttry {\r\n\t\tjsc.installBySelector('[data-jscolor]', rootNode);\r\n\t} catch (e) {\r\n\t\tsuccess = false;\r\n\t\tconsole.warn(e);\r\n\t}\r\n\r\n\t// for backward compatibility with DEPRECATED installation using class name\r\n\tif (jsc.pub.lookupClass) {\r\n\t\ttry {\r\n\t\t\tjsc.installBySelector(\r\n\t\t\t\t(\r\n\t\t\t\t\t'input.' + jsc.pub.lookupClass + ', ' +\r\n\t\t\t\t\t'button.' + jsc.pub.lookupClass\r\n\t\t\t\t),\r\n\t\t\t\trootNode\r\n\t\t\t);\r\n\t\t} catch (e) {}\r\n\t}\r\n\r\n\treturn success;\r\n};\r\n\r\n\r\n// Registers function to be called as soon as jscolor is initialized (or immediately, if it already is).\r\n//\r\njsc.pub.ready = function (func) {\r\n\tif (typeof func !== 'function') {\r\n\t\tconsole.warn('Passed value is not a function');\r\n\t\treturn false;\r\n\t}\r\n\r\n\tif (jsc.initialized) {\r\n\t\tfunc();\r\n\t} else {\r\n\t\tjsc.readyQueue.push(func);\r\n\t}\r\n\treturn true;\r\n};\r\n\r\n\r\n// Triggers given input event(s) (e.g. 'input' or 'change') on all color pickers.\r\n//\r\n// It is possible to specify multiple events separated with a space.\r\n// If called before jscolor is initialized, then the events will be triggered after initialization.\r\n//\r\njsc.pub.trigger = function (eventNames) {\r\n\tvar triggerNow = function () {\r\n\t\tjsc.triggerGlobal(eventNames);\r\n\t};\r\n\r\n\tif (jsc.initialized) {\r\n\t\ttriggerNow();\r\n\t} else {\r\n\t\tjsc.pub.ready(triggerNow);\r\n\t}\r\n};\r\n\r\n\r\n// Hides current color picker box\r\njsc.pub.hide = function () {\r\n\tif (jsc.picker && jsc.picker.owner) {\r\n\t\tjsc.picker.owner.hide();\r\n\t}\r\n};\r\n\r\n\r\n// Returns a data URL of a gray chessboard image that indicates transparency\r\njsc.pub.chessboard = function (color) {\r\n\tif (!color) {\r\n\t\tcolor = 'rgba(0,0,0,0)';\r\n\t}\r\n\tvar preview = jsc.genColorPreviewCanvas(color);\r\n\treturn preview.canvas.toDataURL();\r\n};\r\n\r\n\r\n// Returns a data URL of a gray chessboard image that indicates transparency\r\njsc.pub.background = function (color) {\r\n\tvar backgrounds = [];\r\n\r\n\t// CSS gradient for background color preview\r\n\tbackgrounds.push(jsc.genColorPreviewGradient(color));\r\n\r\n\t// data URL of generated PNG image with a gray transparency chessboard\r\n\tvar preview = jsc.genColorPreviewCanvas();\r\n\tbackgrounds.push([\r\n\t\t'url(\\'' + preview.canvas.toDataURL() + '\\')',\r\n\t\t'left top',\r\n\t\t'repeat',\r\n\t].join(' '));\r\n\r\n\treturn backgrounds.join(', ');\r\n};\r\n\r\n\r\n//\r\n// DEPRECATED properties and methods\r\n//\r\n\r\n\r\n// DEPRECATED. Use jscolor.presets.default instead.\r\n//\r\n// Custom default options for all color pickers, e.g. { hash: true, width: 300 }\r\njsc.pub.options = {};\r\n\r\n\r\n// DEPRECATED. Use data-jscolor attribute instead, which installs jscolor on given element.\r\n//\r\n// By default, we'll search for all elements with class=\"jscolor\" and install a color picker on them.\r\n//\r\n// You can change what class name will be looked for by setting the property jscolor.lookupClass\r\n// anywhere in your HTML document. To completely disable the automatic lookup, set it to null.\r\n//\r\njsc.pub.lookupClass = 'jscolor';\r\n\r\n\r\n// DEPRECATED. Use data-jscolor attribute instead, which installs jscolor on given element.\r\n//\r\n// Install jscolor on all elements that have the specified class name\r\njsc.pub.installByClassName = function () {\r\n\tconsole.error('jscolor.installByClassName() is DEPRECATED. Use data-jscolor=\"\" attribute instead of a class name.' + jsc.docsRef);\r\n\treturn false;\r\n};\r\n\r\n\r\njsc.register();\r\n\r\n\r\nreturn jsc.pub;\r\n\r\n\r\n})(); // END jscolor\r\n\r\n\r\nif (typeof window.jscolor === 'undefined') {\r\n\twindow.jscolor = window.JSColor = jscolor;\r\n}\r\n\r\n\r\n// END jscolor code\r\n\r\nreturn jscolor;\r\n\r\n}); // END factory\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWCxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMsSUFBSTtBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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QTtBQUNBO0FBQ0EsSUFBSSx1Q0FBdUM7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQztBQUNyQztBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNEQUFzRDtBQUN0RCxzREFBc0Q7QUFDdEQ7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNEQUFzRDtBQUN0RCxzREFBc0Q7QUFDdEQ7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckIsb0JBQW9CLG1CQUFtQjtBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0EsbUNBQW1DO0FBQ25DO0FBQ0EsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0IsNkJBQTZCO0FBQzdCLDZCQUE2QjtBQUM3Qiw2QkFBNkI7QUFDN0IsNkJBQTZCO0FBQzdCLDZCQUE2QjtBQUM3Qiw2QkFBNkI7QUFDN0IsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQjtBQUMvQjtBQUNBO0FBQ0EsMkNBQTJDO0FBQzNDLDZDQUE2QztBQUM3QywyQ0FBMkM7QUFDM0MsNkNBQTZDO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QjtBQUM1Qix1QkFBdUI7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkI7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsK0JBQStCO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsd0JBQXdCO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdDQUF3QztBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUM7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkNBQTZDO0FBQzdDO0FBQ0E7QUFDQTtBQUNBLEtBQUssMkJBQTJCO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZDQUE2QztBQUM3QztBQUNBO0FBQ0EsS0FBSywyQkFBMkI7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DLGdCQUFnQjtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXlDO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZixtQkFBbUIsNkJBQTZCO0FBQ2hELG9CQUFvQiwwREFBMEQ7QUFDOUU7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNFQUFzRTtBQUN0RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0RBQW9EO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9EQUFvRDtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxzQ0FBc0M7QUFDdEMsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQ0FBc0MsUUFBUTtBQUM5QztBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEM7QUFDMUM7QUFDQSxJQUFJLE9BQU87QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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QTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0RBQXdEO0FBQ3hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxLQUFLO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsR0FBRyIsInNvdXJjZXMiOlsid2VicGFjazovLyAvLi9qcy9qc2NvbG9yL2pzY29sb3IuanM/YWM0ZSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICoganNjb2xvciAtIEphdmFTY3JpcHQgQ29sb3IgUGlja2VyXHJcbiAqXHJcbiAqIEBsaW5rICAgIGh0dHA6Ly9qc2NvbG9yLmNvbVxyXG4gKiBAbGljZW5zZSBGb3Igb3BlbiBzb3VyY2UgdXNlOiBHUEx2M1xyXG4gKiAgICAgICAgICBGb3IgY29tbWVyY2lhbCB1c2U6IEpTQ29sb3IgQ29tbWVyY2lhbCBMaWNlbnNlXHJcbiAqIEBhdXRob3IgIEphbiBPZHZhcmtvIC0gRWFzdCBEZXNpcmVcclxuICogQHZlcnNpb24gMi41LjJcclxuICpcclxuICogU2VlIHVzYWdlIGV4YW1wbGVzIGF0IGh0dHA6Ly9qc2NvbG9yLmNvbS9leGFtcGxlcy9cclxuICovXHJcblxyXG5cclxuKGZ1bmN0aW9uIChnbG9iYWwsIGZhY3RvcnkpIHtcclxuXHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cclxuXHRpZiAodHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZS5leHBvcnRzID09PSAnb2JqZWN0Jykge1xyXG5cdFx0Ly8gRXhwb3J0IGpzY29sb3IgYXMgYSBtb2R1bGVcclxuXHRcdG1vZHVsZS5leHBvcnRzID0gZ2xvYmFsLmRvY3VtZW50ID9cclxuXHRcdFx0ZmFjdG9yeSAoZ2xvYmFsKSA6XHJcblx0XHRcdGZ1bmN0aW9uICh3aW4pIHtcclxuXHRcdFx0XHRpZiAoIXdpbi5kb2N1bWVudCkge1xyXG5cdFx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKCdqc2NvbG9yIG5lZWRzIGEgd2luZG93IHdpdGggZG9jdW1lbnQnKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0cmV0dXJuIGZhY3Rvcnkod2luKTtcclxuXHRcdFx0fVxyXG5cdFx0cmV0dXJuO1xyXG5cdH1cclxuXHJcblx0Ly8gRGVmYXVsdCB1c2UgKG5vIG1vZHVsZSBleHBvcnQpXHJcblx0ZmFjdG9yeShnbG9iYWwpO1xyXG5cclxufSkodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgPyB3aW5kb3cgOiB0aGlzLCBmdW5jdGlvbiAod2luZG93KSB7IC8vIEJFR0lOIGZhY3RvcnlcclxuXHJcbi8vIEJFR0lOIGpzY29sb3IgY29kZVxyXG5cclxuXHJcbid1c2Ugc3RyaWN0JztcclxuXHJcblxyXG52YXIganNjb2xvciA9IChmdW5jdGlvbiAoKSB7IC8vIEJFR0lOIGpzY29sb3JcclxuXHJcbnZhciBqc2MgPSB7XHJcblxyXG5cclxuXHRpbml0aWFsaXplZCA6IGZhbHNlLFxyXG5cclxuXHRpbnN0YW5jZXMgOiBbXSwgLy8gY3JlYXRlZCBpbnN0YW5jZXMgb2YganNjb2xvclxyXG5cclxuXHRyZWFkeVF1ZXVlIDogW10sIC8vIGZ1bmN0aW9ucyB3YWl0aW5nIHRvIGJlIGNhbGxlZCBhZnRlciBpbml0XHJcblxyXG5cclxuXHRyZWdpc3RlciA6IGZ1bmN0aW9uICgpIHtcclxuXHRcdGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB3aW5kb3cuZG9jdW1lbnQpIHtcclxuXHRcdFx0aWYgKHdpbmRvdy5kb2N1bWVudC5yZWFkeVN0YXRlICE9PSAnbG9hZGluZycpIHtcclxuXHRcdFx0XHRqc2MucHViLmluaXQoKTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHR3aW5kb3cuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGpzYy5wdWIuaW5pdCwgZmFsc2UpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fSxcclxuXHJcblxyXG5cdGluc3RhbGxCeVNlbGVjdG9yIDogZnVuY3Rpb24gKHNlbGVjdG9yLCByb290Tm9kZSkge1xyXG5cdFx0cm9vdE5vZGUgPSByb290Tm9kZSA/IGpzYy5ub2RlKHJvb3ROb2RlKSA6IHdpbmRvdy5kb2N1bWVudDtcclxuXHRcdGlmICghcm9vdE5vZGUpIHtcclxuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHJvb3Qgbm9kZScpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHZhciBlbG1zID0gcm9vdE5vZGUucXVlcnlTZWxlY3RvckFsbChzZWxlY3Rvcik7XHJcblxyXG5cdFx0Ly8gZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkgd2l0aCBERVBSRUNBVEVEIGluc3RhbGxhdGlvbi9jb25maWd1cmF0aW9uIHVzaW5nIGNsYXNzTmFtZVxyXG5cdFx0dmFyIG1hdGNoQ2xhc3MgPSBuZXcgUmVnRXhwKCcoXnxcXFxccykoJyArIGpzYy5wdWIubG9va3VwQ2xhc3MgKyAnKShcXFxccyooXFxcXHtbXn1dKlxcXFx9KXxcXFxcc3wkKScsICdpJyk7XHJcblxyXG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBlbG1zLmxlbmd0aDsgaSArPSAxKSB7XHJcblxyXG5cdFx0XHRpZiAoZWxtc1tpXS5qc2NvbG9yICYmIGVsbXNbaV0uanNjb2xvciBpbnN0YW5jZW9mIGpzYy5wdWIpIHtcclxuXHRcdFx0XHRjb250aW51ZTsgLy8ganNjb2xvciBhbHJlYWR5IGluc3RhbGxlZCBvbiB0aGlzIGVsZW1lbnRcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0aWYgKGVsbXNbaV0udHlwZSAhPT0gdW5kZWZpbmVkICYmIGVsbXNbaV0udHlwZS50b0xvd2VyQ2FzZSgpID09ICdjb2xvcicgJiYganNjLmlzQ29sb3JBdHRyU3VwcG9ydGVkKSB7XHJcblx0XHRcdFx0Y29udGludWU7IC8vIHNraXBzIGlucHV0cyBvZiB0eXBlICdjb2xvcicgaWYgc3VwcG9ydGVkIGJ5IHRoZSBicm93c2VyXHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHZhciBkYXRhT3B0cywgbTtcclxuXHJcblx0XHRcdGlmIChcclxuXHRcdFx0XHQoZGF0YU9wdHMgPSBqc2MuZ2V0RGF0YUF0dHIoZWxtc1tpXSwgJ2pzY29sb3InKSkgIT09IG51bGwgfHxcclxuXHRcdFx0XHQoZWxtc1tpXS5jbGFzc05hbWUgJiYgKG0gPSBlbG1zW2ldLmNsYXNzTmFtZS5tYXRjaChtYXRjaENsYXNzKSkpIC8vIGluc3RhbGxhdGlvbiB1c2luZyBjbGFzc05hbWUgKERFUFJFQ0FURUQpXHJcblx0XHRcdCkge1xyXG5cdFx0XHRcdHZhciB0YXJnZXRFbG0gPSBlbG1zW2ldO1xyXG5cclxuXHRcdFx0XHR2YXIgb3B0c1N0ciA9ICcnO1xyXG5cdFx0XHRcdGlmIChkYXRhT3B0cyAhPT0gbnVsbCkge1xyXG5cdFx0XHRcdFx0b3B0c1N0ciA9IGRhdGFPcHRzO1xyXG5cclxuXHRcdFx0XHR9IGVsc2UgaWYgKG0pIHsgLy8gaW5zdGFsbGF0aW9uIHVzaW5nIGNsYXNzTmFtZSAoREVQUkVDQVRFRClcclxuXHRcdFx0XHRcdGNvbnNvbGUud2FybignSW5zdGFsbGF0aW9uIHVzaW5nIGNsYXNzIG5hbWUgaXMgREVQUkVDQVRFRC4gVXNlIGRhdGEtanNjb2xvcj1cIlwiIGF0dHJpYnV0ZSBpbnN0ZWFkLicgKyBqc2MuZG9jc1JlZik7XHJcblx0XHRcdFx0XHRpZiAobVs0XSkge1xyXG5cdFx0XHRcdFx0XHRvcHRzU3RyID0gbVs0XTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdHZhciBvcHRzID0gbnVsbDtcclxuXHRcdFx0XHRpZiAob3B0c1N0ci50cmltKCkpIHtcclxuXHRcdFx0XHRcdHRyeSB7XHJcblx0XHRcdFx0XHRcdG9wdHMgPSBqc2MucGFyc2VPcHRpb25zU3RyKG9wdHNTdHIpO1xyXG5cdFx0XHRcdFx0fSBjYXRjaCAoZSkge1xyXG5cdFx0XHRcdFx0XHRjb25zb2xlLndhcm4oZSArICdcXG4nICsgb3B0c1N0cik7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHR0cnkge1xyXG5cdFx0XHRcdFx0bmV3IGpzYy5wdWIodGFyZ2V0RWxtLCBvcHRzKTtcclxuXHRcdFx0XHR9IGNhdGNoIChlKSB7XHJcblx0XHRcdFx0XHRjb25zb2xlLndhcm4oZSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fSxcclxuXHJcblxyXG5cdHBhcnNlT3B0aW9uc1N0ciA6IGZ1bmN0aW9uIChzdHIpIHtcclxuXHRcdHZhciBvcHRzID0gbnVsbDtcclxuXHJcblx0XHR0cnkge1xyXG5cdFx0XHRvcHRzID0gSlNPTi5wYXJzZShzdHIpO1xyXG5cclxuXHRcdH0gY2F0Y2ggKGVQYXJzZSkge1xyXG5cdFx0XHRpZiAoIWpzYy5wdWIubG9vc2VKU09OKSB7XHJcblx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKCdDb3VsZCBub3QgcGFyc2UganNjb2xvciBvcHRpb25zIGFzIEpTT046ICcgKyBlUGFyc2UpO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdC8vIGxvb3NlIEpTT04gc3ludGF4IGlzIGVuYWJsZWQgLT4gdHJ5IHRvIGV2YWx1YXRlIHRoZSBvcHRpb25zIHN0cmluZyBhcyBKYXZhU2NyaXB0IG9iamVjdFxyXG5cdFx0XHRcdHRyeSB7XHJcblx0XHRcdFx0XHRvcHRzID0gKG5ldyBGdW5jdGlvbiAoJ3ZhciBvcHRzID0gKCcgKyBzdHIgKyAnKTsgcmV0dXJuIHR5cGVvZiBvcHRzID09PSBcIm9iamVjdFwiID8gb3B0cyA6IHt9OycpKSgpO1xyXG5cdFx0XHRcdH0gY2F0Y2ggKGVFdmFsKSB7XHJcblx0XHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0NvdWxkIG5vdCBldmFsdWF0ZSBqc2NvbG9yIG9wdGlvbnM6ICcgKyBlRXZhbCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gb3B0cztcclxuXHR9LFxyXG5cclxuXHJcblx0Z2V0SW5zdGFuY2VzIDogZnVuY3Rpb24gKCkge1xyXG5cdFx0dmFyIGluc3QgPSBbXTtcclxuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwganNjLmluc3RhbmNlcy5sZW5ndGg7IGkgKz0gMSkge1xyXG5cdFx0XHQvLyBpZiB0aGUgdGFyZ2V0RWxlbWVudCBzdGlsbCBleGlzdHMsIHRoZSBpbnN0YW5jZSBpcyBjb25zaWRlcmVkIFwiYWxpdmVcIlxyXG5cdFx0XHRpZiAoanNjLmluc3RhbmNlc1tpXSAmJiBqc2MuaW5zdGFuY2VzW2ldLnRhcmdldEVsZW1lbnQpIHtcclxuXHRcdFx0XHRpbnN0LnB1c2goanNjLmluc3RhbmNlc1tpXSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdHJldHVybiBpbnN0O1xyXG5cdH0sXHJcblxyXG5cclxuXHRjcmVhdGVFbCA6IGZ1bmN0aW9uICh0YWdOYW1lKSB7XHJcblx0XHR2YXIgZWwgPSB3aW5kb3cuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0YWdOYW1lKTtcclxuXHRcdGpzYy5zZXREYXRhKGVsLCAnZ3VpJywgdHJ1ZSk7XHJcblx0XHRyZXR1cm4gZWw7XHJcblx0fSxcclxuXHJcblxyXG5cdG5vZGUgOiBmdW5jdGlvbiAobm9kZU9yU2VsZWN0b3IpIHtcclxuXHRcdGlmICghbm9kZU9yU2VsZWN0b3IpIHtcclxuXHRcdFx0cmV0dXJuIG51bGw7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKHR5cGVvZiBub2RlT3JTZWxlY3RvciA9PT0gJ3N0cmluZycpIHtcclxuXHRcdFx0Ly8gcXVlcnkgc2VsZWN0b3JcclxuXHRcdFx0dmFyIHNlbCA9IG5vZGVPclNlbGVjdG9yO1xyXG5cdFx0XHR2YXIgZWwgPSBudWxsO1xyXG5cdFx0XHR0cnkge1xyXG5cdFx0XHRcdGVsID0gd2luZG93LmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsKTtcclxuXHRcdFx0fSBjYXRjaCAoZSkge1xyXG5cdFx0XHRcdGNvbnNvbGUud2FybihlKTtcclxuXHRcdFx0XHRyZXR1cm4gbnVsbDtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoIWVsKSB7XHJcblx0XHRcdFx0Y29uc29sZS53YXJuKCdObyBlbGVtZW50IG1hdGNoZXMgdGhlIHNlbGVjdG9yOiAlcycsIHNlbCk7XHJcblx0XHRcdH1cclxuXHRcdFx0cmV0dXJuIGVsO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmIChqc2MuaXNOb2RlKG5vZGVPclNlbGVjdG9yKSkge1xyXG5cdFx0XHQvLyBET00gbm9kZVxyXG5cdFx0XHRyZXR1cm4gbm9kZU9yU2VsZWN0b3I7XHJcblx0XHR9XHJcblxyXG5cdFx0Y29uc29sZS53YXJuKCdJbnZhbGlkIG5vZGUgb2YgdHlwZSAlczogJXMnLCB0eXBlb2Ygbm9kZU9yU2VsZWN0b3IsIG5vZGVPclNlbGVjdG9yKTtcclxuXHRcdHJldHVybiBudWxsO1xyXG5cdH0sXHJcblxyXG5cclxuXHQvLyBTZWUgaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMzg0Mjg2L1xyXG5cdGlzTm9kZSA6IGZ1bmN0aW9uICh2YWwpIHtcclxuXHRcdGlmICh0eXBlb2YgTm9kZSA9PT0gJ29iamVjdCcpIHtcclxuXHRcdFx0cmV0dXJuIHZhbCBpbnN0YW5jZW9mIE5vZGU7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gdmFsICYmIHR5cGVvZiB2YWwgPT09ICdvYmplY3QnICYmIHR5cGVvZiB2YWwubm9kZVR5cGUgPT09ICdudW1iZXInICYmIHR5cGVvZiB2YWwubm9kZU5hbWUgPT09ICdzdHJpbmcnO1xyXG5cdH0sXHJcblxyXG5cclxuXHRub2RlTmFtZSA6IGZ1bmN0aW9uIChub2RlKSB7XHJcblx0XHRpZiAobm9kZSAmJiBub2RlLm5vZGVOYW1lKSB7XHJcblx0XHRcdHJldHVybiBub2RlLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gZmFsc2U7XHJcblx0fSxcclxuXHJcblxyXG5cdHJlbW92ZUNoaWxkcmVuIDogZnVuY3Rpb24gKG5vZGUpIHtcclxuXHRcdHdoaWxlIChub2RlLmZpcnN0Q2hpbGQpIHtcclxuXHRcdFx0bm9kZS5yZW1vdmVDaGlsZChub2RlLmZpcnN0Q2hpbGQpO1xyXG5cdFx0fVxyXG5cdH0sXHJcblxyXG5cclxuXHRpc1RleHRJbnB1dCA6IGZ1bmN0aW9uIChlbCkge1xyXG5cdFx0cmV0dXJuIGVsICYmIGpzYy5ub2RlTmFtZShlbCkgPT09ICdpbnB1dCcgJiYgZWwudHlwZS50b0xvd2VyQ2FzZSgpID09PSAndGV4dCc7XHJcblx0fSxcclxuXHJcblxyXG5cdGlzQnV0dG9uIDogZnVuY3Rpb24gKGVsKSB7XHJcblx0XHRpZiAoIWVsKSB7XHJcblx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdH1cclxuXHRcdHZhciBuID0ganNjLm5vZGVOYW1lKGVsKTtcclxuXHRcdHJldHVybiAoXHJcblx0XHRcdChuID09PSAnYnV0dG9uJykgfHxcclxuXHRcdFx0KG4gPT09ICdpbnB1dCcgJiYgWydidXR0b24nLCAnc3VibWl0JywgJ3Jlc2V0J10uaW5kZXhPZihlbC50eXBlLnRvTG93ZXJDYXNlKCkpID4gLTEpXHJcblx0XHQpO1xyXG5cdH0sXHJcblxyXG5cclxuXHRpc0J1dHRvbkVtcHR5IDogZnVuY3Rpb24gKGVsKSB7XHJcblx0XHRzd2l0Y2ggKGpzYy5ub2RlTmFtZShlbCkpIHtcclxuXHRcdFx0Y2FzZSAnaW5wdXQnOiByZXR1cm4gKCFlbC52YWx1ZSB8fCBlbC52YWx1ZS50cmltKCkgPT09ICcnKTtcclxuXHRcdFx0Y2FzZSAnYnV0dG9uJzogcmV0dXJuIChlbC50ZXh0Q29udGVudC50cmltKCkgPT09ICcnKTtcclxuXHRcdH1cclxuXHRcdHJldHVybiBudWxsOyAvLyBjb3VsZCBub3QgZGV0ZXJtaW5lIGVsZW1lbnQncyB0ZXh0XHJcblx0fSxcclxuXHJcblxyXG5cdC8vIFNlZSBodHRwczovL2dpdGh1Yi5jb20vV0lDRy9FdmVudExpc3RlbmVyT3B0aW9ucy9ibG9iL2doLXBhZ2VzL2V4cGxhaW5lci5tZFxyXG5cdGlzUGFzc2l2ZUV2ZW50U3VwcG9ydGVkIDogKGZ1bmN0aW9uICgpIHtcclxuXHRcdHZhciBzdXBwb3J0ZWQgPSBmYWxzZTtcclxuXHJcblx0XHR0cnkge1xyXG5cdFx0XHR2YXIgb3B0cyA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh7fSwgJ3Bhc3NpdmUnLCB7XHJcblx0XHRcdFx0Z2V0OiBmdW5jdGlvbiAoKSB7IHN1cHBvcnRlZCA9IHRydWU7IH1cclxuXHRcdFx0fSk7XHJcblx0XHRcdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCd0ZXN0UGFzc2l2ZScsIG51bGwsIG9wdHMpO1xyXG5cdFx0XHR3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigndGVzdFBhc3NpdmUnLCBudWxsLCBvcHRzKTtcclxuXHRcdH0gY2F0Y2ggKGUpIHt9XHJcblxyXG5cdFx0cmV0dXJuIHN1cHBvcnRlZDtcclxuXHR9KSgpLFxyXG5cclxuXHJcblx0aXNDb2xvckF0dHJTdXBwb3J0ZWQgOiAoZnVuY3Rpb24gKCkge1xyXG5cdFx0dmFyIGVsbSA9IHdpbmRvdy5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xyXG5cdFx0aWYgKGVsbS5zZXRBdHRyaWJ1dGUpIHtcclxuXHRcdFx0ZWxtLnNldEF0dHJpYnV0ZSgndHlwZScsICdjb2xvcicpO1xyXG5cdFx0XHRpZiAoZWxtLnR5cGUudG9Mb3dlckNhc2UoKSA9PSAnY29sb3InKSB7XHJcblx0XHRcdFx0cmV0dXJuIHRydWU7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdHJldHVybiBmYWxzZTtcclxuXHR9KSgpLFxyXG5cclxuXHJcblx0ZGF0YVByb3AgOiAnX2RhdGFfanNjb2xvcicsXHJcblxyXG5cclxuXHQvLyB1c2FnZTpcclxuXHQvLyAgIHNldERhdGEob2JqLCBwcm9wLCB2YWx1ZSlcclxuXHQvLyAgIHNldERhdGEob2JqLCB7cHJvcDp2YWx1ZSwgLi4ufSlcclxuXHQvL1xyXG5cdHNldERhdGEgOiBmdW5jdGlvbiAoKSB7XHJcblx0XHR2YXIgb2JqID0gYXJndW1lbnRzWzBdO1xyXG5cclxuXHRcdGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAzKSB7XHJcblx0XHRcdC8vIHNldHRpbmcgYSBzaW5nbGUgcHJvcGVydHlcclxuXHRcdFx0dmFyIGRhdGEgPSBvYmouaGFzT3duUHJvcGVydHkoanNjLmRhdGFQcm9wKSA/IG9ialtqc2MuZGF0YVByb3BdIDogKG9ialtqc2MuZGF0YVByb3BdID0ge30pO1xyXG5cdFx0XHR2YXIgcHJvcCA9IGFyZ3VtZW50c1sxXTtcclxuXHRcdFx0dmFyIHZhbHVlID0gYXJndW1lbnRzWzJdO1xyXG5cclxuXHRcdFx0ZGF0YVtwcm9wXSA9IHZhbHVlO1xyXG5cdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHJcblx0XHR9IGVsc2UgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDIgJiYgdHlwZW9mIGFyZ3VtZW50c1sxXSA9PT0gJ29iamVjdCcpIHtcclxuXHRcdFx0Ly8gc2V0dGluZyBtdWx0aXBsZSBwcm9wZXJ0aWVzXHJcblx0XHRcdHZhciBkYXRhID0gb2JqLmhhc093blByb3BlcnR5KGpzYy5kYXRhUHJvcCkgPyBvYmpbanNjLmRhdGFQcm9wXSA6IChvYmpbanNjLmRhdGFQcm9wXSA9IHt9KTtcclxuXHRcdFx0dmFyIG1hcCA9IGFyZ3VtZW50c1sxXTtcclxuXHJcblx0XHRcdGZvciAodmFyIHByb3AgaW4gbWFwKSB7XHJcblx0XHRcdFx0aWYgKG1hcC5oYXNPd25Qcm9wZXJ0eShwcm9wKSkge1xyXG5cdFx0XHRcdFx0ZGF0YVtwcm9wXSA9IG1hcFtwcm9wXTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0cmV0dXJuIHRydWU7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGFyZ3VtZW50cycpO1xyXG5cdH0sXHJcblxyXG5cclxuXHQvLyB1c2FnZTpcclxuXHQvLyAgIHJlbW92ZURhdGEob2JqLCBwcm9wLCBbcHJvcC4uLl0pXHJcblx0Ly9cclxuXHRyZW1vdmVEYXRhIDogZnVuY3Rpb24gKCkge1xyXG5cdFx0dmFyIG9iaiA9IGFyZ3VtZW50c1swXTtcclxuXHRcdGlmICghb2JqLmhhc093blByb3BlcnR5KGpzYy5kYXRhUHJvcCkpIHtcclxuXHRcdFx0cmV0dXJuIHRydWU7IC8vIGRhdGEgb2JqZWN0IGRvZXMgbm90IGV4aXN0XHJcblx0XHR9XHJcblx0XHRmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkgKz0gMSkge1xyXG5cdFx0XHR2YXIgcHJvcCA9IGFyZ3VtZW50c1tpXTtcclxuXHRcdFx0ZGVsZXRlIG9ialtqc2MuZGF0YVByb3BdW3Byb3BdO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHRydWU7XHJcblx0fSxcclxuXHJcblxyXG5cdGdldERhdGEgOiBmdW5jdGlvbiAob2JqLCBwcm9wLCBzZXREZWZhdWx0KSB7XHJcblx0XHRpZiAoIW9iai5oYXNPd25Qcm9wZXJ0eShqc2MuZGF0YVByb3ApKSB7XHJcblx0XHRcdC8vIGRhdGEgb2JqZWN0IGRvZXMgbm90IGV4aXN0XHJcblx0XHRcdGlmIChzZXREZWZhdWx0ICE9PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0XHRvYmpbanNjLmRhdGFQcm9wXSA9IHt9OyAvLyBjcmVhdGUgZGF0YSBvYmplY3RcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRyZXR1cm4gdW5kZWZpbmVkOyAvLyBubyB2YWx1ZSB0byByZXR1cm5cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0dmFyIGRhdGEgPSBvYmpbanNjLmRhdGFQcm9wXTtcclxuXHJcblx0XHRpZiAoIWRhdGEuaGFzT3duUHJvcGVydHkocHJvcCkgJiYgc2V0RGVmYXVsdCAhPT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdGRhdGFbcHJvcF0gPSBzZXREZWZhdWx0O1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIGRhdGFbcHJvcF07XHJcblx0fSxcclxuXHJcblxyXG5cdGdldERhdGFBdHRyIDogZnVuY3Rpb24gKGVsLCBuYW1lKSB7XHJcblx0XHR2YXIgYXR0ck5hbWUgPSAnZGF0YS0nICsgbmFtZTtcclxuXHRcdHZhciBhdHRyVmFsdWUgPSBlbC5nZXRBdHRyaWJ1dGUoYXR0ck5hbWUpO1xyXG5cdFx0cmV0dXJuIGF0dHJWYWx1ZTtcclxuXHR9LFxyXG5cclxuXHJcblx0c2V0RGF0YUF0dHIgOiBmdW5jdGlvbiAoZWwsIG5hbWUsIHZhbHVlKSB7XHJcblx0XHR2YXIgYXR0ck5hbWUgPSAnZGF0YS0nICsgbmFtZTtcclxuXHRcdGVsLnNldEF0dHJpYnV0ZShhdHRyTmFtZSwgdmFsdWUpO1xyXG5cdH0sXHJcblxyXG5cclxuXHRfYXR0YWNoZWRHcm91cEV2ZW50cyA6IHt9LFxyXG5cclxuXHJcblx0YXR0YWNoR3JvdXBFdmVudCA6IGZ1bmN0aW9uIChncm91cE5hbWUsIGVsLCBldm50LCBmdW5jKSB7XHJcblx0XHRpZiAoIWpzYy5fYXR0YWNoZWRHcm91cEV2ZW50cy5oYXNPd25Qcm9wZXJ0eShncm91cE5hbWUpKSB7XHJcblx0XHRcdGpzYy5fYXR0YWNoZWRHcm91cEV2ZW50c1tncm91cE5hbWVdID0gW107XHJcblx0XHR9XHJcblx0XHRqc2MuX2F0dGFjaGVkR3JvdXBFdmVudHNbZ3JvdXBOYW1lXS5wdXNoKFtlbCwgZXZudCwgZnVuY10pO1xyXG5cdFx0ZWwuYWRkRXZlbnRMaXN0ZW5lcihldm50LCBmdW5jLCBmYWxzZSk7XHJcblx0fSxcclxuXHJcblxyXG5cdGRldGFjaEdyb3VwRXZlbnRzIDogZnVuY3Rpb24gKGdyb3VwTmFtZSkge1xyXG5cdFx0aWYgKGpzYy5fYXR0YWNoZWRHcm91cEV2ZW50cy5oYXNPd25Qcm9wZXJ0eShncm91cE5hbWUpKSB7XHJcblx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwganNjLl9hdHRhY2hlZEdyb3VwRXZlbnRzW2dyb3VwTmFtZV0ubGVuZ3RoOyBpICs9IDEpIHtcclxuXHRcdFx0XHR2YXIgZXZ0ID0ganNjLl9hdHRhY2hlZEdyb3VwRXZlbnRzW2dyb3VwTmFtZV1baV07XHJcblx0XHRcdFx0ZXZ0WzBdLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZ0WzFdLCBldnRbMl0sIGZhbHNlKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRkZWxldGUganNjLl9hdHRhY2hlZEdyb3VwRXZlbnRzW2dyb3VwTmFtZV07XHJcblx0XHR9XHJcblx0fSxcclxuXHJcblxyXG5cdHByZXZlbnREZWZhdWx0IDogZnVuY3Rpb24gKGUpIHtcclxuXHRcdGlmIChlLnByZXZlbnREZWZhdWx0KSB7IGUucHJldmVudERlZmF1bHQoKTsgfVxyXG5cdFx0ZS5yZXR1cm5WYWx1ZSA9IGZhbHNlO1xyXG5cdH0sXHJcblxyXG5cclxuXHR0cmlnZ2VyRXZlbnQgOiBmdW5jdGlvbiAoZWwsIGV2ZW50TmFtZSwgYnViYmxlcywgY2FuY2VsYWJsZSkge1xyXG5cdFx0aWYgKCFlbCkge1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0dmFyIGV2ID0gbnVsbDtcclxuXHJcblx0XHRpZiAodHlwZW9mIEV2ZW50ID09PSAnZnVuY3Rpb24nKSB7XHJcblx0XHRcdGV2ID0gbmV3IEV2ZW50KGV2ZW50TmFtZSwge1xyXG5cdFx0XHRcdGJ1YmJsZXM6IGJ1YmJsZXMsXHJcblx0XHRcdFx0Y2FuY2VsYWJsZTogY2FuY2VsYWJsZVxyXG5cdFx0XHR9KTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdC8vIElFXHJcblx0XHRcdGV2ID0gd2luZG93LmRvY3VtZW50LmNyZWF0ZUV2ZW50KCdFdmVudCcpO1xyXG5cdFx0XHRldi5pbml0RXZlbnQoZXZlbnROYW1lLCBidWJibGVzLCBjYW5jZWxhYmxlKTtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAoIWV2KSB7XHJcblx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBzbyB0aGF0IHdlIGtub3cgdGhhdCB0aGUgZXZlbnQgd2FzIHRyaWdnZXJlZCBpbnRlcm5hbGx5XHJcblx0XHRqc2Muc2V0RGF0YShldiwgJ2ludGVybmFsJywgdHJ1ZSk7XHJcblxyXG5cdFx0ZWwuZGlzcGF0Y2hFdmVudChldik7XHJcblx0XHRyZXR1cm4gdHJ1ZTtcclxuXHR9LFxyXG5cclxuXHJcblx0dHJpZ2dlcklucHV0RXZlbnQgOiBmdW5jdGlvbiAoZWwsIGV2ZW50TmFtZSwgYnViYmxlcywgY2FuY2VsYWJsZSkge1xyXG5cdFx0aWYgKCFlbCkge1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblx0XHRpZiAoanNjLmlzVGV4dElucHV0KGVsKSkge1xyXG5cdFx0XHRqc2MudHJpZ2dlckV2ZW50KGVsLCBldmVudE5hbWUsIGJ1YmJsZXMsIGNhbmNlbGFibGUpO1xyXG5cdFx0fVxyXG5cdH0sXHJcblxyXG5cclxuXHRldmVudEtleSA6IGZ1bmN0aW9uIChldikge1xyXG5cdFx0dmFyIGtleXMgPSB7XHJcblx0XHRcdDk6ICdUYWInLFxyXG5cdFx0XHQxMzogJ0VudGVyJyxcclxuXHRcdFx0Mjc6ICdFc2NhcGUnLFxyXG5cdFx0fTtcclxuXHRcdGlmICh0eXBlb2YgZXYuY29kZSA9PT0gJ3N0cmluZycpIHtcclxuXHRcdFx0cmV0dXJuIGV2LmNvZGU7XHJcblx0XHR9IGVsc2UgaWYgKGV2LmtleUNvZGUgIT09IHVuZGVmaW5lZCAmJiBrZXlzLmhhc093blByb3BlcnR5KGV2LmtleUNvZGUpKSB7XHJcblx0XHRcdHJldHVybiBrZXlzW2V2LmtleUNvZGVdO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIG51bGw7XHJcblx0fSxcclxuXHJcblxyXG5cdHN0ckxpc3QgOiBmdW5jdGlvbiAoc3RyKSB7XHJcblx0XHRpZiAoIXN0cikge1xyXG5cdFx0XHRyZXR1cm4gW107XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gc3RyLnJlcGxhY2UoL15cXHMrfFxccyskL2csICcnKS5zcGxpdCgvXFxzKy8pO1xyXG5cdH0sXHJcblxyXG5cclxuXHQvLyBUaGUgY2xhc3NOYW1lIHBhcmFtZXRlciAoc3RyKSBjYW4gb25seSBjb250YWluIGEgc2luZ2xlIGNsYXNzIG5hbWVcclxuXHRoYXNDbGFzcyA6IGZ1bmN0aW9uIChlbG0sIGNsYXNzTmFtZSkge1xyXG5cdFx0aWYgKCFjbGFzc05hbWUpIHtcclxuXHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0fVxyXG5cdFx0aWYgKGVsbS5jbGFzc0xpc3QgIT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRyZXR1cm4gZWxtLmNsYXNzTGlzdC5jb250YWlucyhjbGFzc05hbWUpO1xyXG5cdFx0fVxyXG5cdFx0Ly8gcG9seWZpbGxcclxuXHRcdHJldHVybiAtMSAhPSAoJyAnICsgZWxtLmNsYXNzTmFtZS5yZXBsYWNlKC9cXHMrL2csICcgJykgKyAnICcpLmluZGV4T2YoJyAnICsgY2xhc3NOYW1lICsgJyAnKTtcclxuXHR9LFxyXG5cclxuXHJcblx0Ly8gVGhlIGNsYXNzTmFtZSBwYXJhbWV0ZXIgKHN0cikgY2FuIGNvbnRhaW4gbXVsdGlwbGUgY2xhc3MgbmFtZXMgc2VwYXJhdGVkIGJ5IHdoaXRlc3BhY2VcclxuXHRhZGRDbGFzcyA6IGZ1bmN0aW9uIChlbG0sIGNsYXNzTmFtZSkge1xyXG5cdFx0dmFyIGNsYXNzTmFtZXMgPSBqc2Muc3RyTGlzdChjbGFzc05hbWUpO1xyXG5cclxuXHRcdGlmIChlbG0uY2xhc3NMaXN0ICE9PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBjbGFzc05hbWVzLmxlbmd0aDsgaSArPSAxKSB7XHJcblx0XHRcdFx0ZWxtLmNsYXNzTGlzdC5hZGQoY2xhc3NOYW1lc1tpXSk7XHJcblx0XHRcdH1cclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cdFx0Ly8gcG9seWZpbGxcclxuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgY2xhc3NOYW1lcy5sZW5ndGg7IGkgKz0gMSkge1xyXG5cdFx0XHRpZiAoIWpzYy5oYXNDbGFzcyhlbG0sIGNsYXNzTmFtZXNbaV0pKSB7XHJcblx0XHRcdFx0ZWxtLmNsYXNzTmFtZSArPSAoZWxtLmNsYXNzTmFtZSA/ICcgJyA6ICcnKSArIGNsYXNzTmFtZXNbaV07XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9LFxyXG5cclxuXHJcblx0Ly8gVGhlIGNsYXNzTmFtZSBwYXJhbWV0ZXIgKHN0cikgY2FuIGNvbnRhaW4gbXVsdGlwbGUgY2xhc3MgbmFtZXMgc2VwYXJhdGVkIGJ5IHdoaXRlc3BhY2VcclxuXHRyZW1vdmVDbGFzcyA6IGZ1bmN0aW9uIChlbG0sIGNsYXNzTmFtZSkge1xyXG5cdFx0dmFyIGNsYXNzTmFtZXMgPSBqc2Muc3RyTGlzdChjbGFzc05hbWUpO1xyXG5cclxuXHRcdGlmIChlbG0uY2xhc3NMaXN0ICE9PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBjbGFzc05hbWVzLmxlbmd0aDsgaSArPSAxKSB7XHJcblx0XHRcdFx0ZWxtLmNsYXNzTGlzdC5yZW1vdmUoY2xhc3NOYW1lc1tpXSk7XHJcblx0XHRcdH1cclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cdFx0Ly8gcG9seWZpbGxcclxuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgY2xhc3NOYW1lcy5sZW5ndGg7IGkgKz0gMSkge1xyXG5cdFx0XHR2YXIgcmVwbCA9IG5ldyBSZWdFeHAoXHJcblx0XHRcdFx0J15cXFxccyonICsgY2xhc3NOYW1lc1tpXSArICdcXFxccyp8JyArXHJcblx0XHRcdFx0J1xcXFxzKicgKyBjbGFzc05hbWVzW2ldICsgJ1xcXFxzKiR8JyArXHJcblx0XHRcdFx0J1xcXFxzKycgKyBjbGFzc05hbWVzW2ldICsgJyhcXFxccyspJyxcclxuXHRcdFx0XHQnZydcclxuXHRcdFx0KTtcclxuXHRcdFx0ZWxtLmNsYXNzTmFtZSA9IGVsbS5jbGFzc05hbWUucmVwbGFjZShyZXBsLCAnJDEnKTtcclxuXHRcdH1cclxuXHR9LFxyXG5cclxuXHJcblx0Z2V0Q29tcFN0eWxlIDogZnVuY3Rpb24gKGVsbSkge1xyXG5cdFx0dmFyIGNvbXBTdHlsZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlID8gd2luZG93LmdldENvbXB1dGVkU3R5bGUoZWxtKSA6IGVsbS5jdXJyZW50U3R5bGU7XHJcblxyXG5cdFx0Ly8gTm90ZTogSW4gRmlyZWZveCwgZ2V0Q29tcHV0ZWRTdHlsZSByZXR1cm5zIG51bGwgaW4gYSBoaWRkZW4gaWZyYW1lLFxyXG5cdFx0Ly8gdGhhdCdzIHdoeSB3ZSBuZWVkIHRvIGNoZWNrIGlmIHRoZSByZXR1cm5lZCB2YWx1ZSBpcyBub24tZW1wdHlcclxuXHRcdGlmICghY29tcFN0eWxlKSB7XHJcblx0XHRcdHJldHVybiB7fTtcclxuXHRcdH1cclxuXHRcdHJldHVybiBjb21wU3R5bGU7XHJcblx0fSxcclxuXHJcblxyXG5cdC8vIE5vdGU6XHJcblx0Ly8gICBTZXR0aW5nIGEgcHJvcGVydHkgdG8gTlVMTCByZXZlcnRzIGl0IHRvIHRoZSBzdGF0ZSBiZWZvcmUgaXQgd2FzIGZpcnN0IHNldFxyXG5cdC8vICAgd2l0aCB0aGUgJ3JldmVyc2libGUnIGZsYWcgZW5hYmxlZFxyXG5cdC8vXHJcblx0c2V0U3R5bGUgOiBmdW5jdGlvbiAoZWxtLCBzdHlsZXMsIGltcG9ydGFudCwgcmV2ZXJzaWJsZSkge1xyXG5cdFx0Ly8gdXNpbmcgJycgZm9yIHN0YW5kYXJkIHByaW9yaXR5IChJRTEwIGFwcGFyZW50bHkgZG9lc24ndCBsaWtlIHZhbHVlIHVuZGVmaW5lZClcclxuXHRcdHZhciBwcmlvcml0eSA9IGltcG9ydGFudCA/ICdpbXBvcnRhbnQnIDogJyc7XHJcblx0XHR2YXIgb3JpZ1N0eWxlID0gbnVsbDtcclxuXHJcblx0XHRmb3IgKHZhciBwcm9wIGluIHN0eWxlcykge1xyXG5cdFx0XHRpZiAoc3R5bGVzLmhhc093blByb3BlcnR5KHByb3ApKSB7XHJcblx0XHRcdFx0dmFyIHNldFZhbCA9IG51bGw7XHJcblxyXG5cdFx0XHRcdGlmIChzdHlsZXNbcHJvcF0gPT09IG51bGwpIHtcclxuXHRcdFx0XHRcdC8vIHJldmVydGluZyBhIHByb3BlcnR5IHZhbHVlXHJcblxyXG5cdFx0XHRcdFx0aWYgKCFvcmlnU3R5bGUpIHtcclxuXHRcdFx0XHRcdFx0Ly8gZ2V0IHRoZSBvcmlnaW5hbCBzdHlsZSBvYmplY3QsIGJ1dCBkb250J3QgdHJ5IHRvIGNyZWF0ZSBpdCBpZiBpdCBkb2Vzbid0IGV4aXN0XHJcblx0XHRcdFx0XHRcdG9yaWdTdHlsZSA9IGpzYy5nZXREYXRhKGVsbSwgJ29yaWdTdHlsZScpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0aWYgKG9yaWdTdHlsZSAmJiBvcmlnU3R5bGUuaGFzT3duUHJvcGVydHkocHJvcCkpIHtcclxuXHRcdFx0XHRcdFx0Ly8gd2UgaGF2ZSBwcm9wZXJ0eSdzIG9yaWdpbmFsIHZhbHVlIC0+IHVzZSBpdFxyXG5cdFx0XHRcdFx0XHRzZXRWYWwgPSBvcmlnU3R5bGVbcHJvcF07XHJcblx0XHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHQvLyBzZXR0aW5nIGEgcHJvcGVydHkgdmFsdWVcclxuXHJcblx0XHRcdFx0XHRpZiAocmV2ZXJzaWJsZSkge1xyXG5cdFx0XHRcdFx0XHRpZiAoIW9yaWdTdHlsZSkge1xyXG5cdFx0XHRcdFx0XHRcdC8vIGdldCB0aGUgb3JpZ2luYWwgc3R5bGUgb2JqZWN0IGFuZCBpZiBpdCBkb2Vzbid0IGV4aXN0LCBjcmVhdGUgaXRcclxuXHRcdFx0XHRcdFx0XHRvcmlnU3R5bGUgPSBqc2MuZ2V0RGF0YShlbG0sICdvcmlnU3R5bGUnLCB7fSk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0aWYgKCFvcmlnU3R5bGUuaGFzT3duUHJvcGVydHkocHJvcCkpIHtcclxuXHRcdFx0XHRcdFx0XHQvLyBvcmlnaW5hbCBwcm9wZXJ0eSB2YWx1ZSBub3QgeWV0IHN0b3JlZCAtPiBzdG9yZSBpdFxyXG5cdFx0XHRcdFx0XHRcdG9yaWdTdHlsZVtwcm9wXSA9IGVsbS5zdHlsZVtwcm9wXTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0c2V0VmFsID0gc3R5bGVzW3Byb3BdO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0aWYgKHNldFZhbCAhPT0gbnVsbCkge1xyXG5cdFx0XHRcdFx0ZWxtLnN0eWxlLnNldFByb3BlcnR5KHByb3AsIHNldFZhbCwgcHJpb3JpdHkpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH0sXHJcblxyXG5cclxuXHRhcHBlbmRDc3MgOiBmdW5jdGlvbiAoY3NzKSB7XHJcblx0XHR2YXIgaGVhZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2hlYWQnKTtcclxuXHRcdHZhciBzdHlsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJyk7XHJcblx0XHRzdHlsZS5pbm5lclRleHQgPSBjc3M7XHJcblx0XHRoZWFkLmFwcGVuZENoaWxkKHN0eWxlKTtcclxuXHR9LFxyXG5cclxuXHJcblx0YXBwZW5kRGVmYXVsdENzcyA6IGZ1bmN0aW9uIChjc3MpIHtcclxuXHRcdGpzYy5hcHBlbmRDc3MoXHJcblx0XHRcdFtcclxuXHRcdFx0XHQnLmpzY29sb3Itd3JhcCwgLmpzY29sb3Itd3JhcCBkaXYsIC5qc2NvbG9yLXdyYXAgY2FudmFzIHsgJyArXHJcblx0XHRcdFx0J3Bvc2l0aW9uOnN0YXRpYzsgZGlzcGxheTpibG9jazsgdmlzaWJpbGl0eTp2aXNpYmxlOyBvdmVyZmxvdzp2aXNpYmxlOyBtYXJnaW46MDsgcGFkZGluZzowOyAnICtcclxuXHRcdFx0XHQnYm9yZGVyOm5vbmU7IGJvcmRlci1yYWRpdXM6MDsgb3V0bGluZTpub25lOyB6LWluZGV4OmF1dG87IGZsb2F0Om5vbmU7ICcgK1xyXG5cdFx0XHRcdCd3aWR0aDphdXRvOyBoZWlnaHQ6YXV0bzsgbGVmdDphdXRvOyByaWdodDphdXRvOyB0b3A6YXV0bzsgYm90dG9tOmF1dG87IG1pbi13aWR0aDowOyBtaW4taGVpZ2h0OjA7IG1heC13aWR0aDpub25lOyBtYXgtaGVpZ2h0Om5vbmU7ICcgK1xyXG5cdFx0XHRcdCdiYWNrZ3JvdW5kOm5vbmU7IGNsaXA6YXV0bzsgb3BhY2l0eToxOyB0cmFuc2Zvcm06bm9uZTsgYm94LXNoYWRvdzpub25lOyBib3gtc2l6aW5nOmNvbnRlbnQtYm94OyAnICtcclxuXHRcdFx0XHQnfScsXHJcblx0XHRcdFx0Jy5qc2NvbG9yLXdyYXAgeyBjbGVhcjpib3RoOyB9JyxcclxuXHRcdFx0XHQnLmpzY29sb3Itd3JhcCAuanNjb2xvci1waWNrZXIgeyBwb3NpdGlvbjpyZWxhdGl2ZTsgfScsXHJcblx0XHRcdFx0Jy5qc2NvbG9yLXdyYXAgLmpzY29sb3Itc2hhZG93IHsgcG9zaXRpb246YWJzb2x1dGU7IGxlZnQ6MDsgdG9wOjA7IHdpZHRoOjEwMCU7IGhlaWdodDoxMDAlOyB9JyxcclxuXHRcdFx0XHQnLmpzY29sb3Itd3JhcCAuanNjb2xvci1ib3JkZXIgeyBwb3NpdGlvbjpyZWxhdGl2ZTsgfScsXHJcblx0XHRcdFx0Jy5qc2NvbG9yLXdyYXAgLmpzY29sb3ItcGFsZXR0ZSB7IHBvc2l0aW9uOmFic29sdXRlOyB9JyxcclxuXHRcdFx0XHQnLmpzY29sb3Itd3JhcCAuanNjb2xvci1wYWxldHRlLXN3IHsgcG9zaXRpb246YWJzb2x1dGU7IGRpc3BsYXk6YmxvY2s7IGN1cnNvcjpwb2ludGVyOyB9JyxcclxuXHRcdFx0XHQnLmpzY29sb3Itd3JhcCAuanNjb2xvci1idG4geyBwb3NpdGlvbjphYnNvbHV0ZTsgb3ZlcmZsb3c6aGlkZGVuOyB3aGl0ZS1zcGFjZTpub3dyYXA7IGZvbnQ6MTNweCBzYW5zLXNlcmlmOyB0ZXh0LWFsaWduOmNlbnRlcjsgY3Vyc29yOnBvaW50ZXI7IH0nLFxyXG5cdFx0XHRdLmpvaW4oJ1xcbicpXHJcblx0XHQpO1xyXG5cdH0sXHJcblxyXG5cclxuXHRoZXhDb2xvciA6IGZ1bmN0aW9uIChyLCBnLCBiKSB7XHJcblx0XHRyZXR1cm4gJyMnICsgKFxyXG5cdFx0XHQoJzAnICsgTWF0aC5yb3VuZChyKS50b1N0cmluZygxNikpLnNsaWNlKC0yKSArXHJcblx0XHRcdCgnMCcgKyBNYXRoLnJvdW5kKGcpLnRvU3RyaW5nKDE2KSkuc2xpY2UoLTIpICtcclxuXHRcdFx0KCcwJyArIE1hdGgucm91bmQoYikudG9TdHJpbmcoMTYpKS5zbGljZSgtMilcclxuXHRcdCkudG9VcHBlckNhc2UoKTtcclxuXHR9LFxyXG5cclxuXHJcblx0aGV4YUNvbG9yIDogZnVuY3Rpb24gKHIsIGcsIGIsIGEpIHtcclxuXHRcdHJldHVybiAnIycgKyAoXHJcblx0XHRcdCgnMCcgKyBNYXRoLnJvdW5kKHIpLnRvU3RyaW5nKDE2KSkuc2xpY2UoLTIpICtcclxuXHRcdFx0KCcwJyArIE1hdGgucm91bmQoZykudG9TdHJpbmcoMTYpKS5zbGljZSgtMikgK1xyXG5cdFx0XHQoJzAnICsgTWF0aC5yb3VuZChiKS50b1N0cmluZygxNikpLnNsaWNlKC0yKSArXHJcblx0XHRcdCgnMCcgKyBNYXRoLnJvdW5kKGEgKiAyNTUpLnRvU3RyaW5nKDE2KSkuc2xpY2UoLTIpXHJcblx0XHQpLnRvVXBwZXJDYXNlKCk7XHJcblx0fSxcclxuXHJcblxyXG5cdHJnYkNvbG9yIDogZnVuY3Rpb24gKHIsIGcsIGIpIHtcclxuXHRcdHJldHVybiAncmdiKCcgK1xyXG5cdFx0XHRNYXRoLnJvdW5kKHIpICsgJywnICtcclxuXHRcdFx0TWF0aC5yb3VuZChnKSArICcsJyArXHJcblx0XHRcdE1hdGgucm91bmQoYikgK1xyXG5cdFx0JyknO1xyXG5cdH0sXHJcblxyXG5cclxuXHRyZ2JhQ29sb3IgOiBmdW5jdGlvbiAociwgZywgYiwgYSkge1xyXG5cdFx0cmV0dXJuICdyZ2JhKCcgK1xyXG5cdFx0XHRNYXRoLnJvdW5kKHIpICsgJywnICtcclxuXHRcdFx0TWF0aC5yb3VuZChnKSArICcsJyArXHJcblx0XHRcdE1hdGgucm91bmQoYikgKyAnLCcgK1xyXG5cdFx0XHQoTWF0aC5yb3VuZCgoYT09PXVuZGVmaW5lZCB8fCBhPT09bnVsbCA/IDEgOiBhKSAqIDEwMCkgLyAxMDApICtcclxuXHRcdCcpJztcclxuXHR9LFxyXG5cclxuXHJcblx0bGluZWFyR3JhZGllbnQgOiAoZnVuY3Rpb24gKCkge1xyXG5cclxuXHRcdGZ1bmN0aW9uIGdldEZ1bmNOYW1lICgpIHtcclxuXHRcdFx0dmFyIHN0ZE5hbWUgPSAnbGluZWFyLWdyYWRpZW50JztcclxuXHRcdFx0dmFyIHByZWZpeGVzID0gWycnLCAnLXdlYmtpdC0nLCAnLW1vei0nLCAnLW8tJywgJy1tcy0nXTtcclxuXHRcdFx0dmFyIGhlbHBlciA9IHdpbmRvdy5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuXHJcblx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgcHJlZml4ZXMubGVuZ3RoOyBpICs9IDEpIHtcclxuXHRcdFx0XHR2YXIgdHJ5RnVuYyA9IHByZWZpeGVzW2ldICsgc3RkTmFtZTtcclxuXHRcdFx0XHR2YXIgdHJ5VmFsID0gdHJ5RnVuYyArICcodG8gcmlnaHQsIHJnYmEoMCwwLDAsMCksIHJnYmEoMCwwLDAsMCkpJztcclxuXHJcblx0XHRcdFx0aGVscGVyLnN0eWxlLmJhY2tncm91bmQgPSB0cnlWYWw7XHJcblx0XHRcdFx0aWYgKGhlbHBlci5zdHlsZS5iYWNrZ3JvdW5kKSB7IC8vIENTUyBiYWNrZ3JvdW5kIHN1Y2Nlc3NmdWxseSBzZXQgLT4gZnVuY3Rpb24gbmFtZSBpcyBzdXBwb3J0ZWRcclxuXHRcdFx0XHRcdHJldHVybiB0cnlGdW5jO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRyZXR1cm4gc3RkTmFtZTsgLy8gZmFsbGJhY2sgdG8gc3RhbmRhcmQgJ2xpbmVhci1ncmFkaWVudCcgd2l0aG91dCB2ZW5kb3IgcHJlZml4XHJcblx0XHR9XHJcblxyXG5cdFx0dmFyIGZ1bmNOYW1lID0gZ2V0RnVuY05hbWUoKTtcclxuXHJcblx0XHRyZXR1cm4gZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRyZXR1cm4gZnVuY05hbWUgKyAnKCcgKyBBcnJheS5wcm90b3R5cGUuam9pbi5jYWxsKGFyZ3VtZW50cywgJywgJykgKyAnKSc7XHJcblx0XHR9O1xyXG5cclxuXHR9KSgpLFxyXG5cclxuXHJcblx0c2V0Qm9yZGVyUmFkaXVzIDogZnVuY3Rpb24gKGVsbSwgdmFsdWUpIHtcclxuXHRcdGpzYy5zZXRTdHlsZShlbG0sIHsnYm9yZGVyLXJhZGl1cycgOiB2YWx1ZSB8fCAnMCd9KTtcclxuXHR9LFxyXG5cclxuXHJcblx0c2V0Qm94U2hhZG93IDogZnVuY3Rpb24gKGVsbSwgdmFsdWUpIHtcclxuXHRcdGpzYy5zZXRTdHlsZShlbG0sIHsnYm94LXNoYWRvdyc6IHZhbHVlIHx8ICdub25lJ30pO1xyXG5cdH0sXHJcblxyXG5cclxuXHRnZXRFbGVtZW50UG9zIDogZnVuY3Rpb24gKGUsIHJlbGF0aXZlVG9WaWV3cG9ydCkge1xyXG5cdFx0dmFyIHg9MCwgeT0wO1xyXG5cdFx0dmFyIHJlY3QgPSBlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG5cdFx0eCA9IHJlY3QubGVmdDtcclxuXHRcdHkgPSByZWN0LnRvcDtcclxuXHRcdGlmICghcmVsYXRpdmVUb1ZpZXdwb3J0KSB7XHJcblx0XHRcdHZhciB2aWV3UG9zID0ganNjLmdldFZpZXdQb3MoKTtcclxuXHRcdFx0eCArPSB2aWV3UG9zWzBdO1xyXG5cdFx0XHR5ICs9IHZpZXdQb3NbMV07XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gW3gsIHldO1xyXG5cdH0sXHJcblxyXG5cclxuXHRnZXRFbGVtZW50U2l6ZSA6IGZ1bmN0aW9uIChlKSB7XHJcblx0XHRyZXR1cm4gW2Uub2Zmc2V0V2lkdGgsIGUub2Zmc2V0SGVpZ2h0XTtcclxuXHR9LFxyXG5cclxuXHJcblx0Ly8gZ2V0IHBvaW50ZXIncyBYL1kgY29vcmRpbmF0ZXMgcmVsYXRpdmUgdG8gdmlld3BvcnRcclxuXHRnZXRBYnNQb2ludGVyUG9zIDogZnVuY3Rpb24gKGUpIHtcclxuXHRcdHZhciB4ID0gMCwgeSA9IDA7XHJcblx0XHRpZiAodHlwZW9mIGUuY2hhbmdlZFRvdWNoZXMgIT09ICd1bmRlZmluZWQnICYmIGUuY2hhbmdlZFRvdWNoZXMubGVuZ3RoKSB7XHJcblx0XHRcdC8vIHRvdWNoIGRldmljZXNcclxuXHRcdFx0eCA9IGUuY2hhbmdlZFRvdWNoZXNbMF0uY2xpZW50WDtcclxuXHRcdFx0eSA9IGUuY2hhbmdlZFRvdWNoZXNbMF0uY2xpZW50WTtcclxuXHRcdH0gZWxzZSBpZiAodHlwZW9mIGUuY2xpZW50WCA9PT0gJ251bWJlcicpIHtcclxuXHRcdFx0eCA9IGUuY2xpZW50WDtcclxuXHRcdFx0eSA9IGUuY2xpZW50WTtcclxuXHRcdH1cclxuXHRcdHJldHVybiB7IHg6IHgsIHk6IHkgfTtcclxuXHR9LFxyXG5cclxuXHJcblx0Ly8gZ2V0IHBvaW50ZXIncyBYL1kgY29vcmRpbmF0ZXMgcmVsYXRpdmUgdG8gdGFyZ2V0IGVsZW1lbnRcclxuXHRnZXRSZWxQb2ludGVyUG9zIDogZnVuY3Rpb24gKGUpIHtcclxuXHRcdHZhciB0YXJnZXQgPSBlLnRhcmdldCB8fCBlLnNyY0VsZW1lbnQ7XHJcblx0XHR2YXIgdGFyZ2V0UmVjdCA9IHRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuXHJcblx0XHR2YXIgeCA9IDAsIHkgPSAwO1xyXG5cclxuXHRcdHZhciBjbGllbnRYID0gMCwgY2xpZW50WSA9IDA7XHJcblx0XHRpZiAodHlwZW9mIGUuY2hhbmdlZFRvdWNoZXMgIT09ICd1bmRlZmluZWQnICYmIGUuY2hhbmdlZFRvdWNoZXMubGVuZ3RoKSB7XHJcblx0XHRcdC8vIHRvdWNoIGRldmljZXNcclxuXHRcdFx0Y2xpZW50WCA9IGUuY2hhbmdlZFRvdWNoZXNbMF0uY2xpZW50WDtcclxuXHRcdFx0Y2xpZW50WSA9IGUuY2hhbmdlZFRvdWNoZXNbMF0uY2xpZW50WTtcclxuXHRcdH0gZWxzZSBpZiAodHlwZW9mIGUuY2xpZW50WCA9PT0gJ251bWJlcicpIHtcclxuXHRcdFx0Y2xpZW50WCA9IGUuY2xpZW50WDtcclxuXHRcdFx0Y2xpZW50WSA9IGUuY2xpZW50WTtcclxuXHRcdH1cclxuXHJcblx0XHR4ID0gY2xpZW50WCAtIHRhcmdldFJlY3QubGVmdDtcclxuXHRcdHkgPSBjbGllbnRZIC0gdGFyZ2V0UmVjdC50b3A7XHJcblx0XHRyZXR1cm4geyB4OiB4LCB5OiB5IH07XHJcblx0fSxcclxuXHJcblxyXG5cdGdldFZpZXdQb3MgOiBmdW5jdGlvbiAoKSB7XHJcblx0XHR2YXIgZG9jID0gd2luZG93LmRvY3VtZW50LmRvY3VtZW50RWxlbWVudDtcclxuXHRcdHJldHVybiBbXHJcblx0XHRcdCh3aW5kb3cucGFnZVhPZmZzZXQgfHwgZG9jLnNjcm9sbExlZnQpIC0gKGRvYy5jbGllbnRMZWZ0IHx8IDApLFxyXG5cdFx0XHQod2luZG93LnBhZ2VZT2Zmc2V0IHx8IGRvYy5zY3JvbGxUb3ApIC0gKGRvYy5jbGllbnRUb3AgfHwgMClcclxuXHRcdF07XHJcblx0fSxcclxuXHJcblxyXG5cdGdldFZpZXdTaXplIDogZnVuY3Rpb24gKCkge1xyXG5cdFx0dmFyIGRvYyA9IHdpbmRvdy5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7XHJcblx0XHRyZXR1cm4gW1xyXG5cdFx0XHQod2luZG93LmlubmVyV2lkdGggfHwgZG9jLmNsaWVudFdpZHRoKSxcclxuXHRcdFx0KHdpbmRvdy5pbm5lckhlaWdodCB8fCBkb2MuY2xpZW50SGVpZ2h0KSxcclxuXHRcdF07XHJcblx0fSxcclxuXHJcblxyXG5cdC8vIHI6IDAtMjU1XHJcblx0Ly8gZzogMC0yNTVcclxuXHQvLyBiOiAwLTI1NVxyXG5cdC8vXHJcblx0Ly8gcmV0dXJuczogWyAwLTM2MCwgMC0xMDAsIDAtMTAwIF1cclxuXHQvL1xyXG5cdFJHQl9IU1YgOiBmdW5jdGlvbiAociwgZywgYikge1xyXG5cdFx0ciAvPSAyNTU7XHJcblx0XHRnIC89IDI1NTtcclxuXHRcdGIgLz0gMjU1O1xyXG5cdFx0dmFyIG4gPSBNYXRoLm1pbihNYXRoLm1pbihyLGcpLGIpO1xyXG5cdFx0dmFyIHYgPSBNYXRoLm1heChNYXRoLm1heChyLGcpLGIpO1xyXG5cdFx0dmFyIG0gPSB2IC0gbjtcclxuXHRcdGlmIChtID09PSAwKSB7IHJldHVybiBbIG51bGwsIDAsIDEwMCAqIHYgXTsgfVxyXG5cdFx0dmFyIGggPSByPT09biA/IDMrKGItZykvbSA6IChnPT09biA/IDUrKHItYikvbSA6IDErKGctcikvbSk7XHJcblx0XHRyZXR1cm4gW1xyXG5cdFx0XHQ2MCAqIChoPT09Nj8wOmgpLFxyXG5cdFx0XHQxMDAgKiAobS92KSxcclxuXHRcdFx0MTAwICogdlxyXG5cdFx0XTtcclxuXHR9LFxyXG5cclxuXHJcblx0Ly8gaDogMC0zNjBcclxuXHQvLyBzOiAwLTEwMFxyXG5cdC8vIHY6IDAtMTAwXHJcblx0Ly9cclxuXHQvLyByZXR1cm5zOiBbIDAtMjU1LCAwLTI1NSwgMC0yNTUgXVxyXG5cdC8vXHJcblx0SFNWX1JHQiA6IGZ1bmN0aW9uIChoLCBzLCB2KSB7XHJcblx0XHR2YXIgdSA9IDI1NSAqICh2IC8gMTAwKTtcclxuXHJcblx0XHRpZiAoaCA9PT0gbnVsbCkge1xyXG5cdFx0XHRyZXR1cm4gWyB1LCB1LCB1IF07XHJcblx0XHR9XHJcblxyXG5cdFx0aCAvPSA2MDtcclxuXHRcdHMgLz0gMTAwO1xyXG5cclxuXHRcdHZhciBpID0gTWF0aC5mbG9vcihoKTtcclxuXHRcdHZhciBmID0gaSUyID8gaC1pIDogMS0oaC1pKTtcclxuXHRcdHZhciBtID0gdSAqICgxIC0gcyk7XHJcblx0XHR2YXIgbiA9IHUgKiAoMSAtIHMgKiBmKTtcclxuXHRcdHN3aXRjaCAoaSkge1xyXG5cdFx0XHRjYXNlIDY6XHJcblx0XHRcdGNhc2UgMDogcmV0dXJuIFt1LG4sbV07XHJcblx0XHRcdGNhc2UgMTogcmV0dXJuIFtuLHUsbV07XHJcblx0XHRcdGNhc2UgMjogcmV0dXJuIFttLHUsbl07XHJcblx0XHRcdGNhc2UgMzogcmV0dXJuIFttLG4sdV07XHJcblx0XHRcdGNhc2UgNDogcmV0dXJuIFtuLG0sdV07XHJcblx0XHRcdGNhc2UgNTogcmV0dXJuIFt1LG0sbl07XHJcblx0XHR9XHJcblx0fSxcclxuXHJcblxyXG5cdHBhcnNlQ29sb3JTdHJpbmcgOiBmdW5jdGlvbiAoc3RyKSB7XHJcblx0XHR2YXIgcmV0ID0ge1xyXG5cdFx0XHRyZ2JhOiBudWxsLFxyXG5cdFx0XHRmb3JtYXQ6IG51bGwgLy8gJ2hleCcgfCAnaGV4YScgfCAncmdiJyB8ICdyZ2JhJ1xyXG5cdFx0fTtcclxuXHJcblx0XHR2YXIgbTtcclxuXHJcblx0XHRpZiAobSA9IHN0ci5tYXRjaCgvXlxcVyooWzAtOUEtRl17Myw4fSlcXFcqJC9pKSkge1xyXG5cdFx0XHQvLyBIRVggbm90YXRpb25cclxuXHJcblx0XHRcdGlmIChtWzFdLmxlbmd0aCA9PT0gOCkge1xyXG5cdFx0XHRcdC8vIDgtY2hhciBub3RhdGlvbiAoPSB3aXRoIGFscGhhKVxyXG5cdFx0XHRcdHJldC5mb3JtYXQgPSAnaGV4YSc7XHJcblx0XHRcdFx0cmV0LnJnYmEgPSBbXHJcblx0XHRcdFx0XHRwYXJzZUludChtWzFdLnNsaWNlKDAsMiksMTYpLFxyXG5cdFx0XHRcdFx0cGFyc2VJbnQobVsxXS5zbGljZSgyLDQpLDE2KSxcclxuXHRcdFx0XHRcdHBhcnNlSW50KG1bMV0uc2xpY2UoNCw2KSwxNiksXHJcblx0XHRcdFx0XHRwYXJzZUludChtWzFdLnNsaWNlKDYsOCksMTYpIC8gMjU1XHJcblx0XHRcdFx0XTtcclxuXHJcblx0XHRcdH0gZWxzZSBpZiAobVsxXS5sZW5ndGggPT09IDYpIHtcclxuXHRcdFx0XHQvLyA2LWNoYXIgbm90YXRpb25cclxuXHRcdFx0XHRyZXQuZm9ybWF0ID0gJ2hleCc7XHJcblx0XHRcdFx0cmV0LnJnYmEgPSBbXHJcblx0XHRcdFx0XHRwYXJzZUludChtWzFdLnNsaWNlKDAsMiksMTYpLFxyXG5cdFx0XHRcdFx0cGFyc2VJbnQobVsxXS5zbGljZSgyLDQpLDE2KSxcclxuXHRcdFx0XHRcdHBhcnNlSW50KG1bMV0uc2xpY2UoNCw2KSwxNiksXHJcblx0XHRcdFx0XHRudWxsXHJcblx0XHRcdFx0XTtcclxuXHJcblx0XHRcdH0gZWxzZSBpZiAobVsxXS5sZW5ndGggPT09IDMpIHtcclxuXHRcdFx0XHQvLyAzLWNoYXIgbm90YXRpb25cclxuXHRcdFx0XHRyZXQuZm9ybWF0ID0gJ2hleCc7XHJcblx0XHRcdFx0cmV0LnJnYmEgPSBbXHJcblx0XHRcdFx0XHRwYXJzZUludChtWzFdLmNoYXJBdCgwKSArIG1bMV0uY2hhckF0KDApLDE2KSxcclxuXHRcdFx0XHRcdHBhcnNlSW50KG1bMV0uY2hhckF0KDEpICsgbVsxXS5jaGFyQXQoMSksMTYpLFxyXG5cdFx0XHRcdFx0cGFyc2VJbnQobVsxXS5jaGFyQXQoMikgKyBtWzFdLmNoYXJBdCgyKSwxNiksXHJcblx0XHRcdFx0XHRudWxsXHJcblx0XHRcdFx0XTtcclxuXHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRyZXR1cm4gcmV0O1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmIChtID0gc3RyLm1hdGNoKC9eXFxXKnJnYmE/XFwoKFteKV0qKVxcKVxcVyokL2kpKSB7XHJcblx0XHRcdC8vIHJnYiguLi4pIG9yIHJnYmEoLi4uKSBub3RhdGlvblxyXG5cclxuXHRcdFx0dmFyIHBhciA9IG1bMV0uc3BsaXQoJywnKTtcclxuXHRcdFx0dmFyIHJlID0gL15cXHMqKFxcZCt8XFxkKlxcLlxcZCt8XFxkK1xcLlxcZCopXFxzKiQvO1xyXG5cdFx0XHR2YXIgbVIsIG1HLCBtQiwgbUE7XHJcblx0XHRcdGlmIChcclxuXHRcdFx0XHRwYXIubGVuZ3RoID49IDMgJiZcclxuXHRcdFx0XHQobVIgPSBwYXJbMF0ubWF0Y2gocmUpKSAmJlxyXG5cdFx0XHRcdChtRyA9IHBhclsxXS5tYXRjaChyZSkpICYmXHJcblx0XHRcdFx0KG1CID0gcGFyWzJdLm1hdGNoKHJlKSlcclxuXHRcdFx0KSB7XHJcblx0XHRcdFx0cmV0LmZvcm1hdCA9ICdyZ2InO1xyXG5cdFx0XHRcdHJldC5yZ2JhID0gW1xyXG5cdFx0XHRcdFx0cGFyc2VGbG9hdChtUlsxXSkgfHwgMCxcclxuXHRcdFx0XHRcdHBhcnNlRmxvYXQobUdbMV0pIHx8IDAsXHJcblx0XHRcdFx0XHRwYXJzZUZsb2F0KG1CWzFdKSB8fCAwLFxyXG5cdFx0XHRcdFx0bnVsbFxyXG5cdFx0XHRcdF07XHJcblxyXG5cdFx0XHRcdGlmIChcclxuXHRcdFx0XHRcdHBhci5sZW5ndGggPj0gNCAmJlxyXG5cdFx0XHRcdFx0KG1BID0gcGFyWzNdLm1hdGNoKHJlKSlcclxuXHRcdFx0XHQpIHtcclxuXHRcdFx0XHRcdHJldC5mb3JtYXQgPSAncmdiYSc7XHJcblx0XHRcdFx0XHRyZXQucmdiYVszXSA9IHBhcnNlRmxvYXQobUFbMV0pIHx8IDA7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHJldHVybiByZXQ7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gZmFsc2U7XHJcblx0fSxcclxuXHJcblxyXG5cdHBhcnNlUGFsZXR0ZVZhbHVlIDogZnVuY3Rpb24gKG1peGVkKSB7XHJcblx0XHR2YXIgdmFscyA9IFtdO1xyXG5cclxuXHRcdGlmICh0eXBlb2YgbWl4ZWQgPT09ICdzdHJpbmcnKSB7IC8vIGlucHV0IGlzIGEgc3RyaW5nIG9mIHNwYWNlIHNlcGFyYXRlZCBjb2xvciB2YWx1ZXNcclxuXHRcdFx0Ly8gcmdiKCkgYW5kIHJnYmEoKSBtYXkgY29udGFpbiBzcGFjZXMgdG9vLCBzbyBsZXQncyBmaW5kIGFsbCBjb2xvciB2YWx1ZXMgYnkgcmVnZXhcclxuXHRcdFx0bWl4ZWQucmVwbGFjZSgvI1swLTlBLUZdezN9XFxifCNbMC05QS1GXXs2fShbMC05QS1GXXsyfSk/XFxifHJnYmE/XFwoKFteKV0qKVxcKS9pZywgZnVuY3Rpb24gKHZhbCkge1xyXG5cdFx0XHRcdHZhbHMucHVzaCh2YWwpO1xyXG5cdFx0XHR9KTtcclxuXHRcdH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShtaXhlZCkpIHsgLy8gaW5wdXQgaXMgYW4gYXJyYXkgb2YgY29sb3IgdmFsdWVzXHJcblx0XHRcdHZhbHMgPSBtaXhlZDtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBjb252ZXJ0IGFsbCB2YWx1ZXMgaW50byB1bmlmb3JtIGNvbG9yIGZvcm1hdFxyXG5cclxuXHRcdHZhciBjb2xvcnMgPSBbXTtcclxuXHJcblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHZhbHMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0dmFyIGNvbG9yID0ganNjLnBhcnNlQ29sb3JTdHJpbmcodmFsc1tpXSk7XHJcblx0XHRcdGlmIChjb2xvcikge1xyXG5cdFx0XHRcdGNvbG9ycy5wdXNoKGNvbG9yKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiBjb2xvcnM7XHJcblx0fSxcclxuXHJcblxyXG5cdGNvbnRhaW5zVHJhbnBhcmVudENvbG9yIDogZnVuY3Rpb24gKGNvbG9ycykge1xyXG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBjb2xvcnMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0dmFyIGEgPSBjb2xvcnNbaV0ucmdiYVszXTtcclxuXHRcdFx0aWYgKGEgIT09IG51bGwgJiYgYSA8IDEuMCkge1xyXG5cdFx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gZmFsc2U7XHJcblx0fSxcclxuXHJcblxyXG5cdGlzQWxwaGFGb3JtYXQgOiBmdW5jdGlvbiAoZm9ybWF0KSB7XHJcblx0XHRzd2l0Y2ggKGZvcm1hdC50b0xvd2VyQ2FzZSgpKSB7XHJcblx0XHRjYXNlICdoZXhhJzpcclxuXHRcdGNhc2UgJ3JnYmEnOlxyXG5cdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdH1cclxuXHRcdHJldHVybiBmYWxzZTtcclxuXHR9LFxyXG5cclxuXHJcblx0Ly8gQ2FudmFzIHNjYWxpbmcgZm9yIHJldGluYSBkaXNwbGF5c1xyXG5cdC8vXHJcblx0Ly8gYWRhcHRlZCBmcm9tIGh0dHBzOi8vd3d3Lmh0bWw1cm9ja3MuY29tL2VuL3R1dG9yaWFscy9jYW52YXMvaGlkcGkvXHJcblx0Ly9cclxuXHRzY2FsZUNhbnZhc0ZvckhpZ2hEUFIgOiBmdW5jdGlvbiAoY2FudmFzKSB7XHJcblx0XHR2YXIgZHByID0gd2luZG93LmRldmljZVBpeGVsUmF0aW8gfHwgMTtcclxuXHRcdGNhbnZhcy53aWR0aCAqPSBkcHI7XHJcblx0XHRjYW52YXMuaGVpZ2h0ICo9IGRwcjtcclxuXHRcdHZhciBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcclxuXHRcdGN0eC5zY2FsZShkcHIsIGRwcik7XHJcblx0fSxcclxuXHJcblxyXG5cdGdlbkNvbG9yUHJldmlld0NhbnZhcyA6IGZ1bmN0aW9uIChjb2xvciwgc2VwYXJhdG9yUG9zLCBzcGVjV2lkdGgsIHNjYWxlRm9ySGlnaERQUikge1xyXG5cclxuXHRcdHZhciBzZXBXID0gTWF0aC5yb3VuZChqc2MucHViLnByZXZpZXdTZXBhcmF0b3IubGVuZ3RoKTtcclxuXHRcdHZhciBzcVNpemUgPSBqc2MucHViLmNoZXNzYm9hcmRTaXplO1xyXG5cdFx0dmFyIHNxQ29sb3IxID0ganNjLnB1Yi5jaGVzc2JvYXJkQ29sb3IxO1xyXG5cdFx0dmFyIHNxQ29sb3IyID0ganNjLnB1Yi5jaGVzc2JvYXJkQ29sb3IyO1xyXG5cclxuXHRcdHZhciBjV2lkdGggPSBzcGVjV2lkdGggPyBzcGVjV2lkdGggOiBzcVNpemUgKiAyO1xyXG5cdFx0dmFyIGNIZWlnaHQgPSBzcVNpemUgKiAyO1xyXG5cclxuXHRcdHZhciBjYW52YXMgPSBqc2MuY3JlYXRlRWwoJ2NhbnZhcycpO1xyXG5cdFx0dmFyIGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xyXG5cclxuXHRcdGNhbnZhcy53aWR0aCA9IGNXaWR0aDtcclxuXHRcdGNhbnZhcy5oZWlnaHQgPSBjSGVpZ2h0O1xyXG5cdFx0aWYgKHNjYWxlRm9ySGlnaERQUikge1xyXG5cdFx0XHRqc2Muc2NhbGVDYW52YXNGb3JIaWdoRFBSKGNhbnZhcyk7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gdHJhbnNwYXJlbmN5IGNoZXNzYm9hcmQgLSBiYWNrZ3JvdW5kXHJcblx0XHRjdHguZmlsbFN0eWxlID0gc3FDb2xvcjE7XHJcblx0XHRjdHguZmlsbFJlY3QoMCwgMCwgY1dpZHRoLCBjSGVpZ2h0KTtcclxuXHJcblx0XHQvLyB0cmFuc3BhcmVuY3kgY2hlc3Nib2FyZCAtIHNxdWFyZXNcclxuXHRcdGN0eC5maWxsU3R5bGUgPSBzcUNvbG9yMjtcclxuXHRcdGZvciAodmFyIHggPSAwOyB4IDwgY1dpZHRoOyB4ICs9IHNxU2l6ZSAqIDIpIHtcclxuXHRcdFx0Y3R4LmZpbGxSZWN0KHgsIDAsIHNxU2l6ZSwgc3FTaXplKTtcclxuXHRcdFx0Y3R4LmZpbGxSZWN0KHggKyBzcVNpemUsIHNxU2l6ZSwgc3FTaXplLCBzcVNpemUpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmIChjb2xvcikge1xyXG5cdFx0XHQvLyBhY3R1YWwgY29sb3IgaW4gZm9yZWdyb3VuZFxyXG5cdFx0XHRjdHguZmlsbFN0eWxlID0gY29sb3I7XHJcblx0XHRcdGN0eC5maWxsUmVjdCgwLCAwLCBjV2lkdGgsIGNIZWlnaHQpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHZhciBzdGFydCA9IG51bGw7XHJcblx0XHRzd2l0Y2ggKHNlcGFyYXRvclBvcykge1xyXG5cdFx0XHRjYXNlICdsZWZ0JzpcclxuXHRcdFx0XHRzdGFydCA9IDA7XHJcblx0XHRcdFx0Y3R4LmNsZWFyUmVjdCgwLCAwLCBzZXBXLzIsIGNIZWlnaHQpO1xyXG5cdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRjYXNlICdyaWdodCc6XHJcblx0XHRcdFx0c3RhcnQgPSBjV2lkdGggLSBzZXBXO1xyXG5cdFx0XHRcdGN0eC5jbGVhclJlY3QoY1dpZHRoIC0gKHNlcFcvMiksIDAsIHNlcFcvMiwgY0hlaWdodCk7XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHR9XHJcblx0XHRpZiAoc3RhcnQgIT09IG51bGwpIHtcclxuXHRcdFx0Y3R4LmxpbmVXaWR0aCA9IDE7XHJcblx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwganNjLnB1Yi5wcmV2aWV3U2VwYXJhdG9yLmxlbmd0aDsgaSArPSAxKSB7XHJcblx0XHRcdFx0Y3R4LmJlZ2luUGF0aCgpO1xyXG5cdFx0XHRcdGN0eC5zdHJva2VTdHlsZSA9IGpzYy5wdWIucHJldmlld1NlcGFyYXRvcltpXTtcclxuXHRcdFx0XHRjdHgubW92ZVRvKDAuNSArIHN0YXJ0ICsgaSwgMCk7XHJcblx0XHRcdFx0Y3R4LmxpbmVUbygwLjUgKyBzdGFydCArIGksIGNIZWlnaHQpO1xyXG5cdFx0XHRcdGN0eC5zdHJva2UoKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB7XHJcblx0XHRcdGNhbnZhczogY2FudmFzLFxyXG5cdFx0XHR3aWR0aDogY1dpZHRoLFxyXG5cdFx0XHRoZWlnaHQ6IGNIZWlnaHQsXHJcblx0XHR9O1xyXG5cdH0sXHJcblxyXG5cclxuXHQvLyBpZiBwb3NpdGlvbiBvciB3aWR0aCBpcyBub3Qgc2V0ID0+IGZpbGwgdGhlIGVudGlyZSBlbGVtZW50ICgwJS0xMDAlKVxyXG5cdGdlbkNvbG9yUHJldmlld0dyYWRpZW50IDogZnVuY3Rpb24gKGNvbG9yLCBwb3NpdGlvbiwgd2lkdGgpIHtcclxuXHRcdHZhciBwYXJhbXMgPSBbXTtcclxuXHJcblx0XHRpZiAocG9zaXRpb24gJiYgd2lkdGgpIHtcclxuXHRcdFx0cGFyYW1zID0gW1xyXG5cdFx0XHRcdCd0byAnICsgeydsZWZ0JzoncmlnaHQnLCAncmlnaHQnOidsZWZ0J31bcG9zaXRpb25dLFxyXG5cdFx0XHRcdGNvbG9yICsgJyAwJScsXHJcblx0XHRcdFx0Y29sb3IgKyAnICcgKyB3aWR0aCArICdweCcsXHJcblx0XHRcdFx0J3JnYmEoMCwwLDAsMCkgJyArICh3aWR0aCArIDEpICsgJ3B4JyxcclxuXHRcdFx0XHQncmdiYSgwLDAsMCwwKSAxMDAlJyxcclxuXHRcdFx0XTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHBhcmFtcyA9IFtcclxuXHRcdFx0XHQndG8gcmlnaHQnLFxyXG5cdFx0XHRcdGNvbG9yICsgJyAwJScsXHJcblx0XHRcdFx0Y29sb3IgKyAnIDEwMCUnLFxyXG5cdFx0XHRdO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiBqc2MubGluZWFyR3JhZGllbnQuYXBwbHkodGhpcywgcGFyYW1zKTtcclxuXHR9LFxyXG5cclxuXHJcblx0cmVkcmF3UG9zaXRpb24gOiBmdW5jdGlvbiAoKSB7XHJcblxyXG5cdFx0aWYgKCFqc2MucGlja2VyIHx8ICFqc2MucGlja2VyLm93bmVyKSB7XHJcblx0XHRcdHJldHVybjsgLy8gcGlja2VyIGlzIG5vdCBzaG93blxyXG5cdFx0fVxyXG5cclxuXHRcdHZhciB0aGlzT2JqID0ganNjLnBpY2tlci5vd25lcjtcclxuXHJcblx0XHRpZiAodGhpc09iai5jb250YWluZXIgIT09IHdpbmRvdy5kb2N1bWVudC5ib2R5KSB7XHJcblxyXG5cdFx0XHRqc2MuX2RyYXdQb3NpdGlvbih0aGlzT2JqLCAwLCAwLCAncmVsYXRpdmUnLCBmYWxzZSk7XHJcblxyXG5cdFx0fSBlbHNlIHtcclxuXHJcblx0XHRcdHZhciB0cCwgdnA7XHJcblxyXG5cdFx0XHRpZiAodGhpc09iai5maXhlZCkge1xyXG5cdFx0XHRcdC8vIEZpeGVkIGVsZW1lbnRzIGFyZSBwb3NpdGlvbmVkIHJlbGF0aXZlIHRvIHZpZXdwb3J0LFxyXG5cdFx0XHRcdC8vIHRoZXJlZm9yZSB3ZSBjYW4gaWdub3JlIHRoZSBzY3JvbGwgb2Zmc2V0XHJcblx0XHRcdFx0dHAgPSBqc2MuZ2V0RWxlbWVudFBvcyh0aGlzT2JqLnRhcmdldEVsZW1lbnQsIHRydWUpOyAvLyB0YXJnZXQgcG9zXHJcblx0XHRcdFx0dnAgPSBbMCwgMF07IC8vIHZpZXcgcG9zXHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0dHAgPSBqc2MuZ2V0RWxlbWVudFBvcyh0aGlzT2JqLnRhcmdldEVsZW1lbnQpOyAvLyB0YXJnZXQgcG9zXHJcblx0XHRcdFx0dnAgPSBqc2MuZ2V0Vmlld1BvcygpOyAvLyB2aWV3IHBvc1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR2YXIgdHMgPSBqc2MuZ2V0RWxlbWVudFNpemUodGhpc09iai50YXJnZXRFbGVtZW50KTsgLy8gdGFyZ2V0IHNpemVcclxuXHRcdFx0dmFyIHZzID0ganNjLmdldFZpZXdTaXplKCk7IC8vIHZpZXcgc2l6ZVxyXG5cdFx0XHR2YXIgcGQgPSBqc2MuZ2V0UGlja2VyRGltcyh0aGlzT2JqKTtcclxuXHRcdFx0dmFyIHBzID0gW3BkLmJvcmRlclcsIHBkLmJvcmRlckhdOyAvLyBwaWNrZXIgb3V0ZXIgc2l6ZVxyXG5cdFx0XHR2YXIgYSwgYiwgYztcclxuXHRcdFx0c3dpdGNoICh0aGlzT2JqLnBvc2l0aW9uLnRvTG93ZXJDYXNlKCkpIHtcclxuXHRcdFx0XHRjYXNlICdsZWZ0JzogYT0xOyBiPTA7IGM9LTE7IGJyZWFrO1xyXG5cdFx0XHRcdGNhc2UgJ3JpZ2h0JzphPTE7IGI9MDsgYz0xOyBicmVhaztcclxuXHRcdFx0XHRjYXNlICd0b3AnOiAgYT0wOyBiPTE7IGM9LTE7IGJyZWFrO1xyXG5cdFx0XHRcdGRlZmF1bHQ6ICAgICBhPTA7IGI9MTsgYz0xOyBicmVhaztcclxuXHRcdFx0fVxyXG5cdFx0XHR2YXIgbCA9ICh0c1tiXStwc1tiXSkvMjtcclxuXHJcblx0XHRcdC8vIGNvbXB1dGUgcGlja2VyIHBvc2l0aW9uXHJcblx0XHRcdGlmICghdGhpc09iai5zbWFydFBvc2l0aW9uKSB7XHJcblx0XHRcdFx0dmFyIHBwID0gW1xyXG5cdFx0XHRcdFx0dHBbYV0sXHJcblx0XHRcdFx0XHR0cFtiXSt0c1tiXS1sK2wqY1xyXG5cdFx0XHRcdF07XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0dmFyIHBwID0gW1xyXG5cdFx0XHRcdFx0LXZwW2FdK3RwW2FdK3BzW2FdID4gdnNbYV0gP1xyXG5cdFx0XHRcdFx0XHQoLXZwW2FdK3RwW2FdK3RzW2FdLzIgPiB2c1thXS8yICYmIHRwW2FdK3RzW2FdLXBzW2FdID49IDAgPyB0cFthXSt0c1thXS1wc1thXSA6IHRwW2FdKSA6XHJcblx0XHRcdFx0XHRcdHRwW2FdLFxyXG5cdFx0XHRcdFx0LXZwW2JdK3RwW2JdK3RzW2JdK3BzW2JdLWwrbCpjID4gdnNbYl0gP1xyXG5cdFx0XHRcdFx0XHQoLXZwW2JdK3RwW2JdK3RzW2JdLzIgPiB2c1tiXS8yICYmIHRwW2JdK3RzW2JdLWwtbCpjID49IDAgPyB0cFtiXSt0c1tiXS1sLWwqYyA6IHRwW2JdK3RzW2JdLWwrbCpjKSA6XHJcblx0XHRcdFx0XHRcdCh0cFtiXSt0c1tiXS1sK2wqYyA+PSAwID8gdHBbYl0rdHNbYl0tbCtsKmMgOiB0cFtiXSt0c1tiXS1sLWwqYylcclxuXHRcdFx0XHRdO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR2YXIgeCA9IHBwW2FdO1xyXG5cdFx0XHR2YXIgeSA9IHBwW2JdO1xyXG5cdFx0XHR2YXIgcG9zaXRpb25WYWx1ZSA9IHRoaXNPYmouZml4ZWQgPyAnZml4ZWQnIDogJ2Fic29sdXRlJztcclxuXHRcdFx0dmFyIGNvbnRyYWN0U2hhZG93ID1cclxuXHRcdFx0XHQocHBbMF0gKyBwc1swXSA+IHRwWzBdIHx8IHBwWzBdIDwgdHBbMF0gKyB0c1swXSkgJiZcclxuXHRcdFx0XHQocHBbMV0gKyBwc1sxXSA8IHRwWzFdICsgdHNbMV0pO1xyXG5cclxuXHRcdFx0anNjLl9kcmF3UG9zaXRpb24odGhpc09iaiwgeCwgeSwgcG9zaXRpb25WYWx1ZSwgY29udHJhY3RTaGFkb3cpO1xyXG5cclxuXHRcdH1cclxuXHJcblx0fSxcclxuXHJcblxyXG5cdF9kcmF3UG9zaXRpb24gOiBmdW5jdGlvbiAodGhpc09iaiwgeCwgeSwgcG9zaXRpb25WYWx1ZSwgY29udHJhY3RTaGFkb3cpIHtcclxuXHRcdHZhciB2U2hhZG93ID0gY29udHJhY3RTaGFkb3cgPyAwIDogdGhpc09iai5zaGFkb3dCbHVyOyAvLyBweFxyXG5cclxuXHRcdGpzYy5waWNrZXIud3JhcC5zdHlsZS5wb3NpdGlvbiA9IHBvc2l0aW9uVmFsdWU7XHJcblxyXG5cdFx0aWYgKCAvLyBUbyBhdm9pZCB1bm5lY2Vzc2FyeSByZXBvc2l0aW9uaW5nIGR1cmluZyBzY3JvbGxcclxuXHRcdFx0TWF0aC5yb3VuZChwYXJzZUZsb2F0KGpzYy5waWNrZXIud3JhcC5zdHlsZS5sZWZ0KSkgIT09IE1hdGgucm91bmQoeCkgfHxcclxuXHRcdFx0TWF0aC5yb3VuZChwYXJzZUZsb2F0KGpzYy5waWNrZXIud3JhcC5zdHlsZS50b3ApKSAhPT0gTWF0aC5yb3VuZCh5KVxyXG5cdFx0KSB7XHJcblx0XHRcdGpzYy5waWNrZXIud3JhcC5zdHlsZS5sZWZ0ID0geCArICdweCc7XHJcblx0XHRcdGpzYy5waWNrZXIud3JhcC5zdHlsZS50b3AgPSB5ICsgJ3B4JztcclxuXHRcdH1cclxuXHJcblx0XHRqc2Muc2V0Qm94U2hhZG93KFxyXG5cdFx0XHRqc2MucGlja2VyLmJveFMsXHJcblx0XHRcdHRoaXNPYmouc2hhZG93ID9cclxuXHRcdFx0XHRuZXcganNjLkJveFNoYWRvdygwLCB2U2hhZG93LCB0aGlzT2JqLnNoYWRvd0JsdXIsIDAsIHRoaXNPYmouc2hhZG93Q29sb3IpIDpcclxuXHRcdFx0XHRudWxsKTtcclxuXHR9LFxyXG5cclxuXHJcblx0Z2V0UGlja2VyRGltcyA6IGZ1bmN0aW9uICh0aGlzT2JqKSB7XHJcblx0XHR2YXIgdyA9IDIgKiB0aGlzT2JqLmNvbnRyb2xCb3JkZXJXaWR0aCArIHRoaXNPYmoud2lkdGg7XHJcblx0XHR2YXIgaCA9IDIgKiB0aGlzT2JqLmNvbnRyb2xCb3JkZXJXaWR0aCArIHRoaXNPYmouaGVpZ2h0O1xyXG5cclxuXHRcdHZhciBzbGlkZXJTcGFjZSA9IDIgKiB0aGlzT2JqLmNvbnRyb2xCb3JkZXJXaWR0aCArIDIgKiBqc2MuZ2V0Q29udHJvbFBhZGRpbmcodGhpc09iaikgKyB0aGlzT2JqLnNsaWRlclNpemU7XHJcblxyXG5cdFx0aWYgKGpzYy5nZXRTbGlkZXJDaGFubmVsKHRoaXNPYmopKSB7XHJcblx0XHRcdHcgKz0gc2xpZGVyU3BhY2U7XHJcblx0XHR9XHJcblx0XHRpZiAodGhpc09iai5oYXNBbHBoYUNoYW5uZWwoKSkge1xyXG5cdFx0XHR3ICs9IHNsaWRlclNwYWNlO1xyXG5cdFx0fVxyXG5cclxuXHRcdHZhciBwYWwgPSBqc2MuZ2V0UGFsZXR0ZURpbXModGhpc09iaiwgdyk7XHJcblxyXG5cdFx0aWYgKHBhbC5oZWlnaHQpIHtcclxuXHRcdFx0aCArPSBwYWwuaGVpZ2h0ICsgdGhpc09iai5wYWRkaW5nO1xyXG5cdFx0fVxyXG5cdFx0aWYgKHRoaXNPYmouY2xvc2VCdXR0b24pIHtcclxuXHRcdFx0aCArPSAyICogdGhpc09iai5jb250cm9sQm9yZGVyV2lkdGggKyB0aGlzT2JqLnBhZGRpbmcgKyB0aGlzT2JqLmJ1dHRvbkhlaWdodDtcclxuXHRcdH1cclxuXHJcblx0XHR2YXIgcFcgPSB3ICsgKDIgKiB0aGlzT2JqLnBhZGRpbmcpO1xyXG5cdFx0dmFyIHBIID0gaCArICgyICogdGhpc09iai5wYWRkaW5nKTtcclxuXHJcblx0XHRyZXR1cm4ge1xyXG5cdFx0XHRjb250ZW50VzogdyxcclxuXHRcdFx0Y29udGVudEg6IGgsXHJcblx0XHRcdHBhZGRlZFc6IHBXLFxyXG5cdFx0XHRwYWRkZWRIOiBwSCxcclxuXHRcdFx0Ym9yZGVyVzogcFcgKyAoMiAqIHRoaXNPYmouYm9yZGVyV2lkdGgpLFxyXG5cdFx0XHRib3JkZXJIOiBwSCArICgyICogdGhpc09iai5ib3JkZXJXaWR0aCksXHJcblx0XHRcdHBhbGV0dGU6IHBhbCxcclxuXHRcdH07XHJcblx0fSxcclxuXHJcblxyXG5cdGdldFBhbGV0dGVEaW1zIDogZnVuY3Rpb24gKHRoaXNPYmosIHdpZHRoKSB7XHJcblx0XHR2YXIgY29scyA9IDAsIHJvd3MgPSAwLCBjZWxsVyA9IDAsIGNlbGxIID0gMCwgaGVpZ2h0ID0gMDtcclxuXHRcdHZhciBzYW1wbGVDb3VudCA9IHRoaXNPYmouX3BhbGV0dGUgPyB0aGlzT2JqLl9wYWxldHRlLmxlbmd0aCA6IDA7XHJcblxyXG5cdFx0aWYgKHNhbXBsZUNvdW50KSB7XHJcblx0XHRcdGNvbHMgPSB0aGlzT2JqLnBhbGV0dGVDb2xzO1xyXG5cdFx0XHRyb3dzID0gY29scyA+IDAgPyBNYXRoLmNlaWwoc2FtcGxlQ291bnQgLyBjb2xzKSA6IDA7XHJcblxyXG5cdFx0XHQvLyBjb2xvciBzYW1wbGUncyBkaW1lbnNpb25zIChpbmNsdWRlcyBib3JkZXIpXHJcblx0XHRcdGNlbGxXID0gTWF0aC5tYXgoMSwgTWF0aC5mbG9vcigod2lkdGggLSAoKGNvbHMgLSAxKSAqIHRoaXNPYmoucGFsZXR0ZVNwYWNpbmcpKSAvIGNvbHMpKTtcclxuXHRcdFx0Y2VsbEggPSB0aGlzT2JqLnBhbGV0dGVIZWlnaHQgPyBNYXRoLm1pbih0aGlzT2JqLnBhbGV0dGVIZWlnaHQsIGNlbGxXKSA6IGNlbGxXO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmIChyb3dzKSB7XHJcblx0XHRcdGhlaWdodCA9XHJcblx0XHRcdFx0cm93cyAqIGNlbGxIICtcclxuXHRcdFx0XHQocm93cyAtIDEpICogdGhpc09iai5wYWxldHRlU3BhY2luZztcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4ge1xyXG5cdFx0XHRjb2xzOiBjb2xzLFxyXG5cdFx0XHRyb3dzOiByb3dzLFxyXG5cdFx0XHRjZWxsVzogY2VsbFcsXHJcblx0XHRcdGNlbGxIOiBjZWxsSCxcclxuXHRcdFx0d2lkdGg6IHdpZHRoLFxyXG5cdFx0XHRoZWlnaHQ6IGhlaWdodCxcclxuXHRcdH07XHJcblx0fSxcclxuXHJcblxyXG5cdGdldENvbnRyb2xQYWRkaW5nIDogZnVuY3Rpb24gKHRoaXNPYmopIHtcclxuXHRcdHJldHVybiBNYXRoLm1heChcclxuXHRcdFx0dGhpc09iai5wYWRkaW5nIC8gMixcclxuXHRcdFx0KDIgKiB0aGlzT2JqLnBvaW50ZXJCb3JkZXJXaWR0aCArIHRoaXNPYmoucG9pbnRlclRoaWNrbmVzcykgLSB0aGlzT2JqLmNvbnRyb2xCb3JkZXJXaWR0aFxyXG5cdFx0KTtcclxuXHR9LFxyXG5cclxuXHJcblx0Z2V0UGFkWUNoYW5uZWwgOiBmdW5jdGlvbiAodGhpc09iaikge1xyXG5cdFx0c3dpdGNoICh0aGlzT2JqLm1vZGUuY2hhckF0KDEpLnRvTG93ZXJDYXNlKCkpIHtcclxuXHRcdFx0Y2FzZSAndic6IHJldHVybiAndic7IGJyZWFrO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuICdzJztcclxuXHR9LFxyXG5cclxuXHJcblx0Z2V0U2xpZGVyQ2hhbm5lbCA6IGZ1bmN0aW9uICh0aGlzT2JqKSB7XHJcblx0XHRpZiAodGhpc09iai5tb2RlLmxlbmd0aCA+IDIpIHtcclxuXHRcdFx0c3dpdGNoICh0aGlzT2JqLm1vZGUuY2hhckF0KDIpLnRvTG93ZXJDYXNlKCkpIHtcclxuXHRcdFx0XHRjYXNlICdzJzogcmV0dXJuICdzJzsgYnJlYWs7XHJcblx0XHRcdFx0Y2FzZSAndic6IHJldHVybiAndic7IGJyZWFrO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gbnVsbDtcclxuXHR9LFxyXG5cclxuXHJcblx0Ly8gY2FsbHMgZnVuY3Rpb24gc3BlY2lmaWVkIGluIHBpY2tlcidzIHByb3BlcnR5XHJcblx0dHJpZ2dlckNhbGxiYWNrIDogZnVuY3Rpb24gKHRoaXNPYmosIHByb3ApIHtcclxuXHRcdGlmICghdGhpc09ialtwcm9wXSkge1xyXG5cdFx0XHRyZXR1cm47IC8vIGNhbGxiYWNrIGZ1bmMgbm90IHNwZWNpZmllZFxyXG5cdFx0fVxyXG5cdFx0dmFyIGNhbGxiYWNrID0gbnVsbDtcclxuXHJcblx0XHRpZiAodHlwZW9mIHRoaXNPYmpbcHJvcF0gPT09ICdzdHJpbmcnKSB7XHJcblx0XHRcdC8vIHN0cmluZyB3aXRoIGNvZGVcclxuXHRcdFx0dHJ5IHtcclxuXHRcdFx0XHRjYWxsYmFjayA9IG5ldyBGdW5jdGlvbiAodGhpc09ialtwcm9wXSk7XHJcblx0XHRcdH0gY2F0Y2ggKGUpIHtcclxuXHRcdFx0XHRjb25zb2xlLmVycm9yKGUpO1xyXG5cdFx0XHR9XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHQvLyBmdW5jdGlvblxyXG5cdFx0XHRjYWxsYmFjayA9IHRoaXNPYmpbcHJvcF07XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKGNhbGxiYWNrKSB7XHJcblx0XHRcdGNhbGxiYWNrLmNhbGwodGhpc09iaik7XHJcblx0XHR9XHJcblx0fSxcclxuXHJcblxyXG5cdC8vIFRyaWdnZXJzIGEgY29sb3IgY2hhbmdlIHJlbGF0ZWQgZXZlbnQocykgb24gYWxsIHBpY2tlciBpbnN0YW5jZXMuXHJcblx0Ly8gSXQgaXMgcG9zc2libGUgdG8gc3BlY2lmeSBtdWx0aXBsZSBldmVudHMgc2VwYXJhdGVkIHdpdGggYSBzcGFjZS5cclxuXHR0cmlnZ2VyR2xvYmFsIDogZnVuY3Rpb24gKGV2ZW50TmFtZXMpIHtcclxuXHRcdHZhciBpbnN0ID0ganNjLmdldEluc3RhbmNlcygpO1xyXG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBpbnN0Lmxlbmd0aDsgaSArPSAxKSB7XHJcblx0XHRcdGluc3RbaV0udHJpZ2dlcihldmVudE5hbWVzKTtcclxuXHRcdH1cclxuXHR9LFxyXG5cclxuXHJcblx0X3BvaW50ZXJNb3ZlRXZlbnQgOiB7XHJcblx0XHRtb3VzZTogJ21vdXNlbW92ZScsXHJcblx0XHR0b3VjaDogJ3RvdWNobW92ZSdcclxuXHR9LFxyXG5cdF9wb2ludGVyRW5kRXZlbnQgOiB7XHJcblx0XHRtb3VzZTogJ21vdXNldXAnLFxyXG5cdFx0dG91Y2g6ICd0b3VjaGVuZCdcclxuXHR9LFxyXG5cclxuXHJcblx0X3BvaW50ZXJPcmlnaW4gOiBudWxsLFxyXG5cclxuXHJcblx0b25Eb2N1bWVudEtleVVwIDogZnVuY3Rpb24gKGUpIHtcclxuXHRcdGlmIChbJ1RhYicsICdFc2NhcGUnXS5pbmRleE9mKGpzYy5ldmVudEtleShlKSkgIT09IC0xKSB7XHJcblx0XHRcdGlmIChqc2MucGlja2VyICYmIGpzYy5waWNrZXIub3duZXIpIHtcclxuXHRcdFx0XHRqc2MucGlja2VyLm93bmVyLnRyeUhpZGUoKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH0sXHJcblxyXG5cclxuXHRvbldpbmRvd1Jlc2l6ZSA6IGZ1bmN0aW9uIChlKSB7XHJcblx0XHRqc2MucmVkcmF3UG9zaXRpb24oKTtcclxuXHR9LFxyXG5cclxuXHJcblx0b25XaW5kb3dTY3JvbGwgOiBmdW5jdGlvbiAoZSkge1xyXG5cdFx0anNjLnJlZHJhd1Bvc2l0aW9uKCk7XHJcblx0fSxcclxuXHJcblxyXG5cdG9uUGFyZW50U2Nyb2xsIDogZnVuY3Rpb24gKGUpIHtcclxuXHRcdC8vIGhpZGUgdGhlIHBpY2tlciB3aGVuIG9uZSBvZiB0aGUgcGFyZW50IGVsZW1lbnRzIGlzIHNjcm9sbGVkXHJcblx0XHRpZiAoanNjLnBpY2tlciAmJiBqc2MucGlja2VyLm93bmVyKSB7XHJcblx0XHRcdGpzYy5waWNrZXIub3duZXIudHJ5SGlkZSgpO1xyXG5cdFx0fVxyXG5cdH0sXHJcblxyXG5cclxuXHRvbkRvY3VtZW50TW91c2VEb3duIDogZnVuY3Rpb24gKGUpIHtcclxuXHRcdHZhciB0YXJnZXQgPSBlLnRhcmdldCB8fCBlLnNyY0VsZW1lbnQ7XHJcblxyXG5cdFx0aWYgKHRhcmdldC5qc2NvbG9yICYmIHRhcmdldC5qc2NvbG9yIGluc3RhbmNlb2YganNjLnB1YikgeyAvLyBjbGlja2VkIHRhcmdldEVsZW1lbnQgLT4gc2hvdyBwaWNrZXJcclxuXHRcdFx0aWYgKHRhcmdldC5qc2NvbG9yLnNob3dPbkNsaWNrICYmICF0YXJnZXQuZGlzYWJsZWQpIHtcclxuXHRcdFx0XHR0YXJnZXQuanNjb2xvci5zaG93KCk7XHJcblx0XHRcdH1cclxuXHRcdH0gZWxzZSBpZiAoanNjLmdldERhdGEodGFyZ2V0LCAnZ3VpJykpIHsgLy8gY2xpY2tlZCBqc2NvbG9yJ3MgR1VJIGVsZW1lbnRcclxuXHRcdFx0dmFyIGNvbnRyb2wgPSBqc2MuZ2V0RGF0YSh0YXJnZXQsICdjb250cm9sJyk7XHJcblx0XHRcdGlmIChjb250cm9sKSB7XHJcblx0XHRcdFx0Ly8ganNjb2xvcidzIGNvbnRyb2xcclxuXHRcdFx0XHRqc2Mub25Db250cm9sUG9pbnRlclN0YXJ0KGUsIHRhcmdldCwganNjLmdldERhdGEodGFyZ2V0LCAnY29udHJvbCcpLCAnbW91c2UnKTtcclxuXHRcdFx0fVxyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0Ly8gbW91c2UgaXMgb3V0c2lkZSB0aGUgcGlja2VyJ3MgY29udHJvbHMgLT4gaGlkZSB0aGUgY29sb3IgcGlja2VyIVxyXG5cdFx0XHRpZiAoanNjLnBpY2tlciAmJiBqc2MucGlja2VyLm93bmVyKSB7XHJcblx0XHRcdFx0anNjLnBpY2tlci5vd25lci50cnlIaWRlKCk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9LFxyXG5cclxuXHJcblx0b25QaWNrZXJUb3VjaFN0YXJ0IDogZnVuY3Rpb24gKGUpIHtcclxuXHRcdHZhciB0YXJnZXQgPSBlLnRhcmdldCB8fCBlLnNyY0VsZW1lbnQ7XHJcblxyXG5cdFx0aWYgKGpzYy5nZXREYXRhKHRhcmdldCwgJ2NvbnRyb2wnKSkge1xyXG5cdFx0XHRqc2Mub25Db250cm9sUG9pbnRlclN0YXJ0KGUsIHRhcmdldCwganNjLmdldERhdGEodGFyZ2V0LCAnY29udHJvbCcpLCAndG91Y2gnKTtcclxuXHRcdH1cclxuXHR9LFxyXG5cclxuXHJcblx0b25Db250cm9sUG9pbnRlclN0YXJ0IDogZnVuY3Rpb24gKGUsIHRhcmdldCwgY29udHJvbE5hbWUsIHBvaW50ZXJUeXBlKSB7XHJcblx0XHR2YXIgdGhpc09iaiA9IGpzYy5nZXREYXRhKHRhcmdldCwgJ2luc3RhbmNlJyk7XHJcblxyXG5cdFx0anNjLnByZXZlbnREZWZhdWx0KGUpO1xyXG5cclxuXHRcdHZhciByZWdpc3RlckRyYWdFdmVudHMgPSBmdW5jdGlvbiAoZG9jLCBvZmZzZXQpIHtcclxuXHRcdFx0anNjLmF0dGFjaEdyb3VwRXZlbnQoJ2RyYWcnLCBkb2MsIGpzYy5fcG9pbnRlck1vdmVFdmVudFtwb2ludGVyVHlwZV0sXHJcblx0XHRcdFx0anNjLm9uRG9jdW1lbnRQb2ludGVyTW92ZShlLCB0YXJnZXQsIGNvbnRyb2xOYW1lLCBwb2ludGVyVHlwZSwgb2Zmc2V0KSk7XHJcblx0XHRcdGpzYy5hdHRhY2hHcm91cEV2ZW50KCdkcmFnJywgZG9jLCBqc2MuX3BvaW50ZXJFbmRFdmVudFtwb2ludGVyVHlwZV0sXHJcblx0XHRcdFx0anNjLm9uRG9jdW1lbnRQb2ludGVyRW5kKGUsIHRhcmdldCwgY29udHJvbE5hbWUsIHBvaW50ZXJUeXBlKSk7XHJcblx0XHR9O1xyXG5cclxuXHRcdHJlZ2lzdGVyRHJhZ0V2ZW50cyh3aW5kb3cuZG9jdW1lbnQsIFswLCAwXSk7XHJcblxyXG5cdFx0aWYgKHdpbmRvdy5wYXJlbnQgJiYgd2luZG93LmZyYW1lRWxlbWVudCkge1xyXG5cdFx0XHR2YXIgcmVjdCA9IHdpbmRvdy5mcmFtZUVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcblx0XHRcdHZhciBvZnMgPSBbLXJlY3QubGVmdCwgLXJlY3QudG9wXTtcclxuXHRcdFx0cmVnaXN0ZXJEcmFnRXZlbnRzKHdpbmRvdy5wYXJlbnQud2luZG93LmRvY3VtZW50LCBvZnMpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHZhciBhYnMgPSBqc2MuZ2V0QWJzUG9pbnRlclBvcyhlKTtcclxuXHRcdHZhciByZWwgPSBqc2MuZ2V0UmVsUG9pbnRlclBvcyhlKTtcclxuXHRcdGpzYy5fcG9pbnRlck9yaWdpbiA9IHtcclxuXHRcdFx0eDogYWJzLnggLSByZWwueCxcclxuXHRcdFx0eTogYWJzLnkgLSByZWwueVxyXG5cdFx0fTtcclxuXHJcblx0XHRzd2l0Y2ggKGNvbnRyb2xOYW1lKSB7XHJcblx0XHRjYXNlICdwYWQnOlxyXG5cdFx0XHQvLyBpZiB0aGUgdmFsdWUgc2xpZGVyIGlzIGF0IHRoZSBib3R0b20sIG1vdmUgaXQgdXBcclxuXHRcdFx0aWYgKGpzYy5nZXRTbGlkZXJDaGFubmVsKHRoaXNPYmopID09PSAndicgJiYgdGhpc09iai5jaGFubmVscy52ID09PSAwKSB7XHJcblx0XHRcdFx0dGhpc09iai5mcm9tSFNWQShudWxsLCBudWxsLCAxMDAsIG51bGwpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGpzYy5zZXRQYWQodGhpc09iaiwgZSwgMCwgMCk7XHJcblx0XHRcdGJyZWFrO1xyXG5cclxuXHRcdGNhc2UgJ3NsZCc6XHJcblx0XHRcdGpzYy5zZXRTbGQodGhpc09iaiwgZSwgMCk7XHJcblx0XHRcdGJyZWFrO1xyXG5cclxuXHRcdGNhc2UgJ2FzbGQnOlxyXG5cdFx0XHRqc2Muc2V0QVNsZCh0aGlzT2JqLCBlLCAwKTtcclxuXHRcdFx0YnJlYWs7XHJcblx0XHR9XHJcblx0XHR0aGlzT2JqLnRyaWdnZXIoJ2lucHV0Jyk7XHJcblx0fSxcclxuXHJcblxyXG5cdG9uRG9jdW1lbnRQb2ludGVyTW92ZSA6IGZ1bmN0aW9uIChlLCB0YXJnZXQsIGNvbnRyb2xOYW1lLCBwb2ludGVyVHlwZSwgb2Zmc2V0KSB7XHJcblx0XHRyZXR1cm4gZnVuY3Rpb24gKGUpIHtcclxuXHRcdFx0dmFyIHRoaXNPYmogPSBqc2MuZ2V0RGF0YSh0YXJnZXQsICdpbnN0YW5jZScpO1xyXG5cdFx0XHRzd2l0Y2ggKGNvbnRyb2xOYW1lKSB7XHJcblx0XHRcdGNhc2UgJ3BhZCc6XHJcblx0XHRcdFx0anNjLnNldFBhZCh0aGlzT2JqLCBlLCBvZmZzZXRbMF0sIG9mZnNldFsxXSk7XHJcblx0XHRcdFx0YnJlYWs7XHJcblxyXG5cdFx0XHRjYXNlICdzbGQnOlxyXG5cdFx0XHRcdGpzYy5zZXRTbGQodGhpc09iaiwgZSwgb2Zmc2V0WzFdKTtcclxuXHRcdFx0XHRicmVhaztcclxuXHJcblx0XHRcdGNhc2UgJ2FzbGQnOlxyXG5cdFx0XHRcdGpzYy5zZXRBU2xkKHRoaXNPYmosIGUsIG9mZnNldFsxXSk7XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdH1cclxuXHRcdFx0dGhpc09iai50cmlnZ2VyKCdpbnB1dCcpO1xyXG5cdFx0fVxyXG5cdH0sXHJcblxyXG5cclxuXHRvbkRvY3VtZW50UG9pbnRlckVuZCA6IGZ1bmN0aW9uIChlLCB0YXJnZXQsIGNvbnRyb2xOYW1lLCBwb2ludGVyVHlwZSkge1xyXG5cdFx0cmV0dXJuIGZ1bmN0aW9uIChlKSB7XHJcblx0XHRcdHZhciB0aGlzT2JqID0ganNjLmdldERhdGEodGFyZ2V0LCAnaW5zdGFuY2UnKTtcclxuXHRcdFx0anNjLmRldGFjaEdyb3VwRXZlbnRzKCdkcmFnJyk7XHJcblxyXG5cdFx0XHQvLyBBbHdheXMgdHJpZ2dlciBjaGFuZ2VzIEFGVEVSIGRldGFjaGluZyBvdXRzdGFuZGluZyBtb3VzZSBoYW5kbGVycyxcclxuXHRcdFx0Ly8gaW4gY2FzZSBzb21lIGNvbG9yIGNoYW5nZSB0aGF0IG9jY3VyZWQgaW4gdXNlci1kZWZpbmVkIG9uQ2hhbmdlL29uSW5wdXQgaGFuZGxlclxyXG5cdFx0XHQvLyBpbnRydWRlZCBpbnRvIGN1cnJlbnQgbW91c2UgZXZlbnRzXHJcblx0XHRcdHRoaXNPYmoudHJpZ2dlcignaW5wdXQnKTtcclxuXHRcdFx0dGhpc09iai50cmlnZ2VyKCdjaGFuZ2UnKTtcclxuXHRcdH07XHJcblx0fSxcclxuXHJcblxyXG5cdG9uUGFsZXR0ZVNhbXBsZUNsaWNrIDogZnVuY3Rpb24gKGUpIHtcclxuXHRcdHZhciB0YXJnZXQgPSBlLmN1cnJlbnRUYXJnZXQ7XHJcblx0XHR2YXIgdGhpc09iaiA9IGpzYy5nZXREYXRhKHRhcmdldCwgJ2luc3RhbmNlJyk7XHJcblx0XHR2YXIgY29sb3IgPSBqc2MuZ2V0RGF0YSh0YXJnZXQsICdjb2xvcicpO1xyXG5cclxuXHRcdC8vIHdoZW4gZm9ybWF0IGlzIGZsZXhpYmxlLCB1c2UgdGhlIG9yaWdpbmFsIGZvcm1hdCBvZiB0aGlzIGNvbG9yIHNhbXBsZVxyXG5cdFx0aWYgKHRoaXNPYmouZm9ybWF0LnRvTG93ZXJDYXNlKCkgPT09ICdhbnknKSB7XHJcblx0XHRcdHRoaXNPYmouX3NldEZvcm1hdChjb2xvci5mb3JtYXQpOyAvLyBhZGFwdCBmb3JtYXRcclxuXHRcdFx0aWYgKCFqc2MuaXNBbHBoYUZvcm1hdCh0aGlzT2JqLmdldEZvcm1hdCgpKSkge1xyXG5cdFx0XHRcdGNvbG9yLnJnYmFbM10gPSAxLjA7IC8vIHdoZW4gc3dpdGNoaW5nIHRvIGEgZm9ybWF0IHRoYXQgZG9lc24ndCBzdXBwb3J0IGFscGhhLCBzZXQgZnVsbCBvcGFjaXR5XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHQvLyBpZiB0aGlzIGNvbG9yIGRvZXNuJ3Qgc3BlY2lmeSBhbHBoYSwgdXNlIGFscGhhIG9mIDEuMCAoaWYgYXBwbGljYWJsZSlcclxuXHRcdGlmIChjb2xvci5yZ2JhWzNdID09PSBudWxsKSB7XHJcblx0XHRcdGlmICh0aGlzT2JqLnBhbGV0dGVTZXRzQWxwaGEgPT09IHRydWUgfHwgKHRoaXNPYmoucGFsZXR0ZVNldHNBbHBoYSA9PT0gJ2F1dG8nICYmIHRoaXNPYmouX3BhbGV0dGVIYXNUcmFuc3BhcmVuY3kpKSB7XHJcblx0XHRcdFx0Y29sb3IucmdiYVszXSA9IDEuMDtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXNPYmouZnJvbVJHQkEuYXBwbHkodGhpc09iaiwgY29sb3IucmdiYSk7XHJcblxyXG5cdFx0dGhpc09iai50cmlnZ2VyKCdpbnB1dCcpO1xyXG5cdFx0dGhpc09iai50cmlnZ2VyKCdjaGFuZ2UnKTtcclxuXHJcblx0XHRpZiAodGhpc09iai5oaWRlT25QYWxldHRlQ2xpY2spIHtcclxuXHRcdFx0dGhpc09iai5oaWRlKCk7XHJcblx0XHR9XHJcblx0fSxcclxuXHJcblxyXG5cdHNldFBhZCA6IGZ1bmN0aW9uICh0aGlzT2JqLCBlLCBvZnNYLCBvZnNZKSB7XHJcblx0XHR2YXIgcG9pbnRlckFicyA9IGpzYy5nZXRBYnNQb2ludGVyUG9zKGUpO1xyXG5cdFx0dmFyIHggPSBvZnNYICsgcG9pbnRlckFicy54IC0ganNjLl9wb2ludGVyT3JpZ2luLnggLSB0aGlzT2JqLnBhZGRpbmcgLSB0aGlzT2JqLmNvbnRyb2xCb3JkZXJXaWR0aDtcclxuXHRcdHZhciB5ID0gb2ZzWSArIHBvaW50ZXJBYnMueSAtIGpzYy5fcG9pbnRlck9yaWdpbi55IC0gdGhpc09iai5wYWRkaW5nIC0gdGhpc09iai5jb250cm9sQm9yZGVyV2lkdGg7XHJcblxyXG5cdFx0dmFyIHhWYWwgPSB4ICogKDM2MCAvICh0aGlzT2JqLndpZHRoIC0gMSkpO1xyXG5cdFx0dmFyIHlWYWwgPSAxMDAgLSAoeSAqICgxMDAgLyAodGhpc09iai5oZWlnaHQgLSAxKSkpO1xyXG5cclxuXHRcdHN3aXRjaCAoanNjLmdldFBhZFlDaGFubmVsKHRoaXNPYmopKSB7XHJcblx0XHRjYXNlICdzJzogdGhpc09iai5mcm9tSFNWQSh4VmFsLCB5VmFsLCBudWxsLCBudWxsKTsgYnJlYWs7XHJcblx0XHRjYXNlICd2JzogdGhpc09iai5mcm9tSFNWQSh4VmFsLCBudWxsLCB5VmFsLCBudWxsKTsgYnJlYWs7XHJcblx0XHR9XHJcblx0fSxcclxuXHJcblxyXG5cdHNldFNsZCA6IGZ1bmN0aW9uICh0aGlzT2JqLCBlLCBvZnNZKSB7XHJcblx0XHR2YXIgcG9pbnRlckFicyA9IGpzYy5nZXRBYnNQb2ludGVyUG9zKGUpO1xyXG5cdFx0dmFyIHkgPSBvZnNZICsgcG9pbnRlckFicy55IC0ganNjLl9wb2ludGVyT3JpZ2luLnkgLSB0aGlzT2JqLnBhZGRpbmcgLSB0aGlzT2JqLmNvbnRyb2xCb3JkZXJXaWR0aDtcclxuXHRcdHZhciB5VmFsID0gMTAwIC0gKHkgKiAoMTAwIC8gKHRoaXNPYmouaGVpZ2h0IC0gMSkpKTtcclxuXHJcblx0XHRzd2l0Y2ggKGpzYy5nZXRTbGlkZXJDaGFubmVsKHRoaXNPYmopKSB7XHJcblx0XHRjYXNlICdzJzogdGhpc09iai5mcm9tSFNWQShudWxsLCB5VmFsLCBudWxsLCBudWxsKTsgYnJlYWs7XHJcblx0XHRjYXNlICd2JzogdGhpc09iai5mcm9tSFNWQShudWxsLCBudWxsLCB5VmFsLCBudWxsKTsgYnJlYWs7XHJcblx0XHR9XHJcblx0fSxcclxuXHJcblxyXG5cdHNldEFTbGQgOiBmdW5jdGlvbiAodGhpc09iaiwgZSwgb2ZzWSkge1xyXG5cdFx0dmFyIHBvaW50ZXJBYnMgPSBqc2MuZ2V0QWJzUG9pbnRlclBvcyhlKTtcclxuXHRcdHZhciB5ID0gb2ZzWSArIHBvaW50ZXJBYnMueSAtIGpzYy5fcG9pbnRlck9yaWdpbi55IC0gdGhpc09iai5wYWRkaW5nIC0gdGhpc09iai5jb250cm9sQm9yZGVyV2lkdGg7XHJcblx0XHR2YXIgeVZhbCA9IDEuMCAtICh5ICogKDEuMCAvICh0aGlzT2JqLmhlaWdodCAtIDEpKSk7XHJcblxyXG5cdFx0aWYgKHlWYWwgPCAxLjApIHtcclxuXHRcdFx0Ly8gaWYgZm9ybWF0IGlzIGZsZXhpYmxlIGFuZCB0aGUgY3VycmVudCBmb3JtYXQgZG9lc24ndCBzdXBwb3J0IGFscGhhLCBzd2l0Y2ggdG8gYSBzdWl0YWJsZSBvbmVcclxuXHRcdFx0dmFyIGZtdCA9IHRoaXNPYmouZ2V0Rm9ybWF0KCk7XHJcblx0XHRcdGlmICh0aGlzT2JqLmZvcm1hdC50b0xvd2VyQ2FzZSgpID09PSAnYW55JyAmJiAhanNjLmlzQWxwaGFGb3JtYXQoZm10KSkge1xyXG5cdFx0XHRcdHRoaXNPYmouX3NldEZvcm1hdChmbXQgPT09ICdoZXgnID8gJ2hleGEnIDogJ3JnYmEnKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXNPYmouZnJvbUhTVkEobnVsbCwgbnVsbCwgbnVsbCwgeVZhbCk7XHJcblx0fSxcclxuXHJcblxyXG5cdGNyZWF0ZVBhZENhbnZhcyA6IGZ1bmN0aW9uICgpIHtcclxuXHJcblx0XHR2YXIgcmV0ID0ge1xyXG5cdFx0XHRlbG06IG51bGwsXHJcblx0XHRcdGRyYXc6IG51bGxcclxuXHRcdH07XHJcblxyXG5cdFx0dmFyIGNhbnZhcyA9IGpzYy5jcmVhdGVFbCgnY2FudmFzJyk7XHJcblx0XHR2YXIgY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7XHJcblxyXG5cdFx0dmFyIGRyYXdGdW5jID0gZnVuY3Rpb24gKHdpZHRoLCBoZWlnaHQsIHR5cGUpIHtcclxuXHRcdFx0Y2FudmFzLndpZHRoID0gd2lkdGg7XHJcblx0XHRcdGNhbnZhcy5oZWlnaHQgPSBoZWlnaHQ7XHJcblxyXG5cdFx0XHRjdHguY2xlYXJSZWN0KDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCk7XHJcblxyXG5cdFx0XHR2YXIgaEdyYWQgPSBjdHguY3JlYXRlTGluZWFyR3JhZGllbnQoMCwgMCwgY2FudmFzLndpZHRoLCAwKTtcclxuXHRcdFx0aEdyYWQuYWRkQ29sb3JTdG9wKDAgLyA2LCAnI0YwMCcpO1xyXG5cdFx0XHRoR3JhZC5hZGRDb2xvclN0b3AoMSAvIDYsICcjRkYwJyk7XHJcblx0XHRcdGhHcmFkLmFkZENvbG9yU3RvcCgyIC8gNiwgJyMwRjAnKTtcclxuXHRcdFx0aEdyYWQuYWRkQ29sb3JTdG9wKDMgLyA2LCAnIzBGRicpO1xyXG5cdFx0XHRoR3JhZC5hZGRDb2xvclN0b3AoNCAvIDYsICcjMDBGJyk7XHJcblx0XHRcdGhHcmFkLmFkZENvbG9yU3RvcCg1IC8gNiwgJyNGMEYnKTtcclxuXHRcdFx0aEdyYWQuYWRkQ29sb3JTdG9wKDYgLyA2LCAnI0YwMCcpO1xyXG5cclxuXHRcdFx0Y3R4LmZpbGxTdHlsZSA9IGhHcmFkO1xyXG5cdFx0XHRjdHguZmlsbFJlY3QoMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTtcclxuXHJcblx0XHRcdHZhciB2R3JhZCA9IGN0eC5jcmVhdGVMaW5lYXJHcmFkaWVudCgwLCAwLCAwLCBjYW52YXMuaGVpZ2h0KTtcclxuXHRcdFx0c3dpdGNoICh0eXBlLnRvTG93ZXJDYXNlKCkpIHtcclxuXHRcdFx0Y2FzZSAncyc6XHJcblx0XHRcdFx0dkdyYWQuYWRkQ29sb3JTdG9wKDAsICdyZ2JhKDI1NSwyNTUsMjU1LDApJyk7XHJcblx0XHRcdFx0dkdyYWQuYWRkQ29sb3JTdG9wKDEsICdyZ2JhKDI1NSwyNTUsMjU1LDEpJyk7XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdGNhc2UgJ3YnOlxyXG5cdFx0XHRcdHZHcmFkLmFkZENvbG9yU3RvcCgwLCAncmdiYSgwLDAsMCwwKScpO1xyXG5cdFx0XHRcdHZHcmFkLmFkZENvbG9yU3RvcCgxLCAncmdiYSgwLDAsMCwxKScpO1xyXG5cdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHR9XHJcblx0XHRcdGN0eC5maWxsU3R5bGUgPSB2R3JhZDtcclxuXHRcdFx0Y3R4LmZpbGxSZWN0KDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCk7XHJcblx0XHR9O1xyXG5cclxuXHRcdHJldC5lbG0gPSBjYW52YXM7XHJcblx0XHRyZXQuZHJhdyA9IGRyYXdGdW5jO1xyXG5cclxuXHRcdHJldHVybiByZXQ7XHJcblx0fSxcclxuXHJcblxyXG5cdGNyZWF0ZVNsaWRlckdyYWRpZW50IDogZnVuY3Rpb24gKCkge1xyXG5cclxuXHRcdHZhciByZXQgPSB7XHJcblx0XHRcdGVsbTogbnVsbCxcclxuXHRcdFx0ZHJhdzogbnVsbFxyXG5cdFx0fTtcclxuXHJcblx0XHR2YXIgY2FudmFzID0ganNjLmNyZWF0ZUVsKCdjYW52YXMnKTtcclxuXHRcdHZhciBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcclxuXHJcblx0XHR2YXIgZHJhd0Z1bmMgPSBmdW5jdGlvbiAod2lkdGgsIGhlaWdodCwgY29sb3IxLCBjb2xvcjIpIHtcclxuXHRcdFx0Y2FudmFzLndpZHRoID0gd2lkdGg7XHJcblx0XHRcdGNhbnZhcy5oZWlnaHQgPSBoZWlnaHQ7XHJcblxyXG5cdFx0XHRjdHguY2xlYXJSZWN0KDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCk7XHJcblxyXG5cdFx0XHR2YXIgZ3JhZCA9IGN0eC5jcmVhdGVMaW5lYXJHcmFkaWVudCgwLCAwLCAwLCBjYW52YXMuaGVpZ2h0KTtcclxuXHRcdFx0Z3JhZC5hZGRDb2xvclN0b3AoMCwgY29sb3IxKTtcclxuXHRcdFx0Z3JhZC5hZGRDb2xvclN0b3AoMSwgY29sb3IyKTtcclxuXHJcblx0XHRcdGN0eC5maWxsU3R5bGUgPSBncmFkO1xyXG5cdFx0XHRjdHguZmlsbFJlY3QoMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTtcclxuXHRcdH07XHJcblxyXG5cdFx0cmV0LmVsbSA9IGNhbnZhcztcclxuXHRcdHJldC5kcmF3ID0gZHJhd0Z1bmM7XHJcblxyXG5cdFx0cmV0dXJuIHJldDtcclxuXHR9LFxyXG5cclxuXHJcblx0Y3JlYXRlQVNsaWRlckdyYWRpZW50IDogZnVuY3Rpb24gKCkge1xyXG5cclxuXHRcdHZhciByZXQgPSB7XHJcblx0XHRcdGVsbTogbnVsbCxcclxuXHRcdFx0ZHJhdzogbnVsbFxyXG5cdFx0fTtcclxuXHJcblx0XHR2YXIgY2FudmFzID0ganNjLmNyZWF0ZUVsKCdjYW52YXMnKTtcclxuXHRcdHZhciBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcclxuXHJcblx0XHR2YXIgZHJhd0Z1bmMgPSBmdW5jdGlvbiAod2lkdGgsIGhlaWdodCwgY29sb3IpIHtcclxuXHRcdFx0Y2FudmFzLndpZHRoID0gd2lkdGg7XHJcblx0XHRcdGNhbnZhcy5oZWlnaHQgPSBoZWlnaHQ7XHJcblxyXG5cdFx0XHRjdHguY2xlYXJSZWN0KDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCk7XHJcblxyXG5cdFx0XHR2YXIgc3FTaXplID0gY2FudmFzLndpZHRoIC8gMjtcclxuXHRcdFx0dmFyIHNxQ29sb3IxID0ganNjLnB1Yi5jaGVzc2JvYXJkQ29sb3IxO1xyXG5cdFx0XHR2YXIgc3FDb2xvcjIgPSBqc2MucHViLmNoZXNzYm9hcmRDb2xvcjI7XHJcblxyXG5cdFx0XHQvLyBkYXJrIGdyYXkgYmFja2dyb3VuZFxyXG5cdFx0XHRjdHguZmlsbFN0eWxlID0gc3FDb2xvcjE7XHJcblx0XHRcdGN0eC5maWxsUmVjdCgwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpO1xyXG5cclxuXHRcdFx0aWYgKHNxU2l6ZSA+IDApIHsgLy8gdG8gYXZvaWQgaW5maW5pdGUgbG9vcFxyXG5cdFx0XHRcdGZvciAodmFyIHkgPSAwOyB5IDwgY2FudmFzLmhlaWdodDsgeSArPSBzcVNpemUgKiAyKSB7XHJcblx0XHRcdFx0XHQvLyBsaWdodCBncmF5IHNxdWFyZXNcclxuXHRcdFx0XHRcdGN0eC5maWxsU3R5bGUgPSBzcUNvbG9yMjtcclxuXHRcdFx0XHRcdGN0eC5maWxsUmVjdCgwLCB5LCBzcVNpemUsIHNxU2l6ZSk7XHJcblx0XHRcdFx0XHRjdHguZmlsbFJlY3Qoc3FTaXplLCB5ICsgc3FTaXplLCBzcVNpemUsIHNxU2l6ZSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR2YXIgZ3JhZCA9IGN0eC5jcmVhdGVMaW5lYXJHcmFkaWVudCgwLCAwLCAwLCBjYW52YXMuaGVpZ2h0KTtcclxuXHRcdFx0Z3JhZC5hZGRDb2xvclN0b3AoMCwgY29sb3IpO1xyXG5cdFx0XHRncmFkLmFkZENvbG9yU3RvcCgxLCAncmdiYSgwLDAsMCwwKScpO1xyXG5cclxuXHRcdFx0Y3R4LmZpbGxTdHlsZSA9IGdyYWQ7XHJcblx0XHRcdGN0eC5maWxsUmVjdCgwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpO1xyXG5cdFx0fTtcclxuXHJcblx0XHRyZXQuZWxtID0gY2FudmFzO1xyXG5cdFx0cmV0LmRyYXcgPSBkcmF3RnVuYztcclxuXHJcblx0XHRyZXR1cm4gcmV0O1xyXG5cdH0sXHJcblxyXG5cclxuXHRCb3hTaGFkb3cgOiAoZnVuY3Rpb24gKCkge1xyXG5cdFx0dmFyIEJveFNoYWRvdyA9IGZ1bmN0aW9uIChoU2hhZG93LCB2U2hhZG93LCBibHVyLCBzcHJlYWQsIGNvbG9yLCBpbnNldCkge1xyXG5cdFx0XHR0aGlzLmhTaGFkb3cgPSBoU2hhZG93O1xyXG5cdFx0XHR0aGlzLnZTaGFkb3cgPSB2U2hhZG93O1xyXG5cdFx0XHR0aGlzLmJsdXIgPSBibHVyO1xyXG5cdFx0XHR0aGlzLnNwcmVhZCA9IHNwcmVhZDtcclxuXHRcdFx0dGhpcy5jb2xvciA9IGNvbG9yO1xyXG5cdFx0XHR0aGlzLmluc2V0ID0gISFpbnNldDtcclxuXHRcdH07XHJcblxyXG5cdFx0Qm94U2hhZG93LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0dmFyIHZhbHMgPSBbXHJcblx0XHRcdFx0TWF0aC5yb3VuZCh0aGlzLmhTaGFkb3cpICsgJ3B4JyxcclxuXHRcdFx0XHRNYXRoLnJvdW5kKHRoaXMudlNoYWRvdykgKyAncHgnLFxyXG5cdFx0XHRcdE1hdGgucm91bmQodGhpcy5ibHVyKSArICdweCcsXHJcblx0XHRcdFx0TWF0aC5yb3VuZCh0aGlzLnNwcmVhZCkgKyAncHgnLFxyXG5cdFx0XHRcdHRoaXMuY29sb3JcclxuXHRcdFx0XTtcclxuXHRcdFx0aWYgKHRoaXMuaW5zZXQpIHtcclxuXHRcdFx0XHR2YWxzLnB1c2goJ2luc2V0Jyk7XHJcblx0XHRcdH1cclxuXHRcdFx0cmV0dXJuIHZhbHMuam9pbignICcpO1xyXG5cdFx0fTtcclxuXHJcblx0XHRyZXR1cm4gQm94U2hhZG93O1xyXG5cdH0pKCksXHJcblxyXG5cclxuXHRmbGFncyA6IHtcclxuXHRcdGxlYXZlVmFsdWUgOiAxIDw8IDAsXHJcblx0XHRsZWF2ZUFscGhhIDogMSA8PCAxLFxyXG5cdFx0bGVhdmVQcmV2aWV3IDogMSA8PCAyLFxyXG5cdH0sXHJcblxyXG5cclxuXHRlbnVtT3B0cyA6IHtcclxuXHRcdGZvcm1hdDogWydhdXRvJywgJ2FueScsICdoZXgnLCAnaGV4YScsICdyZ2InLCAncmdiYSddLFxyXG5cdFx0cHJldmlld1Bvc2l0aW9uOiBbJ2xlZnQnLCAncmlnaHQnXSxcclxuXHRcdG1vZGU6IFsnaHN2JywgJ2h2cycsICdocycsICdodiddLFxyXG5cdFx0cG9zaXRpb246IFsnbGVmdCcsICdyaWdodCcsICd0b3AnLCAnYm90dG9tJ10sXHJcblx0XHRhbHBoYUNoYW5uZWw6IFsnYXV0bycsIHRydWUsIGZhbHNlXSxcclxuXHRcdHBhbGV0dGVTZXRzQWxwaGE6IFsnYXV0bycsIHRydWUsIGZhbHNlXSxcclxuXHR9LFxyXG5cclxuXHJcblx0ZGVwcmVjYXRlZE9wdHMgOiB7XHJcblx0XHQvLyA8b2xkX29wdGlvbj46IDxuZXdfb3B0aW9uPiAgKDxuZXdfb3B0aW9uPiBjYW4gYmUgbnVsbClcclxuXHRcdCdzdHlsZUVsZW1lbnQnOiAncHJldmlld0VsZW1lbnQnLFxyXG5cdFx0J29uRmluZUNoYW5nZSc6ICdvbklucHV0JyxcclxuXHRcdCdvdmVyd3JpdGVJbXBvcnRhbnQnOiAnZm9yY2VTdHlsZScsXHJcblx0XHQnY2xvc2FibGUnOiAnY2xvc2VCdXR0b24nLFxyXG5cdFx0J2luc2V0V2lkdGgnOiAnY29udHJvbEJvcmRlcldpZHRoJyxcclxuXHRcdCdpbnNldENvbG9yJzogJ2NvbnRyb2xCb3JkZXJDb2xvcicsXHJcblx0XHQncmVmaW5lJzogbnVsbCxcclxuXHR9LFxyXG5cclxuXHJcblx0ZG9jc1JlZiA6ICcgJyArICdTZWUgaHR0cHM6Ly9qc2NvbG9yLmNvbS9kb2NzLycsXHJcblxyXG5cclxuXHQvL1xyXG5cdC8vIFVzYWdlOlxyXG5cdC8vIHZhciBteVBpY2tlciA9IG5ldyBKU0NvbG9yKDx0YXJnZXRFbGVtZW50PiBbLCA8b3B0aW9ucz5dKVxyXG5cdC8vXHJcblx0Ly8gKGNvbnN0cnVjdG9yIGlzIGFjY2Vzc2libGUgdmlhIGJvdGggJ2pzY29sb3InIGFuZCAnSlNDb2xvcicgbmFtZSlcclxuXHQvL1xyXG5cclxuXHRwdWIgOiBmdW5jdGlvbiAodGFyZ2V0RWxlbWVudCwgb3B0cykge1xyXG5cclxuXHRcdHZhciBUSElTID0gdGhpcztcclxuXHJcblx0XHRpZiAoIW9wdHMpIHtcclxuXHRcdFx0b3B0cyA9IHt9O1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuY2hhbm5lbHMgPSB7XHJcblx0XHRcdHI6IDI1NSwgLy8gcmVkIFswLTI1NV1cclxuXHRcdFx0ZzogMjU1LCAvLyBncmVlbiBbMC0yNTVdXHJcblx0XHRcdGI6IDI1NSwgLy8gYmx1ZSBbMC0yNTVdXHJcblx0XHRcdGg6IDAsIC8vIGh1ZSBbMC0zNjBdXHJcblx0XHRcdHM6IDAsIC8vIHNhdHVyYXRpb24gWzAtMTAwXVxyXG5cdFx0XHR2OiAxMDAsIC8vIHZhbHVlIChicmlnaHRuZXNzKSBbMC0xMDBdXHJcblx0XHRcdGE6IDEuMCwgLy8gYWxwaGEgKG9wYWNpdHkpIFswLjAgLSAxLjBdXHJcblx0XHR9O1xyXG5cclxuXHRcdC8vIEdlbmVyYWwgb3B0aW9uc1xyXG5cdFx0Ly9cclxuXHRcdHRoaXMuZm9ybWF0ID0gJ2F1dG8nOyAvLyAnYXV0bycgfCAnYW55JyB8ICdoZXgnIHwgJ2hleGEnIHwgJ3JnYicgfCAncmdiYScgLSBGb3JtYXQgb2YgdGhlIGlucHV0L291dHB1dCB2YWx1ZVxyXG5cdFx0dGhpcy52YWx1ZSA9IHVuZGVmaW5lZDsgLy8gSU5JVElBTCBjb2xvciB2YWx1ZSBpbiBhbnkgc3VwcG9ydGVkIGZvcm1hdC4gVG8gY2hhbmdlIGl0IGxhdGVyLCB1c2UgbWV0aG9kIGZyb21TdHJpbmcoKSwgZnJvbUhTVkEoKSwgZnJvbVJHQkEoKSBvciBjaGFubmVsKClcclxuXHRcdHRoaXMuYWxwaGEgPSB1bmRlZmluZWQ7IC8vIElOSVRJQUwgYWxwaGEgdmFsdWUuIFRvIGNoYW5nZSBpdCBsYXRlciwgY2FsbCBtZXRob2QgY2hhbm5lbCgnQScsIDx2YWx1ZT4pXHJcblx0XHR0aGlzLnJhbmRvbSA9IGZhbHNlOyAvLyB3aGV0aGVyIHRvIHJhbmRvbWl6ZSB0aGUgaW5pdGlhbCBjb2xvci4gRWl0aGVyIHRydWUgfCBmYWxzZSwgb3IgYW4gYXJyYXkgb2YgcmFuZ2VzOiBbbWluViwgbWF4ViwgbWluUywgbWF4UywgbWluSCwgbWF4SCwgbWluQSwgbWF4QV1cclxuXHRcdHRoaXMub25DaGFuZ2UgPSB1bmRlZmluZWQ7IC8vIGNhbGxlZCB3aGVuIGNvbG9yIGNoYW5nZXMuIFZhbHVlIGNhbiBiZSBlaXRoZXIgYSBmdW5jdGlvbiBvciBhIHN0cmluZyB3aXRoIEpTIGNvZGUuXHJcblx0XHR0aGlzLm9uSW5wdXQgPSB1bmRlZmluZWQ7IC8vIGNhbGxlZCByZXBlYXRlZGx5IGFzIHRoZSBjb2xvciBpcyBiZWluZyBjaGFuZ2VkLCBlLmcuIHdoaWxlIGRyYWdnaW5nIGEgc2xpZGVyLiBWYWx1ZSBjYW4gYmUgZWl0aGVyIGEgZnVuY3Rpb24gb3IgYSBzdHJpbmcgd2l0aCBKUyBjb2RlLlxyXG5cdFx0dGhpcy52YWx1ZUVsZW1lbnQgPSB1bmRlZmluZWQ7IC8vIGVsZW1lbnQgdGhhdCB3aWxsIGJlIHVzZWQgdG8gZGlzcGxheSBhbmQgaW5wdXQgdGhlIGNvbG9yIHZhbHVlXHJcblx0XHR0aGlzLmFscGhhRWxlbWVudCA9IHVuZGVmaW5lZDsgLy8gZWxlbWVudCB0aGF0IHdpbGwgYmUgdXNlZCB0byBkaXNwbGF5IGFuZCBpbnB1dCB0aGUgYWxwaGEgKG9wYWNpdHkpIHZhbHVlXHJcblx0XHR0aGlzLnByZXZpZXdFbGVtZW50ID0gdW5kZWZpbmVkOyAvLyBlbGVtZW50IHRoYXQgd2lsbCBwcmV2aWV3IHRoZSBwaWNrZWQgY29sb3IgdXNpbmcgQ1NTIGJhY2tncm91bmRcclxuXHRcdHRoaXMucHJldmlld1Bvc2l0aW9uID0gJ2xlZnQnOyAvLyAnbGVmdCcgfCAncmlnaHQnIC0gcG9zaXRpb24gb2YgdGhlIGNvbG9yIHByZXZpZXcgaW4gcHJldmlld0VsZW1lbnRcclxuXHRcdHRoaXMucHJldmlld1NpemUgPSAzMjsgLy8gKHB4KSB3aWR0aCBvZiB0aGUgY29sb3IgcHJldmlldyBkaXNwbGF5ZWQgaW4gcHJldmlld0VsZW1lbnRcclxuXHRcdHRoaXMucHJldmlld1BhZGRpbmcgPSA4OyAvLyAocHgpIHNwYWNlIGJldHdlZW4gY29sb3IgcHJldmlldyBhbmQgY29udGVudCBvZiB0aGUgcHJldmlld0VsZW1lbnRcclxuXHRcdHRoaXMucmVxdWlyZWQgPSB0cnVlOyAvLyB3aGV0aGVyIHRoZSBhc3NvY2lhdGVkIHRleHQgaW5wdXQgbXVzdCBhbHdheXMgY29udGFpbiBhIGNvbG9yIHZhbHVlLiBJZiBmYWxzZSwgdGhlIGlucHV0IGNhbiBiZSBsZWZ0IGVtcHR5LlxyXG5cdFx0dGhpcy5oYXNoID0gdHJ1ZTsgLy8gd2hldGhlciB0byBwcmVmaXggdGhlIEhFWCBjb2xvciBjb2RlIHdpdGggIyBzeW1ib2wgKG9ubHkgYXBwbGljYWJsZSBmb3IgSEVYIGZvcm1hdClcclxuXHRcdHRoaXMudXBwZXJjYXNlID0gdHJ1ZTsgLy8gd2hldGhlciB0byBzaG93IHRoZSBIRVggY29sb3IgY29kZSBpbiB1cHBlciBjYXNlIChvbmx5IGFwcGxpY2FibGUgZm9yIEhFWCBmb3JtYXQpXHJcblx0XHR0aGlzLmZvcmNlU3R5bGUgPSB0cnVlOyAvLyB3aGV0aGVyIHRvIG92ZXJ3cml0ZSBDU1Mgc3R5bGUgb2YgdGhlIHByZXZpZXdFbGVtZW50IHVzaW5nICFpbXBvcnRhbnQgZmxhZ1xyXG5cclxuXHRcdC8vIENvbG9yIFBpY2tlciBvcHRpb25zXHJcblx0XHQvL1xyXG5cdFx0dGhpcy53aWR0aCA9IDE4MTsgLy8gd2lkdGggb2YgdGhlIGNvbG9yIHNwZWN0cnVtIChpbiBweClcclxuXHRcdHRoaXMuaGVpZ2h0ID0gMTAxOyAvLyBoZWlnaHQgb2YgdGhlIGNvbG9yIHNwZWN0cnVtIChpbiBweClcclxuXHRcdHRoaXMubW9kZSA9ICdIU1YnOyAvLyAnSFNWJyB8ICdIVlMnIHwgJ0hTJyB8ICdIVicgLSBsYXlvdXQgb2YgdGhlIGNvbG9yIHBpY2tlciBjb250cm9sc1xyXG5cdFx0dGhpcy5hbHBoYUNoYW5uZWwgPSAnYXV0byc7IC8vICdhdXRvJyB8IHRydWUgfCBmYWxzZSAtIGlmIGFscGhhIGNoYW5uZWwgaXMgZW5hYmxlZCwgdGhlIGFscGhhIHNsaWRlciB3aWxsIGJlIHZpc2libGUuIElmICdhdXRvJywgaXQgd2lsbCBiZSBkZXRlcm1pbmVkIGFjY29yZGluZyB0byBjb2xvciBmb3JtYXRcclxuXHRcdHRoaXMucG9zaXRpb24gPSAnYm90dG9tJzsgLy8gJ2xlZnQnIHwgJ3JpZ2h0JyB8ICd0b3AnIHwgJ2JvdHRvbScgLSBwb3NpdGlvbiByZWxhdGl2ZSB0byB0aGUgdGFyZ2V0IGVsZW1lbnRcclxuXHRcdHRoaXMuc21hcnRQb3NpdGlvbiA9IHRydWU7IC8vIGF1dG9tYXRpY2FsbHkgY2hhbmdlIHBpY2tlciBwb3NpdGlvbiB3aGVuIHRoZXJlIGlzIG5vdCBlbm91Z2ggc3BhY2UgZm9yIGl0XHJcblx0XHR0aGlzLnNob3dPbkNsaWNrID0gdHJ1ZTsgLy8gd2hldGhlciB0byBzaG93IHRoZSBwaWNrZXIgd2hlbiB1c2VyIGNsaWNrcyBpdHMgdGFyZ2V0IGVsZW1lbnRcclxuXHRcdHRoaXMuaGlkZU9uTGVhdmUgPSB0cnVlOyAvLyB3aGV0aGVyIHRvIGF1dG9tYXRpY2FsbHkgaGlkZSB0aGUgcGlja2VyIHdoZW4gdXNlciBsZWF2ZXMgaXRzIHRhcmdldCBlbGVtZW50IChlLmcuIHVwb24gY2xpY2tpbmcgdGhlIGRvY3VtZW50KVxyXG5cdFx0dGhpcy5wYWxldHRlID0gW107IC8vIGNvbG9ycyB0byBiZSBkaXNwbGF5ZWQgaW4gdGhlIHBhbGV0dGUsIHNwZWNpZmllZCBhcyBhbiBhcnJheSBvciBhIHN0cmluZyBvZiBzcGFjZSBzZXBhcmF0ZWQgY29sb3IgdmFsdWVzIChpbiBhbnkgc3VwcG9ydGVkIGZvcm1hdClcclxuXHRcdHRoaXMucGFsZXR0ZUNvbHMgPSAxMDsgLy8gbnVtYmVyIG9mIGNvbHVtbnMgaW4gdGhlIHBhbGV0dGVcclxuXHRcdHRoaXMucGFsZXR0ZVNldHNBbHBoYSA9ICdhdXRvJzsgLy8gJ2F1dG8nIHwgdHJ1ZSB8IGZhbHNlIC0gaWYgdHJ1ZSwgcGFsZXR0ZSBjb2xvcnMgdGhhdCBkb24ndCBzcGVjaWZ5IGFscGhhIHdpbGwgc2V0IGFscGhhIHRvIDEuMFxyXG5cdFx0dGhpcy5wYWxldHRlSGVpZ2h0ID0gMTY7IC8vIG1heGltdW0gaGVpZ2h0IChweCkgb2YgYSByb3cgaW4gdGhlIHBhbGV0dGVcclxuXHRcdHRoaXMucGFsZXR0ZVNwYWNpbmcgPSA0OyAvLyBkaXN0YW5jZSAocHgpIGJldHdlZW4gY29sb3Igc2FtcGxlcyBpbiB0aGUgcGFsZXR0ZVxyXG5cdFx0dGhpcy5oaWRlT25QYWxldHRlQ2xpY2sgPSBmYWxzZTsgLy8gd2hlbiBzZXQgdG8gdHJ1ZSwgY2xpY2tpbmcgdGhlIHBhbGV0dGUgd2lsbCBhbHNvIGhpZGUgdGhlIGNvbG9yIHBpY2tlclxyXG5cdFx0dGhpcy5zbGlkZXJTaXplID0gMTY7IC8vIHB4XHJcblx0XHR0aGlzLmNyb3NzU2l6ZSA9IDg7IC8vIHB4XHJcblx0XHR0aGlzLmNsb3NlQnV0dG9uID0gZmFsc2U7IC8vIHdoZXRoZXIgdG8gZGlzcGxheSB0aGUgQ2xvc2UgYnV0dG9uXHJcblx0XHR0aGlzLmNsb3NlVGV4dCA9ICdDbG9zZSc7XHJcblx0XHR0aGlzLmJ1dHRvbkNvbG9yID0gJ3JnYmEoMCwwLDAsMSknOyAvLyBDU1MgY29sb3JcclxuXHRcdHRoaXMuYnV0dG9uSGVpZ2h0ID0gMTg7IC8vIHB4XHJcblx0XHR0aGlzLnBhZGRpbmcgPSAxMjsgLy8gcHhcclxuXHRcdHRoaXMuYmFja2dyb3VuZENvbG9yID0gJ3JnYmEoMjU1LDI1NSwyNTUsMSknOyAvLyBDU1MgY29sb3JcclxuXHRcdHRoaXMuYm9yZGVyV2lkdGggPSAxOyAvLyBweFxyXG5cdFx0dGhpcy5ib3JkZXJDb2xvciA9ICdyZ2JhKDE4NywxODcsMTg3LDEpJzsgLy8gQ1NTIGNvbG9yXHJcblx0XHR0aGlzLmJvcmRlclJhZGl1cyA9IDg7IC8vIHB4XHJcblx0XHR0aGlzLmNvbnRyb2xCb3JkZXJXaWR0aCA9IDE7IC8vIHB4XHJcblx0XHR0aGlzLmNvbnRyb2xCb3JkZXJDb2xvciA9ICdyZ2JhKDE4NywxODcsMTg3LDEpJzsgLy8gQ1NTIGNvbG9yXHJcblx0XHR0aGlzLnNoYWRvdyA9IHRydWU7IC8vIHdoZXRoZXIgdG8gZGlzcGxheSBhIHNoYWRvd1xyXG5cdFx0dGhpcy5zaGFkb3dCbHVyID0gMTU7IC8vIHB4XHJcblx0XHR0aGlzLnNoYWRvd0NvbG9yID0gJ3JnYmEoMCwwLDAsMC4yKSc7IC8vIENTUyBjb2xvclxyXG5cdFx0dGhpcy5wb2ludGVyQ29sb3IgPSAncmdiYSg3Niw3Niw3NiwxKSc7IC8vIENTUyBjb2xvclxyXG5cdFx0dGhpcy5wb2ludGVyQm9yZGVyV2lkdGggPSAxOyAvLyBweFxyXG5cdFx0dGhpcy5wb2ludGVyQm9yZGVyQ29sb3IgPSAncmdiYSgyNTUsMjU1LDI1NSwxKSc7IC8vIENTUyBjb2xvclxyXG5cdFx0dGhpcy5wb2ludGVyVGhpY2tuZXNzID0gMjsgLy8gcHhcclxuXHRcdHRoaXMuekluZGV4ID0gNTAwMDtcclxuXHRcdHRoaXMuY29udGFpbmVyID0gdW5kZWZpbmVkOyAvLyB3aGVyZSB0byBhcHBlbmQgdGhlIGNvbG9yIHBpY2tlciAoQk9EWSBlbGVtZW50IGJ5IGRlZmF1bHQpXHJcblxyXG5cdFx0Ly8gRXhwZXJpbWVudGFsXHJcblx0XHQvL1xyXG5cdFx0dGhpcy5taW5TID0gMDsgLy8gbWluIGFsbG93ZWQgc2F0dXJhdGlvbiAoMCAtIDEwMClcclxuXHRcdHRoaXMubWF4UyA9IDEwMDsgLy8gbWF4IGFsbG93ZWQgc2F0dXJhdGlvbiAoMCAtIDEwMClcclxuXHRcdHRoaXMubWluViA9IDA7IC8vIG1pbiBhbGxvd2VkIHZhbHVlIChicmlnaHRuZXNzKSAoMCAtIDEwMClcclxuXHRcdHRoaXMubWF4ViA9IDEwMDsgLy8gbWF4IGFsbG93ZWQgdmFsdWUgKGJyaWdodG5lc3MpICgwIC0gMTAwKVxyXG5cdFx0dGhpcy5taW5BID0gMC4wOyAvLyBtaW4gYWxsb3dlZCBhbHBoYSAob3BhY2l0eSkgKDAuMCAtIDEuMClcclxuXHRcdHRoaXMubWF4QSA9IDEuMDsgLy8gbWF4IGFsbG93ZWQgYWxwaGEgKG9wYWNpdHkpICgwLjAgLSAxLjApXHJcblxyXG5cclxuXHRcdC8vIEdldHRlcjogb3B0aW9uKG5hbWUpXHJcblx0XHQvLyBTZXR0ZXI6IG9wdGlvbihuYW1lLCB2YWx1ZSlcclxuXHRcdC8vICAgICAgICAgb3B0aW9uKHtuYW1lOnZhbHVlLCAuLi59KVxyXG5cdFx0Ly9cclxuXHRcdHRoaXMub3B0aW9uID0gZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRpZiAoIWFyZ3VtZW50cy5sZW5ndGgpIHtcclxuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ05vIG9wdGlvbiBzcGVjaWZpZWQnKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0aWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDEgJiYgdHlwZW9mIGFyZ3VtZW50c1swXSA9PT0gJ3N0cmluZycpIHtcclxuXHRcdFx0XHQvLyBnZXR0aW5nIGEgc2luZ2xlIG9wdGlvblxyXG5cdFx0XHRcdHRyeSB7XHJcblx0XHRcdFx0XHRyZXR1cm4gZ2V0T3B0aW9uKGFyZ3VtZW50c1swXSk7XHJcblx0XHRcdFx0fSBjYXRjaCAoZSkge1xyXG5cdFx0XHRcdFx0Y29uc29sZS53YXJuKGUpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblxyXG5cdFx0XHR9IGVsc2UgaWYgKGFyZ3VtZW50cy5sZW5ndGggPj0gMiAmJiB0eXBlb2YgYXJndW1lbnRzWzBdID09PSAnc3RyaW5nJykge1xyXG5cdFx0XHRcdC8vIHNldHRpbmcgYSBzaW5nbGUgb3B0aW9uXHJcblx0XHRcdFx0dHJ5IHtcclxuXHRcdFx0XHRcdGlmICghc2V0T3B0aW9uKGFyZ3VtZW50c1swXSwgYXJndW1lbnRzWzFdKSkge1xyXG5cdFx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSBjYXRjaCAoZSkge1xyXG5cdFx0XHRcdFx0Y29uc29sZS53YXJuKGUpO1xyXG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHR0aGlzLnJlZHJhdygpOyAvLyBpbW1lZGlhdGVseSByZWRyYXdzIHRoZSBwaWNrZXIsIGlmIGl0J3MgZGlzcGxheWVkXHJcblx0XHRcdFx0dGhpcy5leHBvc2VDb2xvcigpOyAvLyBpbiBjYXNlIHNvbWUgcHJldmlldy1yZWxhdGVkIG9yIGZvcm1hdC1yZWxhdGVkIG9wdGlvbiB3YXMgY2hhbmdlZFxyXG5cdFx0XHRcdHJldHVybiB0cnVlO1xyXG5cclxuXHRcdFx0fSBlbHNlIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAxICYmIHR5cGVvZiBhcmd1bWVudHNbMF0gPT09ICdvYmplY3QnKSB7XHJcblx0XHRcdFx0Ly8gc2V0dGluZyBtdWx0aXBsZSBvcHRpb25zXHJcblx0XHRcdFx0dmFyIG9wdHMgPSBhcmd1bWVudHNbMF07XHJcblx0XHRcdFx0dmFyIHN1Y2Nlc3MgPSB0cnVlO1xyXG5cdFx0XHRcdGZvciAodmFyIG9wdCBpbiBvcHRzKSB7XHJcblx0XHRcdFx0XHRpZiAob3B0cy5oYXNPd25Qcm9wZXJ0eShvcHQpKSB7XHJcblx0XHRcdFx0XHRcdHRyeSB7XHJcblx0XHRcdFx0XHRcdFx0aWYgKCFzZXRPcHRpb24ob3B0LCBvcHRzW29wdF0pKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRzdWNjZXNzID0gZmFsc2U7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9IGNhdGNoIChlKSB7XHJcblx0XHRcdFx0XHRcdFx0Y29uc29sZS53YXJuKGUpO1xyXG5cdFx0XHRcdFx0XHRcdHN1Y2Nlc3MgPSBmYWxzZTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHR0aGlzLnJlZHJhdygpOyAvLyBpbW1lZGlhdGVseSByZWRyYXdzIHRoZSBwaWNrZXIsIGlmIGl0J3MgZGlzcGxheWVkXHJcblx0XHRcdFx0dGhpcy5leHBvc2VDb2xvcigpOyAvLyBpbiBjYXNlIHNvbWUgcHJldmlldy1yZWxhdGVkIG9yIGZvcm1hdC1yZWxhdGVkIG9wdGlvbiB3YXMgY2hhbmdlZFxyXG5cdFx0XHRcdHJldHVybiBzdWNjZXNzO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgYXJndW1lbnRzJyk7XHJcblx0XHR9XHJcblxyXG5cclxuXHRcdC8vIEdldHRlcjogY2hhbm5lbChuYW1lKVxyXG5cdFx0Ly8gU2V0dGVyOiBjaGFubmVsKG5hbWUsIHZhbHVlKVxyXG5cdFx0Ly9cclxuXHRcdHRoaXMuY2hhbm5lbCA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkge1xyXG5cdFx0XHRpZiAodHlwZW9mIG5hbWUgIT09ICdzdHJpbmcnKSB7XHJcblx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHZhbHVlIGZvciBjaGFubmVsIG5hbWU6ICcgKyBuYW1lKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0aWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0XHQvLyBnZXR0aW5nIGNoYW5uZWwgdmFsdWVcclxuXHRcdFx0XHRpZiAoIXRoaXMuY2hhbm5lbHMuaGFzT3duUHJvcGVydHkobmFtZS50b0xvd2VyQ2FzZSgpKSkge1xyXG5cdFx0XHRcdFx0Y29uc29sZS53YXJuKCdHZXR0aW5nIHVua25vd24gY2hhbm5lbDogJyArIG5hbWUpO1xyXG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRyZXR1cm4gdGhpcy5jaGFubmVsc1tuYW1lLnRvTG93ZXJDYXNlKCldO1xyXG5cclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHQvLyBzZXR0aW5nIGNoYW5uZWwgdmFsdWVcclxuXHRcdFx0XHR2YXIgcmVzID0gZmFsc2U7XHJcblx0XHRcdFx0c3dpdGNoIChuYW1lLnRvTG93ZXJDYXNlKCkpIHtcclxuXHRcdFx0XHRcdGNhc2UgJ3InOiByZXMgPSB0aGlzLmZyb21SR0JBKHZhbHVlLCBudWxsLCBudWxsLCBudWxsKTsgYnJlYWs7XHJcblx0XHRcdFx0XHRjYXNlICdnJzogcmVzID0gdGhpcy5mcm9tUkdCQShudWxsLCB2YWx1ZSwgbnVsbCwgbnVsbCk7IGJyZWFrO1xyXG5cdFx0XHRcdFx0Y2FzZSAnYic6IHJlcyA9IHRoaXMuZnJvbVJHQkEobnVsbCwgbnVsbCwgdmFsdWUsIG51bGwpOyBicmVhaztcclxuXHRcdFx0XHRcdGNhc2UgJ2gnOiByZXMgPSB0aGlzLmZyb21IU1ZBKHZhbHVlLCBudWxsLCBudWxsLCBudWxsKTsgYnJlYWs7XHJcblx0XHRcdFx0XHRjYXNlICdzJzogcmVzID0gdGhpcy5mcm9tSFNWQShudWxsLCB2YWx1ZSwgbnVsbCwgbnVsbCk7IGJyZWFrO1xyXG5cdFx0XHRcdFx0Y2FzZSAndic6IHJlcyA9IHRoaXMuZnJvbUhTVkEobnVsbCwgbnVsbCwgdmFsdWUsIG51bGwpOyBicmVhaztcclxuXHRcdFx0XHRcdGNhc2UgJ2EnOiByZXMgPSB0aGlzLmZyb21IU1ZBKG51bGwsIG51bGwsIG51bGwsIHZhbHVlKTsgYnJlYWs7XHJcblx0XHRcdFx0XHRkZWZhdWx0OlxyXG5cdFx0XHRcdFx0XHRjb25zb2xlLndhcm4oJ1NldHRpbmcgdW5rbm93biBjaGFubmVsOiAnICsgbmFtZSk7XHJcblx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYgKHJlcykge1xyXG5cdFx0XHRcdFx0dGhpcy5yZWRyYXcoKTsgLy8gaW1tZWRpYXRlbHkgcmVkcmF3cyB0aGUgcGlja2VyLCBpZiBpdCdzIGRpc3BsYXllZFxyXG5cdFx0XHRcdFx0cmV0dXJuIHRydWU7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHR9XHJcblxyXG5cclxuXHRcdC8vIFRyaWdnZXJzIGdpdmVuIGlucHV0IGV2ZW50KHMpIGJ5OlxyXG5cdFx0Ly8gLSBleGVjdXRpbmcgb248RXZlbnQ+IGNhbGxiYWNrIHNwZWNpZmllZCBhcyBwaWNrZXIncyBvcHRpb25cclxuXHRcdC8vIC0gdHJpZ2dlcmluZyBzdGFuZGFyZCBET00gZXZlbnQgbGlzdGVuZXJzIGF0dGFjaGVkIHRvIHRoZSB2YWx1ZSBlbGVtZW50XHJcblx0XHQvL1xyXG5cdFx0Ly8gSXQgaXMgcG9zc2libGUgdG8gc3BlY2lmeSBtdWx0aXBsZSBldmVudHMgc2VwYXJhdGVkIHdpdGggYSBzcGFjZS5cclxuXHRcdC8vXHJcblx0XHR0aGlzLnRyaWdnZXIgPSBmdW5jdGlvbiAoZXZlbnROYW1lcykge1xyXG5cdFx0XHR2YXIgZXZzID0ganNjLnN0ckxpc3QoZXZlbnROYW1lcyk7XHJcblx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgZXZzLmxlbmd0aDsgaSArPSAxKSB7XHJcblx0XHRcdFx0dmFyIGV2ID0gZXZzW2ldLnRvTG93ZXJDYXNlKCk7XHJcblxyXG5cdFx0XHRcdC8vIHRyaWdnZXIgYSBjYWxsYmFja1xyXG5cdFx0XHRcdHZhciBjYWxsYmFja1Byb3AgPSBudWxsO1xyXG5cdFx0XHRcdHN3aXRjaCAoZXYpIHtcclxuXHRcdFx0XHRcdGNhc2UgJ2lucHV0JzogY2FsbGJhY2tQcm9wID0gJ29uSW5wdXQnOyBicmVhaztcclxuXHRcdFx0XHRcdGNhc2UgJ2NoYW5nZSc6IGNhbGxiYWNrUHJvcCA9ICdvbkNoYW5nZSc7IGJyZWFrO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZiAoY2FsbGJhY2tQcm9wKSB7XHJcblx0XHRcdFx0XHRqc2MudHJpZ2dlckNhbGxiYWNrKHRoaXMsIGNhbGxiYWNrUHJvcCk7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHQvLyB0cmlnZ2VyIHN0YW5kYXJkIERPTSBldmVudCBsaXN0ZW5lcnMgb24gdGhlIHZhbHVlIGVsZW1lbnRcclxuXHRcdFx0XHRqc2MudHJpZ2dlcklucHV0RXZlbnQodGhpcy52YWx1ZUVsZW1lbnQsIGV2LCB0cnVlLCB0cnVlKTtcclxuXHRcdFx0fVxyXG5cdFx0fTtcclxuXHJcblxyXG5cdFx0Ly8gaDogMC0zNjBcclxuXHRcdC8vIHM6IDAtMTAwXHJcblx0XHQvLyB2OiAwLTEwMFxyXG5cdFx0Ly8gYTogMC4wLTEuMFxyXG5cdFx0Ly9cclxuXHRcdHRoaXMuZnJvbUhTVkEgPSBmdW5jdGlvbiAoaCwgcywgdiwgYSwgZmxhZ3MpIHsgLy8gbnVsbCA9IGRvbid0IGNoYW5nZVxyXG5cdFx0XHRpZiAoaCA9PT0gdW5kZWZpbmVkKSB7IGggPSBudWxsOyB9XHJcblx0XHRcdGlmIChzID09PSB1bmRlZmluZWQpIHsgcyA9IG51bGw7IH1cclxuXHRcdFx0aWYgKHYgPT09IHVuZGVmaW5lZCkgeyB2ID0gbnVsbDsgfVxyXG5cdFx0XHRpZiAoYSA9PT0gdW5kZWZpbmVkKSB7IGEgPSBudWxsOyB9XHJcblxyXG5cdFx0XHRpZiAoaCAhPT0gbnVsbCkge1xyXG5cdFx0XHRcdGlmIChpc05hTihoKSkgeyByZXR1cm4gZmFsc2U7IH1cclxuXHRcdFx0XHR0aGlzLmNoYW5uZWxzLmggPSBNYXRoLm1heCgwLCBNYXRoLm1pbigzNjAsIGgpKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAocyAhPT0gbnVsbCkge1xyXG5cdFx0XHRcdGlmIChpc05hTihzKSkgeyByZXR1cm4gZmFsc2U7IH1cclxuXHRcdFx0XHR0aGlzLmNoYW5uZWxzLnMgPSBNYXRoLm1heCgwLCBNYXRoLm1pbigxMDAsIHRoaXMubWF4UywgcyksIHRoaXMubWluUyk7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYgKHYgIT09IG51bGwpIHtcclxuXHRcdFx0XHRpZiAoaXNOYU4odikpIHsgcmV0dXJuIGZhbHNlOyB9XHJcblx0XHRcdFx0dGhpcy5jaGFubmVscy52ID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oMTAwLCB0aGlzLm1heFYsIHYpLCB0aGlzLm1pblYpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmIChhICE9PSBudWxsKSB7XHJcblx0XHRcdFx0aWYgKGlzTmFOKGEpKSB7IHJldHVybiBmYWxzZTsgfVxyXG5cdFx0XHRcdHRoaXMuY2hhbm5lbHMuYSA9IHRoaXMuaGFzQWxwaGFDaGFubmVsKCkgP1xyXG5cdFx0XHRcdFx0TWF0aC5tYXgoMCwgTWF0aC5taW4oMSwgdGhpcy5tYXhBLCBhKSwgdGhpcy5taW5BKSA6XHJcblx0XHRcdFx0XHQxLjA7IC8vIGlmIGFscGhhIGNoYW5uZWwgaXMgZGlzYWJsZWQsIHRoZSBjb2xvciBzaG91bGQgc3RheSAxMDAlIG9wYXF1ZVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR2YXIgcmdiID0ganNjLkhTVl9SR0IoXHJcblx0XHRcdFx0dGhpcy5jaGFubmVscy5oLFxyXG5cdFx0XHRcdHRoaXMuY2hhbm5lbHMucyxcclxuXHRcdFx0XHR0aGlzLmNoYW5uZWxzLnZcclxuXHRcdFx0KTtcclxuXHRcdFx0dGhpcy5jaGFubmVscy5yID0gcmdiWzBdO1xyXG5cdFx0XHR0aGlzLmNoYW5uZWxzLmcgPSByZ2JbMV07XHJcblx0XHRcdHRoaXMuY2hhbm5lbHMuYiA9IHJnYlsyXTtcclxuXHJcblx0XHRcdHRoaXMuZXhwb3NlQ29sb3IoZmxhZ3MpO1xyXG5cdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdH07XHJcblxyXG5cclxuXHRcdC8vIHI6IDAtMjU1XHJcblx0XHQvLyBnOiAwLTI1NVxyXG5cdFx0Ly8gYjogMC0yNTVcclxuXHRcdC8vIGE6IDAuMC0xLjBcclxuXHRcdC8vXHJcblx0XHR0aGlzLmZyb21SR0JBID0gZnVuY3Rpb24gKHIsIGcsIGIsIGEsIGZsYWdzKSB7IC8vIG51bGwgPSBkb24ndCBjaGFuZ2VcclxuXHRcdFx0aWYgKHIgPT09IHVuZGVmaW5lZCkgeyByID0gbnVsbDsgfVxyXG5cdFx0XHRpZiAoZyA9PT0gdW5kZWZpbmVkKSB7IGcgPSBudWxsOyB9XHJcblx0XHRcdGlmIChiID09PSB1bmRlZmluZWQpIHsgYiA9IG51bGw7IH1cclxuXHRcdFx0aWYgKGEgPT09IHVuZGVmaW5lZCkgeyBhID0gbnVsbDsgfVxyXG5cclxuXHRcdFx0aWYgKHIgIT09IG51bGwpIHtcclxuXHRcdFx0XHRpZiAoaXNOYU4ocikpIHsgcmV0dXJuIGZhbHNlOyB9XHJcblx0XHRcdFx0ciA9IE1hdGgubWF4KDAsIE1hdGgubWluKDI1NSwgcikpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmIChnICE9PSBudWxsKSB7XHJcblx0XHRcdFx0aWYgKGlzTmFOKGcpKSB7IHJldHVybiBmYWxzZTsgfVxyXG5cdFx0XHRcdGcgPSBNYXRoLm1heCgwLCBNYXRoLm1pbigyNTUsIGcpKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoYiAhPT0gbnVsbCkge1xyXG5cdFx0XHRcdGlmIChpc05hTihiKSkgeyByZXR1cm4gZmFsc2U7IH1cclxuXHRcdFx0XHRiID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oMjU1LCBiKSk7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYgKGEgIT09IG51bGwpIHtcclxuXHRcdFx0XHRpZiAoaXNOYU4oYSkpIHsgcmV0dXJuIGZhbHNlOyB9XHJcblx0XHRcdFx0dGhpcy5jaGFubmVscy5hID0gdGhpcy5oYXNBbHBoYUNoYW5uZWwoKSA/XHJcblx0XHRcdFx0XHRNYXRoLm1heCgwLCBNYXRoLm1pbigxLCB0aGlzLm1heEEsIGEpLCB0aGlzLm1pbkEpIDpcclxuXHRcdFx0XHRcdDEuMDsgLy8gaWYgYWxwaGEgY2hhbm5lbCBpcyBkaXNhYmxlZCwgdGhlIGNvbG9yIHNob3VsZCBzdGF5IDEwMCUgb3BhcXVlXHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHZhciBoc3YgPSBqc2MuUkdCX0hTVihcclxuXHRcdFx0XHRyPT09bnVsbCA/IHRoaXMuY2hhbm5lbHMuciA6IHIsXHJcblx0XHRcdFx0Zz09PW51bGwgPyB0aGlzLmNoYW5uZWxzLmcgOiBnLFxyXG5cdFx0XHRcdGI9PT1udWxsID8gdGhpcy5jaGFubmVscy5iIDogYlxyXG5cdFx0XHQpO1xyXG5cdFx0XHRpZiAoaHN2WzBdICE9PSBudWxsKSB7XHJcblx0XHRcdFx0dGhpcy5jaGFubmVscy5oID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oMzYwLCBoc3ZbMF0pKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoaHN2WzJdICE9PSAwKSB7IC8vIGZ1bGx5IGJsYWNrIGNvbG9yIHN0YXlzIGJsYWNrIHRocm91Z2ggZW50aXJlIHNhdHVyYXRpb24gcmFuZ2UsIHNvIGxldCdzIG5vdCBjaGFuZ2Ugc2F0dXJhdGlvblxyXG5cdFx0XHRcdHRoaXMuY2hhbm5lbHMucyA9IE1hdGgubWF4KDAsIHRoaXMubWluUywgTWF0aC5taW4oMTAwLCB0aGlzLm1heFMsIGhzdlsxXSkpO1xyXG5cdFx0XHR9XHJcblx0XHRcdHRoaXMuY2hhbm5lbHMudiA9IE1hdGgubWF4KDAsIHRoaXMubWluViwgTWF0aC5taW4oMTAwLCB0aGlzLm1heFYsIGhzdlsyXSkpO1xyXG5cclxuXHRcdFx0Ly8gdXBkYXRlIFJHQiBhY2NvcmRpbmcgdG8gZmluYWwgSFNWLCBhcyBzb21lIHZhbHVlcyBtaWdodCBiZSB0cmltbWVkXHJcblx0XHRcdHZhciByZ2IgPSBqc2MuSFNWX1JHQih0aGlzLmNoYW5uZWxzLmgsIHRoaXMuY2hhbm5lbHMucywgdGhpcy5jaGFubmVscy52KTtcclxuXHRcdFx0dGhpcy5jaGFubmVscy5yID0gcmdiWzBdO1xyXG5cdFx0XHR0aGlzLmNoYW5uZWxzLmcgPSByZ2JbMV07XHJcblx0XHRcdHRoaXMuY2hhbm5lbHMuYiA9IHJnYlsyXTtcclxuXHJcblx0XHRcdHRoaXMuZXhwb3NlQ29sb3IoZmxhZ3MpO1xyXG5cdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdH07XHJcblxyXG5cclxuXHRcdC8vIERFUFJFQ0FURUQuIFVzZSAuZnJvbUhTVkEoKSBpbnN0ZWFkXHJcblx0XHQvL1xyXG5cdFx0dGhpcy5mcm9tSFNWID0gZnVuY3Rpb24gKGgsIHMsIHYsIGZsYWdzKSB7XHJcblx0XHRcdGNvbnNvbGUud2FybignZnJvbUhTVigpIG1ldGhvZCBpcyBERVBSRUNBVEVELiBVc2luZyBmcm9tSFNWQSgpIGluc3RlYWQuJyArIGpzYy5kb2NzUmVmKTtcclxuXHRcdFx0cmV0dXJuIHRoaXMuZnJvbUhTVkEoaCwgcywgdiwgbnVsbCwgZmxhZ3MpO1xyXG5cdFx0fTtcclxuXHJcblxyXG5cdFx0Ly8gREVQUkVDQVRFRC4gVXNlIC5mcm9tUkdCQSgpIGluc3RlYWRcclxuXHRcdC8vXHJcblx0XHR0aGlzLmZyb21SR0IgPSBmdW5jdGlvbiAociwgZywgYiwgZmxhZ3MpIHtcclxuXHRcdFx0Y29uc29sZS53YXJuKCdmcm9tUkdCKCkgbWV0aG9kIGlzIERFUFJFQ0FURUQuIFVzaW5nIGZyb21SR0JBKCkgaW5zdGVhZC4nICsganNjLmRvY3NSZWYpO1xyXG5cdFx0XHRyZXR1cm4gdGhpcy5mcm9tUkdCQShyLCBnLCBiLCBudWxsLCBmbGFncyk7XHJcblx0XHR9O1xyXG5cclxuXHJcblx0XHR0aGlzLmZyb21TdHJpbmcgPSBmdW5jdGlvbiAoc3RyLCBmbGFncykge1xyXG5cdFx0XHRpZiAoIXRoaXMucmVxdWlyZWQgJiYgc3RyLnRyaW0oKSA9PT0gJycpIHtcclxuXHRcdFx0XHQvLyBzZXR0aW5nIGVtcHR5IHN0cmluZyB0byBhbiBvcHRpb25hbCBjb2xvciBpbnB1dFxyXG5cdFx0XHRcdHRoaXMuc2V0UHJldmlld0VsZW1lbnRCZyhudWxsKTtcclxuXHRcdFx0XHR0aGlzLnNldFZhbHVlRWxlbWVudFZhbHVlKCcnKTtcclxuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0dmFyIGNvbG9yID0ganNjLnBhcnNlQ29sb3JTdHJpbmcoc3RyKTtcclxuXHRcdFx0aWYgKCFjb2xvcikge1xyXG5cdFx0XHRcdHJldHVybiBmYWxzZTsgLy8gY291bGQgbm90IHBhcnNlXHJcblx0XHRcdH1cclxuXHRcdFx0aWYgKHRoaXMuZm9ybWF0LnRvTG93ZXJDYXNlKCkgPT09ICdhbnknKSB7XHJcblx0XHRcdFx0dGhpcy5fc2V0Rm9ybWF0KGNvbG9yLmZvcm1hdCk7IC8vIGFkYXB0IGZvcm1hdFxyXG5cdFx0XHRcdGlmICghanNjLmlzQWxwaGFGb3JtYXQodGhpcy5nZXRGb3JtYXQoKSkpIHtcclxuXHRcdFx0XHRcdGNvbG9yLnJnYmFbM10gPSAxLjA7IC8vIHdoZW4gc3dpdGNoaW5nIHRvIGEgZm9ybWF0IHRoYXQgZG9lc24ndCBzdXBwb3J0IGFscGhhLCBzZXQgZnVsbCBvcGFjaXR5XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdHRoaXMuZnJvbVJHQkEoXHJcblx0XHRcdFx0Y29sb3IucmdiYVswXSxcclxuXHRcdFx0XHRjb2xvci5yZ2JhWzFdLFxyXG5cdFx0XHRcdGNvbG9yLnJnYmFbMl0sXHJcblx0XHRcdFx0Y29sb3IucmdiYVszXSxcclxuXHRcdFx0XHRmbGFnc1xyXG5cdFx0XHQpO1xyXG5cdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdH07XHJcblxyXG5cclxuXHRcdHRoaXMucmFuZG9taXplID0gZnVuY3Rpb24gKG1pblYsIG1heFYsIG1pblMsIG1heFMsIG1pbkgsIG1heEgsIG1pbkEsIG1heEEpIHtcclxuXHRcdFx0aWYgKG1pblYgPT09IHVuZGVmaW5lZCkgeyBtaW5WID0gMDsgfVxyXG5cdFx0XHRpZiAobWF4ViA9PT0gdW5kZWZpbmVkKSB7IG1heFYgPSAxMDA7IH1cclxuXHRcdFx0aWYgKG1pblMgPT09IHVuZGVmaW5lZCkgeyBtaW5TID0gMDsgfVxyXG5cdFx0XHRpZiAobWF4UyA9PT0gdW5kZWZpbmVkKSB7IG1heFMgPSAxMDA7IH1cclxuXHRcdFx0aWYgKG1pbkggPT09IHVuZGVmaW5lZCkgeyBtaW5IID0gMDsgfVxyXG5cdFx0XHRpZiAobWF4SCA9PT0gdW5kZWZpbmVkKSB7IG1heEggPSAzNTk7IH1cclxuXHRcdFx0aWYgKG1pbkEgPT09IHVuZGVmaW5lZCkgeyBtaW5BID0gMTsgfVxyXG5cdFx0XHRpZiAobWF4QSA9PT0gdW5kZWZpbmVkKSB7IG1heEEgPSAxOyB9XHJcblxyXG5cdFx0XHR0aGlzLmZyb21IU1ZBKFxyXG5cdFx0XHRcdG1pbkggKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAobWF4SCAtIG1pbkggKyAxKSksXHJcblx0XHRcdFx0bWluUyArIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChtYXhTIC0gbWluUyArIDEpKSxcclxuXHRcdFx0XHRtaW5WICsgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKG1heFYgLSBtaW5WICsgMSkpLFxyXG5cdFx0XHRcdCgoMTAwICogbWluQSkgKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAoMTAwICogKG1heEEgLSBtaW5BKSArIDEpKSkgLyAxMDBcclxuXHRcdFx0KTtcclxuXHRcdH07XHJcblxyXG5cclxuXHRcdHRoaXMudG9TdHJpbmcgPSBmdW5jdGlvbiAoZm9ybWF0KSB7XHJcblx0XHRcdGlmIChmb3JtYXQgPT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRcdGZvcm1hdCA9IHRoaXMuZ2V0Rm9ybWF0KCk7IC8vIGZvcm1hdCBub3Qgc3BlY2lmaWVkIC0+IHVzZSB0aGUgY3VycmVudCBmb3JtYXRcclxuXHRcdFx0fVxyXG5cdFx0XHRzd2l0Y2ggKGZvcm1hdC50b0xvd2VyQ2FzZSgpKSB7XHJcblx0XHRcdFx0Y2FzZSAnaGV4JzogcmV0dXJuIHRoaXMudG9IRVhTdHJpbmcoKTsgYnJlYWs7XHJcblx0XHRcdFx0Y2FzZSAnaGV4YSc6IHJldHVybiB0aGlzLnRvSEVYQVN0cmluZygpOyBicmVhaztcclxuXHRcdFx0XHRjYXNlICdyZ2InOiByZXR1cm4gdGhpcy50b1JHQlN0cmluZygpOyBicmVhaztcclxuXHRcdFx0XHRjYXNlICdyZ2JhJzogcmV0dXJuIHRoaXMudG9SR0JBU3RyaW5nKCk7IGJyZWFrO1xyXG5cdFx0XHR9XHJcblx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdH07XHJcblxyXG5cclxuXHRcdHRoaXMudG9IRVhTdHJpbmcgPSBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdHJldHVybiBqc2MuaGV4Q29sb3IoXHJcblx0XHRcdFx0dGhpcy5jaGFubmVscy5yLFxyXG5cdFx0XHRcdHRoaXMuY2hhbm5lbHMuZyxcclxuXHRcdFx0XHR0aGlzLmNoYW5uZWxzLmJcclxuXHRcdFx0KTtcclxuXHRcdH07XHJcblxyXG5cclxuXHRcdHRoaXMudG9IRVhBU3RyaW5nID0gZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRyZXR1cm4ganNjLmhleGFDb2xvcihcclxuXHRcdFx0XHR0aGlzLmNoYW5uZWxzLnIsXHJcblx0XHRcdFx0dGhpcy5jaGFubmVscy5nLFxyXG5cdFx0XHRcdHRoaXMuY2hhbm5lbHMuYixcclxuXHRcdFx0XHR0aGlzLmNoYW5uZWxzLmFcclxuXHRcdFx0KTtcclxuXHRcdH07XHJcblxyXG5cclxuXHRcdHRoaXMudG9SR0JTdHJpbmcgPSBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdHJldHVybiBqc2MucmdiQ29sb3IoXHJcblx0XHRcdFx0dGhpcy5jaGFubmVscy5yLFxyXG5cdFx0XHRcdHRoaXMuY2hhbm5lbHMuZyxcclxuXHRcdFx0XHR0aGlzLmNoYW5uZWxzLmJcclxuXHRcdFx0KTtcclxuXHRcdH07XHJcblxyXG5cclxuXHRcdHRoaXMudG9SR0JBU3RyaW5nID0gZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRyZXR1cm4ganNjLnJnYmFDb2xvcihcclxuXHRcdFx0XHR0aGlzLmNoYW5uZWxzLnIsXHJcblx0XHRcdFx0dGhpcy5jaGFubmVscy5nLFxyXG5cdFx0XHRcdHRoaXMuY2hhbm5lbHMuYixcclxuXHRcdFx0XHR0aGlzLmNoYW5uZWxzLmFcclxuXHRcdFx0KTtcclxuXHRcdH07XHJcblxyXG5cclxuXHRcdHRoaXMudG9HcmF5c2NhbGUgPSBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdHJldHVybiAoXHJcblx0XHRcdFx0MC4yMTMgKiB0aGlzLmNoYW5uZWxzLnIgK1xyXG5cdFx0XHRcdDAuNzE1ICogdGhpcy5jaGFubmVscy5nICtcclxuXHRcdFx0XHQwLjA3MiAqIHRoaXMuY2hhbm5lbHMuYlxyXG5cdFx0XHQpO1xyXG5cdFx0fTtcclxuXHJcblxyXG5cdFx0dGhpcy50b0NhbnZhcyA9IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0cmV0dXJuIGpzYy5nZW5Db2xvclByZXZpZXdDYW52YXModGhpcy50b1JHQkFTdHJpbmcoKSkuY2FudmFzO1xyXG5cdFx0fTtcclxuXHJcblxyXG5cdFx0dGhpcy50b0RhdGFVUkwgPSBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdHJldHVybiB0aGlzLnRvQ2FudmFzKCkudG9EYXRhVVJMKCk7XHJcblx0XHR9O1xyXG5cclxuXHJcblx0XHR0aGlzLnRvQmFja2dyb3VuZCA9IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0cmV0dXJuIGpzYy5wdWIuYmFja2dyb3VuZCh0aGlzLnRvUkdCQVN0cmluZygpKTtcclxuXHRcdH07XHJcblxyXG5cclxuXHRcdHRoaXMuaXNMaWdodCA9IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0cmV0dXJuIHRoaXMudG9HcmF5c2NhbGUoKSA+IDI1NSAvIDI7XHJcblx0XHR9O1xyXG5cclxuXHJcblx0XHR0aGlzLmhpZGUgPSBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdGlmIChpc1BpY2tlck93bmVyKCkpIHtcclxuXHRcdFx0XHRkZXRhY2hQaWNrZXIoKTtcclxuXHRcdFx0fVxyXG5cdFx0fTtcclxuXHJcblxyXG5cdFx0dGhpcy5zaG93ID0gZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRkcmF3UGlja2VyKCk7XHJcblx0XHR9O1xyXG5cclxuXHJcblx0XHR0aGlzLnJlZHJhdyA9IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0aWYgKGlzUGlja2VyT3duZXIoKSkge1xyXG5cdFx0XHRcdGRyYXdQaWNrZXIoKTtcclxuXHRcdFx0fVxyXG5cdFx0fTtcclxuXHJcblxyXG5cdFx0dGhpcy5nZXRGb3JtYXQgPSBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdHJldHVybiB0aGlzLl9jdXJyZW50Rm9ybWF0O1xyXG5cdFx0fTtcclxuXHJcblxyXG5cdFx0dGhpcy5fc2V0Rm9ybWF0ID0gZnVuY3Rpb24gKGZvcm1hdCkge1xyXG5cdFx0XHR0aGlzLl9jdXJyZW50Rm9ybWF0ID0gZm9ybWF0LnRvTG93ZXJDYXNlKCk7XHJcblx0XHR9O1xyXG5cclxuXHJcblx0XHR0aGlzLmhhc0FscGhhQ2hhbm5lbCA9IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0aWYgKHRoaXMuYWxwaGFDaGFubmVsID09PSAnYXV0bycpIHtcclxuXHRcdFx0XHRyZXR1cm4gKFxyXG5cdFx0XHRcdFx0dGhpcy5mb3JtYXQudG9Mb3dlckNhc2UoKSA9PT0gJ2FueScgfHwgLy8gZm9ybWF0IGNhbiBjaGFuZ2Ugb24gdGhlIGZseSAoZS5nLiBmcm9tIGhleCB0byByZ2JhKSwgc28gbGV0J3MgY29uc2lkZXIgdGhlIGFscGhhIGNoYW5uZWwgZW5hYmxlZFxyXG5cdFx0XHRcdFx0anNjLmlzQWxwaGFGb3JtYXQodGhpcy5nZXRGb3JtYXQoKSkgfHwgLy8gdGhlIGN1cnJlbnQgZm9ybWF0IHN1cHBvcnRzIGFscGhhIGNoYW5uZWxcclxuXHRcdFx0XHRcdHRoaXMuYWxwaGEgIT09IHVuZGVmaW5lZCB8fCAvLyBpbml0aWFsIGFscGhhIHZhbHVlIGlzIHNldCwgc28gd2UncmUgd29ya2luZyB3aXRoIGFscGhhIGNoYW5uZWxcclxuXHRcdFx0XHRcdHRoaXMuYWxwaGFFbGVtZW50ICE9PSB1bmRlZmluZWQgLy8gdGhlIGFscGhhIHZhbHVlIGlzIHJlZGlyZWN0ZWQsIHNvIHdlJ3JlIHdvcmtpbmcgd2l0aCBhbHBoYSBjaGFubmVsXHJcblx0XHRcdFx0KTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0cmV0dXJuIHRoaXMuYWxwaGFDaGFubmVsOyAvLyB0aGUgYWxwaGEgY2hhbm5lbCBpcyBleHBsaWNpdGx5IHNldFxyXG5cdFx0fTtcclxuXHJcblxyXG5cdFx0dGhpcy5wcm9jZXNzVmFsdWVJbnB1dCA9IGZ1bmN0aW9uIChzdHIpIHtcclxuXHRcdFx0aWYgKCF0aGlzLmZyb21TdHJpbmcoc3RyKSkge1xyXG5cdFx0XHRcdC8vIGNvdWxkIG5vdCBwYXJzZSB0aGUgY29sb3IgdmFsdWUgLSBsZXQncyBqdXN0IGV4cG9zZSB0aGUgY3VycmVudCBjb2xvclxyXG5cdFx0XHRcdHRoaXMuZXhwb3NlQ29sb3IoKTtcclxuXHRcdFx0fVxyXG5cdFx0fTtcclxuXHJcblxyXG5cdFx0dGhpcy5wcm9jZXNzQWxwaGFJbnB1dCA9IGZ1bmN0aW9uIChzdHIpIHtcclxuXHRcdFx0aWYgKCF0aGlzLmZyb21IU1ZBKG51bGwsIG51bGwsIG51bGwsIHBhcnNlRmxvYXQoc3RyKSkpIHtcclxuXHRcdFx0XHQvLyBjb3VsZCBub3QgcGFyc2UgdGhlIGFscGhhIHZhbHVlIC0gbGV0J3MganVzdCBleHBvc2UgdGhlIGN1cnJlbnQgY29sb3JcclxuXHRcdFx0XHR0aGlzLmV4cG9zZUNvbG9yKCk7XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblxyXG5cclxuXHRcdHRoaXMuZXhwb3NlQ29sb3IgPSBmdW5jdGlvbiAoZmxhZ3MpIHtcclxuXHRcdFx0dmFyIGNvbG9yU3RyID0gdGhpcy50b1N0cmluZygpO1xyXG5cdFx0XHR2YXIgZm10ID0gdGhpcy5nZXRGb3JtYXQoKTtcclxuXHJcblx0XHRcdC8vIHJlZmxlY3QgY3VycmVudCBjb2xvciBpbiBkYXRhLSBhdHRyaWJ1dGVcclxuXHRcdFx0anNjLnNldERhdGFBdHRyKHRoaXMudGFyZ2V0RWxlbWVudCwgJ2N1cnJlbnQtY29sb3InLCBjb2xvclN0cik7XHJcblxyXG5cdFx0XHRpZiAoIShmbGFncyAmIGpzYy5mbGFncy5sZWF2ZVZhbHVlKSAmJiB0aGlzLnZhbHVlRWxlbWVudCkge1xyXG5cdFx0XHRcdGlmIChmbXQgPT09ICdoZXgnIHx8IGZtdCA9PT0gJ2hleGEnKSB7XHJcblx0XHRcdFx0XHRpZiAoIXRoaXMudXBwZXJjYXNlKSB7IGNvbG9yU3RyID0gY29sb3JTdHIudG9Mb3dlckNhc2UoKTsgfVxyXG5cdFx0XHRcdFx0aWYgKCF0aGlzLmhhc2gpIHsgY29sb3JTdHIgPSBjb2xvclN0ci5yZXBsYWNlKC9eIy8sICcnKTsgfVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHR0aGlzLnNldFZhbHVlRWxlbWVudFZhbHVlKGNvbG9yU3RyKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0aWYgKCEoZmxhZ3MgJiBqc2MuZmxhZ3MubGVhdmVBbHBoYSkgJiYgdGhpcy5hbHBoYUVsZW1lbnQpIHtcclxuXHRcdFx0XHR2YXIgYWxwaGFWYWwgPSBNYXRoLnJvdW5kKHRoaXMuY2hhbm5lbHMuYSAqIDEwMCkgLyAxMDA7XHJcblx0XHRcdFx0dGhpcy5zZXRBbHBoYUVsZW1lbnRWYWx1ZShhbHBoYVZhbCk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGlmICghKGZsYWdzICYganNjLmZsYWdzLmxlYXZlUHJldmlldykgJiYgdGhpcy5wcmV2aWV3RWxlbWVudCkge1xyXG5cdFx0XHRcdHZhciBwcmV2aWV3UG9zID0gbnVsbDsgLy8gJ2xlZnQnIHwgJ3JpZ2h0JyAobnVsbCAtPiBmaWxsIHRoZSBlbnRpcmUgZWxlbWVudClcclxuXHJcblx0XHRcdFx0aWYgKFxyXG5cdFx0XHRcdFx0anNjLmlzVGV4dElucHV0KHRoaXMucHJldmlld0VsZW1lbnQpIHx8IC8vIHRleHQgaW5wdXRcclxuXHRcdFx0XHRcdChqc2MuaXNCdXR0b24odGhpcy5wcmV2aWV3RWxlbWVudCkgJiYgIWpzYy5pc0J1dHRvbkVtcHR5KHRoaXMucHJldmlld0VsZW1lbnQpKSAvLyBidXR0b24gd2l0aCB0ZXh0XHJcblx0XHRcdFx0KSB7XHJcblx0XHRcdFx0XHRwcmV2aWV3UG9zID0gdGhpcy5wcmV2aWV3UG9zaXRpb247XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHR0aGlzLnNldFByZXZpZXdFbGVtZW50QmcodGhpcy50b1JHQkFTdHJpbmcoKSk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGlmIChpc1BpY2tlck93bmVyKCkpIHtcclxuXHRcdFx0XHRyZWRyYXdQYWQoKTtcclxuXHRcdFx0XHRyZWRyYXdTbGQoKTtcclxuXHRcdFx0XHRyZWRyYXdBU2xkKCk7XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblxyXG5cclxuXHRcdHRoaXMuc2V0UHJldmlld0VsZW1lbnRCZyA9IGZ1bmN0aW9uIChjb2xvcikge1xyXG5cdFx0XHRpZiAoIXRoaXMucHJldmlld0VsZW1lbnQpIHtcclxuXHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHZhciBwb3NpdGlvbiA9IG51bGw7IC8vIGNvbG9yIHByZXZpZXcgcG9zaXRpb246ICBudWxsIHwgJ2xlZnQnIHwgJ3JpZ2h0J1xyXG5cdFx0XHR2YXIgd2lkdGggPSBudWxsOyAvLyBjb2xvciBwcmV2aWV3IHdpZHRoOiAgcHggfCBudWxsID0gZmlsbCB0aGUgZW50aXJlIGVsZW1lbnRcclxuXHRcdFx0aWYgKFxyXG5cdFx0XHRcdGpzYy5pc1RleHRJbnB1dCh0aGlzLnByZXZpZXdFbGVtZW50KSB8fCAvLyB0ZXh0IGlucHV0XHJcblx0XHRcdFx0KGpzYy5pc0J1dHRvbih0aGlzLnByZXZpZXdFbGVtZW50KSAmJiAhanNjLmlzQnV0dG9uRW1wdHkodGhpcy5wcmV2aWV3RWxlbWVudCkpIC8vIGJ1dHRvbiB3aXRoIHRleHRcclxuXHRcdFx0KSB7XHJcblx0XHRcdFx0cG9zaXRpb24gPSB0aGlzLnByZXZpZXdQb3NpdGlvbjtcclxuXHRcdFx0XHR3aWR0aCA9IHRoaXMucHJldmlld1NpemU7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHZhciBiYWNrZ3JvdW5kcyA9IFtdO1xyXG5cclxuXHRcdFx0aWYgKCFjb2xvcikge1xyXG5cdFx0XHRcdC8vIHRoZXJlIGlzIG5vIGNvbG9yIHByZXZpZXcgdG8gZGlzcGxheSAtPiBsZXQncyByZW1vdmUgYW55IHByZXZpb3VzIGJhY2tncm91bmQgaW1hZ2VcclxuXHRcdFx0XHRiYWNrZ3JvdW5kcy5wdXNoKHtcclxuXHRcdFx0XHRcdGltYWdlOiAnbm9uZScsXHJcblx0XHRcdFx0XHRwb3NpdGlvbjogJ2xlZnQgdG9wJyxcclxuXHRcdFx0XHRcdHNpemU6ICdhdXRvJyxcclxuXHRcdFx0XHRcdHJlcGVhdDogJ25vLXJlcGVhdCcsXHJcblx0XHRcdFx0XHRvcmlnaW46ICdwYWRkaW5nLWJveCcsXHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0Ly8gQ1NTIGdyYWRpZW50IGZvciBiYWNrZ3JvdW5kIGNvbG9yIHByZXZpZXdcclxuXHRcdFx0XHRiYWNrZ3JvdW5kcy5wdXNoKHtcclxuXHRcdFx0XHRcdGltYWdlOiBqc2MuZ2VuQ29sb3JQcmV2aWV3R3JhZGllbnQoXHJcblx0XHRcdFx0XHRcdGNvbG9yLFxyXG5cdFx0XHRcdFx0XHRwb3NpdGlvbixcclxuXHRcdFx0XHRcdFx0d2lkdGggPyB3aWR0aCAtIGpzYy5wdWIucHJldmlld1NlcGFyYXRvci5sZW5ndGggOiBudWxsXHJcblx0XHRcdFx0XHQpLFxyXG5cdFx0XHRcdFx0cG9zaXRpb246ICdsZWZ0IHRvcCcsXHJcblx0XHRcdFx0XHRzaXplOiAnYXV0bycsXHJcblx0XHRcdFx0XHRyZXBlYXQ6IHBvc2l0aW9uID8gJ3JlcGVhdC15JyA6ICdyZXBlYXQnLFxyXG5cdFx0XHRcdFx0b3JpZ2luOiAncGFkZGluZy1ib3gnLFxyXG5cdFx0XHRcdH0pO1xyXG5cclxuXHRcdFx0XHQvLyBkYXRhIFVSTCBvZiBnZW5lcmF0ZWQgUE5HIGltYWdlIHdpdGggYSBncmF5IHRyYW5zcGFyZW5jeSBjaGVzc2JvYXJkXHJcblx0XHRcdFx0dmFyIHByZXZpZXcgPSBqc2MuZ2VuQ29sb3JQcmV2aWV3Q2FudmFzKFxyXG5cdFx0XHRcdFx0J3JnYmEoMCwwLDAsMCknLFxyXG5cdFx0XHRcdFx0cG9zaXRpb24gPyB7J2xlZnQnOidyaWdodCcsICdyaWdodCc6J2xlZnQnfVtwb3NpdGlvbl0gOiBudWxsLFxyXG5cdFx0XHRcdFx0d2lkdGgsXHJcblx0XHRcdFx0XHR0cnVlXHJcblx0XHRcdFx0KTtcclxuXHRcdFx0XHRiYWNrZ3JvdW5kcy5wdXNoKHtcclxuXHRcdFx0XHRcdGltYWdlOiAndXJsKFxcJycgKyBwcmV2aWV3LmNhbnZhcy50b0RhdGFVUkwoKSArICdcXCcpJyxcclxuXHRcdFx0XHRcdHBvc2l0aW9uOiAocG9zaXRpb24gfHwgJ2xlZnQnKSArICcgdG9wJyxcclxuXHRcdFx0XHRcdHNpemU6IHByZXZpZXcud2lkdGggKyAncHggJyArIHByZXZpZXcuaGVpZ2h0ICsgJ3B4JyxcclxuXHRcdFx0XHRcdHJlcGVhdDogcG9zaXRpb24gPyAncmVwZWF0LXknIDogJ3JlcGVhdCcsXHJcblx0XHRcdFx0XHRvcmlnaW46ICdwYWRkaW5nLWJveCcsXHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHZhciBiZyA9IHtcclxuXHRcdFx0XHRpbWFnZTogW10sXHJcblx0XHRcdFx0cG9zaXRpb246IFtdLFxyXG5cdFx0XHRcdHNpemU6IFtdLFxyXG5cdFx0XHRcdHJlcGVhdDogW10sXHJcblx0XHRcdFx0b3JpZ2luOiBbXSxcclxuXHRcdFx0fTtcclxuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBiYWNrZ3JvdW5kcy5sZW5ndGg7IGkgKz0gMSkge1xyXG5cdFx0XHRcdGJnLmltYWdlLnB1c2goYmFja2dyb3VuZHNbaV0uaW1hZ2UpO1xyXG5cdFx0XHRcdGJnLnBvc2l0aW9uLnB1c2goYmFja2dyb3VuZHNbaV0ucG9zaXRpb24pO1xyXG5cdFx0XHRcdGJnLnNpemUucHVzaChiYWNrZ3JvdW5kc1tpXS5zaXplKTtcclxuXHRcdFx0XHRiZy5yZXBlYXQucHVzaChiYWNrZ3JvdW5kc1tpXS5yZXBlYXQpO1xyXG5cdFx0XHRcdGJnLm9yaWdpbi5wdXNoKGJhY2tncm91bmRzW2ldLm9yaWdpbik7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdC8vIHNldCBwcmV2aWV3RWxlbWVudCdzIGJhY2tncm91bmQtaW1hZ2VzXHJcblx0XHRcdHZhciBzdHkgPSB7XHJcblx0XHRcdFx0J2JhY2tncm91bmQtaW1hZ2UnOiBiZy5pbWFnZS5qb2luKCcsICcpLFxyXG5cdFx0XHRcdCdiYWNrZ3JvdW5kLXBvc2l0aW9uJzogYmcucG9zaXRpb24uam9pbignLCAnKSxcclxuXHRcdFx0XHQnYmFja2dyb3VuZC1zaXplJzogYmcuc2l6ZS5qb2luKCcsICcpLFxyXG5cdFx0XHRcdCdiYWNrZ3JvdW5kLXJlcGVhdCc6IGJnLnJlcGVhdC5qb2luKCcsICcpLFxyXG5cdFx0XHRcdCdiYWNrZ3JvdW5kLW9yaWdpbic6IGJnLm9yaWdpbi5qb2luKCcsICcpLFxyXG5cdFx0XHR9O1xyXG5cdFx0XHRqc2Muc2V0U3R5bGUodGhpcy5wcmV2aWV3RWxlbWVudCwgc3R5LCB0aGlzLmZvcmNlU3R5bGUpO1xyXG5cclxuXHJcblx0XHRcdC8vIHNldC9yZXN0b3JlIHByZXZpZXdFbGVtZW50J3MgcGFkZGluZ1xyXG5cdFx0XHR2YXIgcGFkZGluZyA9IHtcclxuXHRcdFx0XHRsZWZ0OiBudWxsLFxyXG5cdFx0XHRcdHJpZ2h0OiBudWxsLFxyXG5cdFx0XHR9O1xyXG5cdFx0XHRpZiAocG9zaXRpb24pIHtcclxuXHRcdFx0XHRwYWRkaW5nW3Bvc2l0aW9uXSA9ICh0aGlzLnByZXZpZXdTaXplICsgdGhpcy5wcmV2aWV3UGFkZGluZykgKyAncHgnO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR2YXIgc3R5ID0ge1xyXG5cdFx0XHRcdCdwYWRkaW5nLWxlZnQnOiBwYWRkaW5nLmxlZnQsXHJcblx0XHRcdFx0J3BhZGRpbmctcmlnaHQnOiBwYWRkaW5nLnJpZ2h0LFxyXG5cdFx0XHR9O1xyXG5cdFx0XHRqc2Muc2V0U3R5bGUodGhpcy5wcmV2aWV3RWxlbWVudCwgc3R5LCB0aGlzLmZvcmNlU3R5bGUsIHRydWUpO1xyXG5cdFx0fTtcclxuXHJcblxyXG5cdFx0dGhpcy5zZXRWYWx1ZUVsZW1lbnRWYWx1ZSA9IGZ1bmN0aW9uIChzdHIpIHtcclxuXHRcdFx0aWYgKHRoaXMudmFsdWVFbGVtZW50KSB7XHJcblx0XHRcdFx0aWYgKGpzYy5ub2RlTmFtZSh0aGlzLnZhbHVlRWxlbWVudCkgPT09ICdpbnB1dCcpIHtcclxuXHRcdFx0XHRcdHRoaXMudmFsdWVFbGVtZW50LnZhbHVlID0gc3RyO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHR0aGlzLnZhbHVlRWxlbWVudC5pbm5lckhUTUwgPSBzdHI7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9O1xyXG5cclxuXHJcblx0XHR0aGlzLnNldEFscGhhRWxlbWVudFZhbHVlID0gZnVuY3Rpb24gKHN0cikge1xyXG5cdFx0XHRpZiAodGhpcy5hbHBoYUVsZW1lbnQpIHtcclxuXHRcdFx0XHRpZiAoanNjLm5vZGVOYW1lKHRoaXMuYWxwaGFFbGVtZW50KSA9PT0gJ2lucHV0Jykge1xyXG5cdFx0XHRcdFx0dGhpcy5hbHBoYUVsZW1lbnQudmFsdWUgPSBzdHI7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdHRoaXMuYWxwaGFFbGVtZW50LmlubmVySFRNTCA9IHN0cjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblxyXG5cclxuXHRcdHRoaXMuX3Byb2Nlc3NQYXJlbnRFbGVtZW50c0luRE9NID0gZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRpZiAodGhpcy5fcGFyZW50RWxlbWVudHNQcm9jZXNzZWQpIHsgcmV0dXJuOyB9XHJcblx0XHRcdHRoaXMuX3BhcmVudEVsZW1lbnRzUHJvY2Vzc2VkID0gdHJ1ZTtcclxuXHJcblx0XHRcdHZhciBlbG0gPSB0aGlzLnRhcmdldEVsZW1lbnQ7XHJcblx0XHRcdGRvIHtcclxuXHRcdFx0XHQvLyBJZiB0aGUgdGFyZ2V0IGVsZW1lbnQgb3Igb25lIG9mIGl0cyBwYXJlbnQgbm9kZXMgaGFzIGZpeGVkIHBvc2l0aW9uLFxyXG5cdFx0XHRcdC8vIHRoZW4gdXNlIGZpeGVkIHBvc2l0aW9uaW5nIGluc3RlYWRcclxuXHRcdFx0XHR2YXIgY29tcFN0eWxlID0ganNjLmdldENvbXBTdHlsZShlbG0pO1xyXG5cdFx0XHRcdGlmIChjb21wU3R5bGUucG9zaXRpb24gJiYgY29tcFN0eWxlLnBvc2l0aW9uLnRvTG93ZXJDYXNlKCkgPT09ICdmaXhlZCcpIHtcclxuXHRcdFx0XHRcdHRoaXMuZml4ZWQgPSB0cnVlO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0aWYgKGVsbSAhPT0gdGhpcy50YXJnZXRFbGVtZW50KSB7XHJcblx0XHRcdFx0XHQvLyBFbnN1cmUgdG8gYXR0YWNoIG9uUGFyZW50U2Nyb2xsIG9ubHkgb25jZSB0byBlYWNoIHBhcmVudCBlbGVtZW50XHJcblx0XHRcdFx0XHQvLyAobXVsdGlwbGUgdGFyZ2V0RWxlbWVudHMgY2FuIHNoYXJlIHRoZSBzYW1lIHBhcmVudCBub2RlcylcclxuXHRcdFx0XHRcdC8vXHJcblx0XHRcdFx0XHQvLyBOb3RlOiBJdCdzIG5vdCBqdXN0IG9mZnNldFBhcmVudHMgdGhhdCBjYW4gYmUgc2Nyb2xsYWJsZSxcclxuXHRcdFx0XHRcdC8vIHRoYXQncyB3aHkgd2UgbG9vcCB0aHJvdWdoIGFsbCBwYXJlbnQgbm9kZXNcclxuXHRcdFx0XHRcdGlmICghanNjLmdldERhdGEoZWxtLCAnaGFzU2Nyb2xsTGlzdGVuZXInKSkge1xyXG5cdFx0XHRcdFx0XHRlbG0uYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywganNjLm9uUGFyZW50U2Nyb2xsLCBmYWxzZSk7XHJcblx0XHRcdFx0XHRcdGpzYy5zZXREYXRhKGVsbSwgJ2hhc1Njcm9sbExpc3RlbmVyJywgdHJ1ZSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9IHdoaWxlICgoZWxtID0gZWxtLnBhcmVudE5vZGUpICYmIGpzYy5ub2RlTmFtZShlbG0pICE9PSAnYm9keScpO1xyXG5cdFx0fTtcclxuXHJcblxyXG5cdFx0dGhpcy50cnlIaWRlID0gZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRpZiAodGhpcy5oaWRlT25MZWF2ZSkge1xyXG5cdFx0XHRcdHRoaXMuaGlkZSgpO1xyXG5cdFx0XHR9XHJcblx0XHR9O1xyXG5cclxuXHJcblx0XHR0aGlzLnNldF9fcGFsZXR0ZSA9IGZ1bmN0aW9uICh2YWwpIHtcclxuXHRcdFx0dGhpcy5wYWxldHRlID0gdmFsO1xyXG5cdFx0XHR0aGlzLl9wYWxldHRlID0ganNjLnBhcnNlUGFsZXR0ZVZhbHVlKHZhbCk7XHJcblx0XHRcdHRoaXMuX3BhbGV0dGVIYXNUcmFuc3BhcmVuY3kgPSBqc2MuY29udGFpbnNUcmFucGFyZW50Q29sb3IodGhpcy5fcGFsZXR0ZSk7XHJcblx0XHR9O1xyXG5cclxuXHJcblx0XHRmdW5jdGlvbiBzZXRPcHRpb24gKG9wdGlvbiwgdmFsdWUpIHtcclxuXHRcdFx0aWYgKHR5cGVvZiBvcHRpb24gIT09ICdzdHJpbmcnKSB7XHJcblx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHZhbHVlIGZvciBvcHRpb24gbmFtZTogJyArIG9wdGlvbik7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdC8vIGVudW0gb3B0aW9uXHJcblx0XHRcdGlmIChqc2MuZW51bU9wdHMuaGFzT3duUHJvcGVydHkob3B0aW9uKSkge1xyXG5cdFx0XHRcdGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7IC8vIGVudW0gc3RyaW5nIHZhbHVlcyBhcmUgY2FzZSBpbnNlbnNpdGl2ZVxyXG5cdFx0XHRcdFx0dmFsdWUgPSB2YWx1ZS50b0xvd2VyQ2FzZSgpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZiAoanNjLmVudW1PcHRzW29wdGlvbl0uaW5kZXhPZih2YWx1ZSkgPT09IC0xKSB7XHJcblx0XHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ09wdGlvbiBcXCcnICsgb3B0aW9uICsgJ1xcJyBoYXMgaW52YWxpZCB2YWx1ZTogJyArIHZhbHVlKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdC8vIGRlcHJlY2F0ZWQgb3B0aW9uXHJcblx0XHRcdGlmIChqc2MuZGVwcmVjYXRlZE9wdHMuaGFzT3duUHJvcGVydHkob3B0aW9uKSkge1xyXG5cdFx0XHRcdHZhciBvbGRPcHQgPSBvcHRpb247XHJcblx0XHRcdFx0dmFyIG5ld09wdCA9IGpzYy5kZXByZWNhdGVkT3B0c1tvcHRpb25dO1xyXG5cdFx0XHRcdGlmIChuZXdPcHQpIHtcclxuXHRcdFx0XHRcdC8vIGlmIHdlIGhhdmUgYSBuZXcgbmFtZSBmb3IgdGhpcyBvcHRpb24sIGxldCdzIGxvZyBhIHdhcm5pbmcgYW5kIHVzZSB0aGUgbmV3IG5hbWVcclxuXHRcdFx0XHRcdGNvbnNvbGUud2FybignT3B0aW9uIFxcJyVzXFwnIGlzIERFUFJFQ0FURUQsIHVzaW5nIFxcJyVzXFwnIGluc3RlYWQuJyArIGpzYy5kb2NzUmVmLCBvbGRPcHQsIG5ld09wdCk7XHJcblx0XHRcdFx0XHRvcHRpb24gPSBuZXdPcHQ7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdC8vIG5ldyBuYW1lIG5vdCBhdmFpbGFibGUgZm9yIHRoZSBvcHRpb25cclxuXHRcdFx0XHRcdHRocm93IG5ldyBFcnJvcignT3B0aW9uIFxcJycgKyBvcHRpb24gKyAnXFwnIGlzIERFUFJFQ0FURUQnKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHZhciBzZXR0ZXIgPSAnc2V0X18nICsgb3B0aW9uO1xyXG5cclxuXHRcdFx0aWYgKHR5cGVvZiBUSElTW3NldHRlcl0gPT09ICdmdW5jdGlvbicpIHsgLy8gYSBzZXR0ZXIgZXhpc3RzIGZvciB0aGlzIG9wdGlvblxyXG5cdFx0XHRcdFRISVNbc2V0dGVyXSh2YWx1ZSk7XHJcblx0XHRcdFx0cmV0dXJuIHRydWU7XHJcblxyXG5cdFx0XHR9IGVsc2UgaWYgKG9wdGlvbiBpbiBUSElTKSB7IC8vIG9wdGlvbiBleGlzdHMgYXMgYSBwcm9wZXJ0eVxyXG5cdFx0XHRcdFRISVNbb3B0aW9uXSA9IHZhbHVlO1xyXG5cdFx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ1VucmVjb2duaXplZCBjb25maWd1cmF0aW9uIG9wdGlvbjogJyArIG9wdGlvbik7XHJcblx0XHR9XHJcblxyXG5cclxuXHRcdGZ1bmN0aW9uIGdldE9wdGlvbiAob3B0aW9uKSB7XHJcblx0XHRcdGlmICh0eXBlb2Ygb3B0aW9uICE9PSAnc3RyaW5nJykge1xyXG5cdFx0XHRcdHRocm93IG5ldyBFcnJvcignSW52YWxpZCB2YWx1ZSBmb3Igb3B0aW9uIG5hbWU6ICcgKyBvcHRpb24pO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHQvLyBkZXByZWNhdGVkIG9wdGlvblxyXG5cdFx0XHRpZiAoanNjLmRlcHJlY2F0ZWRPcHRzLmhhc093blByb3BlcnR5KG9wdGlvbikpIHtcclxuXHRcdFx0XHR2YXIgb2xkT3B0ID0gb3B0aW9uO1xyXG5cdFx0XHRcdHZhciBuZXdPcHQgPSBqc2MuZGVwcmVjYXRlZE9wdHNbb3B0aW9uXTtcclxuXHRcdFx0XHRpZiAobmV3T3B0KSB7XHJcblx0XHRcdFx0XHQvLyBpZiB3ZSBoYXZlIGEgbmV3IG5hbWUgZm9yIHRoaXMgb3B0aW9uLCBsZXQncyBsb2cgYSB3YXJuaW5nIGFuZCB1c2UgdGhlIG5ldyBuYW1lXHJcblx0XHRcdFx0XHRjb25zb2xlLndhcm4oJ09wdGlvbiBcXCclc1xcJyBpcyBERVBSRUNBVEVELCB1c2luZyBcXCclc1xcJyBpbnN0ZWFkLicgKyBqc2MuZG9jc1JlZiwgb2xkT3B0LCBuZXdPcHQpO1xyXG5cdFx0XHRcdFx0b3B0aW9uID0gbmV3T3B0O1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHQvLyBuZXcgbmFtZSBub3QgYXZhaWxhYmxlIGZvciB0aGUgb3B0aW9uXHJcblx0XHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ09wdGlvbiBcXCcnICsgb3B0aW9uICsgJ1xcJyBpcyBERVBSRUNBVEVEJyk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR2YXIgZ2V0dGVyID0gJ2dldF9fJyArIG9wdGlvbjtcclxuXHJcblx0XHRcdGlmICh0eXBlb2YgVEhJU1tnZXR0ZXJdID09PSAnZnVuY3Rpb24nKSB7IC8vIGEgZ2V0dGVyIGV4aXN0cyBmb3IgdGhpcyBvcHRpb25cclxuXHRcdFx0XHRyZXR1cm4gVEhJU1tnZXR0ZXJdKHZhbHVlKTtcclxuXHJcblx0XHRcdH0gZWxzZSBpZiAob3B0aW9uIGluIFRISVMpIHsgLy8gb3B0aW9uIGV4aXN0cyBhcyBhIHByb3BlcnR5XHJcblx0XHRcdFx0cmV0dXJuIFRISVNbb3B0aW9uXTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdVbnJlY29nbml6ZWQgY29uZmlndXJhdGlvbiBvcHRpb246ICcgKyBvcHRpb24pO1xyXG5cdFx0fVxyXG5cclxuXHJcblx0XHRmdW5jdGlvbiBkZXRhY2hQaWNrZXIgKCkge1xyXG5cdFx0XHRqc2MucmVtb3ZlQ2xhc3MoVEhJUy50YXJnZXRFbGVtZW50LCBqc2MucHViLmFjdGl2ZUNsYXNzTmFtZSk7XHJcblx0XHRcdGpzYy5waWNrZXIud3JhcC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGpzYy5waWNrZXIud3JhcCk7XHJcblx0XHRcdGRlbGV0ZSBqc2MucGlja2VyLm93bmVyO1xyXG5cdFx0fVxyXG5cclxuXHJcblx0XHRmdW5jdGlvbiBkcmF3UGlja2VyICgpIHtcclxuXHJcblx0XHRcdC8vIEF0IHRoaXMgcG9pbnQsIHdoZW4gZHJhd2luZyB0aGUgcGlja2VyLCB3ZSBrbm93IHdoYXQgdGhlIHBhcmVudCBlbGVtZW50cyBhcmVcclxuXHRcdFx0Ly8gYW5kIHdlIGNhbiBkbyBhbGwgcmVsYXRlZCBET00gb3BlcmF0aW9ucywgc3VjaCBhcyByZWdpc3RlcmluZyBldmVudHMgb24gdGhlbVxyXG5cdFx0XHQvLyBvciBjaGVja2luZyB0aGVpciBwb3NpdGlvbmluZ1xyXG5cdFx0XHRUSElTLl9wcm9jZXNzUGFyZW50RWxlbWVudHNJbkRPTSgpO1xyXG5cclxuXHRcdFx0aWYgKCFqc2MucGlja2VyKSB7XHJcblx0XHRcdFx0anNjLnBpY2tlciA9IHtcclxuXHRcdFx0XHRcdG93bmVyOiBudWxsLCAvLyBvd25lciBwaWNrZXIgaW5zdGFuY2VcclxuXHRcdFx0XHRcdHdyYXAgOiBqc2MuY3JlYXRlRWwoJ2RpdicpLFxyXG5cdFx0XHRcdFx0Ym94IDoganNjLmNyZWF0ZUVsKCdkaXYnKSxcclxuXHRcdFx0XHRcdGJveFMgOiBqc2MuY3JlYXRlRWwoJ2RpdicpLCAvLyBzaGFkb3cgYXJlYVxyXG5cdFx0XHRcdFx0Ym94QiA6IGpzYy5jcmVhdGVFbCgnZGl2JyksIC8vIGJvcmRlclxyXG5cdFx0XHRcdFx0cGFkIDoganNjLmNyZWF0ZUVsKCdkaXYnKSxcclxuXHRcdFx0XHRcdHBhZEIgOiBqc2MuY3JlYXRlRWwoJ2RpdicpLCAvLyBib3JkZXJcclxuXHRcdFx0XHRcdHBhZE0gOiBqc2MuY3JlYXRlRWwoJ2RpdicpLCAvLyBtb3VzZS90b3VjaCBhcmVhXHJcblx0XHRcdFx0XHRwYWRDYW52YXMgOiBqc2MuY3JlYXRlUGFkQ2FudmFzKCksXHJcblx0XHRcdFx0XHRjcm9zcyA6IGpzYy5jcmVhdGVFbCgnZGl2JyksXHJcblx0XHRcdFx0XHRjcm9zc0JZIDoganNjLmNyZWF0ZUVsKCdkaXYnKSwgLy8gYm9yZGVyIFlcclxuXHRcdFx0XHRcdGNyb3NzQlggOiBqc2MuY3JlYXRlRWwoJ2RpdicpLCAvLyBib3JkZXIgWFxyXG5cdFx0XHRcdFx0Y3Jvc3NMWSA6IGpzYy5jcmVhdGVFbCgnZGl2JyksIC8vIGxpbmUgWVxyXG5cdFx0XHRcdFx0Y3Jvc3NMWCA6IGpzYy5jcmVhdGVFbCgnZGl2JyksIC8vIGxpbmUgWFxyXG5cdFx0XHRcdFx0c2xkIDoganNjLmNyZWF0ZUVsKCdkaXYnKSwgLy8gc2xpZGVyXHJcblx0XHRcdFx0XHRzbGRCIDoganNjLmNyZWF0ZUVsKCdkaXYnKSwgLy8gYm9yZGVyXHJcblx0XHRcdFx0XHRzbGRNIDoganNjLmNyZWF0ZUVsKCdkaXYnKSwgLy8gbW91c2UvdG91Y2ggYXJlYVxyXG5cdFx0XHRcdFx0c2xkR3JhZCA6IGpzYy5jcmVhdGVTbGlkZXJHcmFkaWVudCgpLFxyXG5cdFx0XHRcdFx0c2xkUHRyUyA6IGpzYy5jcmVhdGVFbCgnZGl2JyksIC8vIHNsaWRlciBwb2ludGVyIHNwYWNlclxyXG5cdFx0XHRcdFx0c2xkUHRySUIgOiBqc2MuY3JlYXRlRWwoJ2RpdicpLCAvLyBzbGlkZXIgcG9pbnRlciBpbm5lciBib3JkZXJcclxuXHRcdFx0XHRcdHNsZFB0ck1CIDoganNjLmNyZWF0ZUVsKCdkaXYnKSwgLy8gc2xpZGVyIHBvaW50ZXIgbWlkZGxlIGJvcmRlclxyXG5cdFx0XHRcdFx0c2xkUHRyT0IgOiBqc2MuY3JlYXRlRWwoJ2RpdicpLCAvLyBzbGlkZXIgcG9pbnRlciBvdXRlciBib3JkZXJcclxuXHRcdFx0XHRcdGFzbGQgOiBqc2MuY3JlYXRlRWwoJ2RpdicpLCAvLyBhbHBoYSBzbGlkZXJcclxuXHRcdFx0XHRcdGFzbGRCIDoganNjLmNyZWF0ZUVsKCdkaXYnKSwgLy8gYm9yZGVyXHJcblx0XHRcdFx0XHRhc2xkTSA6IGpzYy5jcmVhdGVFbCgnZGl2JyksIC8vIG1vdXNlL3RvdWNoIGFyZWFcclxuXHRcdFx0XHRcdGFzbGRHcmFkIDoganNjLmNyZWF0ZUFTbGlkZXJHcmFkaWVudCgpLFxyXG5cdFx0XHRcdFx0YXNsZFB0clMgOiBqc2MuY3JlYXRlRWwoJ2RpdicpLCAvLyBzbGlkZXIgcG9pbnRlciBzcGFjZXJcclxuXHRcdFx0XHRcdGFzbGRQdHJJQiA6IGpzYy5jcmVhdGVFbCgnZGl2JyksIC8vIHNsaWRlciBwb2ludGVyIGlubmVyIGJvcmRlclxyXG5cdFx0XHRcdFx0YXNsZFB0ck1CIDoganNjLmNyZWF0ZUVsKCdkaXYnKSwgLy8gc2xpZGVyIHBvaW50ZXIgbWlkZGxlIGJvcmRlclxyXG5cdFx0XHRcdFx0YXNsZFB0ck9CIDoganNjLmNyZWF0ZUVsKCdkaXYnKSwgLy8gc2xpZGVyIHBvaW50ZXIgb3V0ZXIgYm9yZGVyXHJcblx0XHRcdFx0XHRwYWwgOiBqc2MuY3JlYXRlRWwoJ2RpdicpLCAvLyBwYWxldHRlXHJcblx0XHRcdFx0XHRidG4gOiBqc2MuY3JlYXRlRWwoJ2RpdicpLFxyXG5cdFx0XHRcdFx0YnRuVCA6IGpzYy5jcmVhdGVFbCgnZGl2JyksIC8vIHRleHRcclxuXHRcdFx0XHR9O1xyXG5cclxuXHRcdFx0XHRqc2MucGlja2VyLnBhZC5hcHBlbmRDaGlsZChqc2MucGlja2VyLnBhZENhbnZhcy5lbG0pO1xyXG5cdFx0XHRcdGpzYy5waWNrZXIucGFkQi5hcHBlbmRDaGlsZChqc2MucGlja2VyLnBhZCk7XHJcblx0XHRcdFx0anNjLnBpY2tlci5jcm9zcy5hcHBlbmRDaGlsZChqc2MucGlja2VyLmNyb3NzQlkpO1xyXG5cdFx0XHRcdGpzYy5waWNrZXIuY3Jvc3MuYXBwZW5kQ2hpbGQoanNjLnBpY2tlci5jcm9zc0JYKTtcclxuXHRcdFx0XHRqc2MucGlja2VyLmNyb3NzLmFwcGVuZENoaWxkKGpzYy5waWNrZXIuY3Jvc3NMWSk7XHJcblx0XHRcdFx0anNjLnBpY2tlci5jcm9zcy5hcHBlbmRDaGlsZChqc2MucGlja2VyLmNyb3NzTFgpO1xyXG5cdFx0XHRcdGpzYy5waWNrZXIucGFkQi5hcHBlbmRDaGlsZChqc2MucGlja2VyLmNyb3NzKTtcclxuXHRcdFx0XHRqc2MucGlja2VyLmJveC5hcHBlbmRDaGlsZChqc2MucGlja2VyLnBhZEIpO1xyXG5cdFx0XHRcdGpzYy5waWNrZXIuYm94LmFwcGVuZENoaWxkKGpzYy5waWNrZXIucGFkTSk7XHJcblxyXG5cdFx0XHRcdGpzYy5waWNrZXIuc2xkLmFwcGVuZENoaWxkKGpzYy5waWNrZXIuc2xkR3JhZC5lbG0pO1xyXG5cdFx0XHRcdGpzYy5waWNrZXIuc2xkQi5hcHBlbmRDaGlsZChqc2MucGlja2VyLnNsZCk7XHJcblx0XHRcdFx0anNjLnBpY2tlci5zbGRCLmFwcGVuZENoaWxkKGpzYy5waWNrZXIuc2xkUHRyT0IpO1xyXG5cdFx0XHRcdGpzYy5waWNrZXIuc2xkUHRyT0IuYXBwZW5kQ2hpbGQoanNjLnBpY2tlci5zbGRQdHJNQik7XHJcblx0XHRcdFx0anNjLnBpY2tlci5zbGRQdHJNQi5hcHBlbmRDaGlsZChqc2MucGlja2VyLnNsZFB0cklCKTtcclxuXHRcdFx0XHRqc2MucGlja2VyLnNsZFB0cklCLmFwcGVuZENoaWxkKGpzYy5waWNrZXIuc2xkUHRyUyk7XHJcblx0XHRcdFx0anNjLnBpY2tlci5ib3guYXBwZW5kQ2hpbGQoanNjLnBpY2tlci5zbGRCKTtcclxuXHRcdFx0XHRqc2MucGlja2VyLmJveC5hcHBlbmRDaGlsZChqc2MucGlja2VyLnNsZE0pO1xyXG5cclxuXHRcdFx0XHRqc2MucGlja2VyLmFzbGQuYXBwZW5kQ2hpbGQoanNjLnBpY2tlci5hc2xkR3JhZC5lbG0pO1xyXG5cdFx0XHRcdGpzYy5waWNrZXIuYXNsZEIuYXBwZW5kQ2hpbGQoanNjLnBpY2tlci5hc2xkKTtcclxuXHRcdFx0XHRqc2MucGlja2VyLmFzbGRCLmFwcGVuZENoaWxkKGpzYy5waWNrZXIuYXNsZFB0ck9CKTtcclxuXHRcdFx0XHRqc2MucGlja2VyLmFzbGRQdHJPQi5hcHBlbmRDaGlsZChqc2MucGlja2VyLmFzbGRQdHJNQik7XHJcblx0XHRcdFx0anNjLnBpY2tlci5hc2xkUHRyTUIuYXBwZW5kQ2hpbGQoanNjLnBpY2tlci5hc2xkUHRySUIpO1xyXG5cdFx0XHRcdGpzYy5waWNrZXIuYXNsZFB0cklCLmFwcGVuZENoaWxkKGpzYy5waWNrZXIuYXNsZFB0clMpO1xyXG5cdFx0XHRcdGpzYy5waWNrZXIuYm94LmFwcGVuZENoaWxkKGpzYy5waWNrZXIuYXNsZEIpO1xyXG5cdFx0XHRcdGpzYy5waWNrZXIuYm94LmFwcGVuZENoaWxkKGpzYy5waWNrZXIuYXNsZE0pO1xyXG5cclxuXHRcdFx0XHRqc2MucGlja2VyLmJveC5hcHBlbmRDaGlsZChqc2MucGlja2VyLnBhbCk7XHJcblxyXG5cdFx0XHRcdGpzYy5waWNrZXIuYnRuLmFwcGVuZENoaWxkKGpzYy5waWNrZXIuYnRuVCk7XHJcblx0XHRcdFx0anNjLnBpY2tlci5ib3guYXBwZW5kQ2hpbGQoanNjLnBpY2tlci5idG4pO1xyXG5cclxuXHRcdFx0XHRqc2MucGlja2VyLmJveEIuYXBwZW5kQ2hpbGQoanNjLnBpY2tlci5ib3gpO1xyXG5cdFx0XHRcdGpzYy5waWNrZXIud3JhcC5hcHBlbmRDaGlsZChqc2MucGlja2VyLmJveFMpO1xyXG5cdFx0XHRcdGpzYy5waWNrZXIud3JhcC5hcHBlbmRDaGlsZChqc2MucGlja2VyLmJveEIpO1xyXG5cclxuXHRcdFx0XHRqc2MucGlja2VyLndyYXAuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIGpzYy5vblBpY2tlclRvdWNoU3RhcnQsXHJcblx0XHRcdFx0XHRqc2MuaXNQYXNzaXZlRXZlbnRTdXBwb3J0ZWQgPyB7cGFzc2l2ZTogZmFsc2V9IDogZmFsc2UpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR2YXIgcCA9IGpzYy5waWNrZXI7XHJcblxyXG5cdFx0XHR2YXIgZGlzcGxheVNsaWRlciA9ICEhanNjLmdldFNsaWRlckNoYW5uZWwoVEhJUyk7XHJcblx0XHRcdHZhciBkaXNwbGF5QWxwaGFTbGlkZXIgPSBUSElTLmhhc0FscGhhQ2hhbm5lbCgpO1xyXG5cdFx0XHR2YXIgcGlja2VyRGltcyA9IGpzYy5nZXRQaWNrZXJEaW1zKFRISVMpO1xyXG5cdFx0XHR2YXIgY3Jvc3NPdXRlclNpemUgPSAoMiAqIFRISVMucG9pbnRlckJvcmRlcldpZHRoICsgVEhJUy5wb2ludGVyVGhpY2tuZXNzICsgMiAqIFRISVMuY3Jvc3NTaXplKTtcclxuXHRcdFx0dmFyIGNvbnRyb2xQYWRkaW5nID0ganNjLmdldENvbnRyb2xQYWRkaW5nKFRISVMpO1xyXG5cdFx0XHR2YXIgYm9yZGVyUmFkaXVzID0gTWF0aC5taW4oXHJcblx0XHRcdFx0VEhJUy5ib3JkZXJSYWRpdXMsXHJcblx0XHRcdFx0TWF0aC5yb3VuZChUSElTLnBhZGRpbmcgKiBNYXRoLlBJKSk7IC8vIHB4XHJcblx0XHRcdHZhciBwYWRDdXJzb3IgPSAnY3Jvc3NoYWlyJztcclxuXHJcblx0XHRcdC8vIHdyYXBcclxuXHRcdFx0cC53cmFwLmNsYXNzTmFtZSA9ICdqc2NvbG9yLXdyYXAnO1xyXG5cdFx0XHRwLndyYXAuc3R5bGUud2lkdGggPSBwaWNrZXJEaW1zLmJvcmRlclcgKyAncHgnO1xyXG5cdFx0XHRwLndyYXAuc3R5bGUuaGVpZ2h0ID0gcGlja2VyRGltcy5ib3JkZXJIICsgJ3B4JztcclxuXHRcdFx0cC53cmFwLnN0eWxlLnpJbmRleCA9IFRISVMuekluZGV4O1xyXG5cclxuXHRcdFx0Ly8gcGlja2VyXHJcblx0XHRcdHAuYm94LmNsYXNzTmFtZSA9ICdqc2NvbG9yLXBpY2tlcic7XHJcblx0XHRcdHAuYm94LnN0eWxlLndpZHRoID0gcGlja2VyRGltcy5wYWRkZWRXICsgJ3B4JztcclxuXHRcdFx0cC5ib3guc3R5bGUuaGVpZ2h0ID0gcGlja2VyRGltcy5wYWRkZWRIICsgJ3B4JztcclxuXHJcblx0XHRcdC8vIHBpY2tlciBzaGFkb3dcclxuXHRcdFx0cC5ib3hTLmNsYXNzTmFtZSA9ICdqc2NvbG9yLXNoYWRvdyc7XHJcblx0XHRcdGpzYy5zZXRCb3JkZXJSYWRpdXMocC5ib3hTLCBib3JkZXJSYWRpdXMgKyAncHgnKTtcclxuXHJcblx0XHRcdC8vIHBpY2tlciBib3JkZXJcclxuXHRcdFx0cC5ib3hCLmNsYXNzTmFtZSA9ICdqc2NvbG9yLWJvcmRlcic7XHJcblx0XHRcdHAuYm94Qi5zdHlsZS5ib3JkZXIgPSBUSElTLmJvcmRlcldpZHRoICsgJ3B4IHNvbGlkJztcclxuXHRcdFx0cC5ib3hCLnN0eWxlLmJvcmRlckNvbG9yID0gVEhJUy5ib3JkZXJDb2xvcjtcclxuXHRcdFx0cC5ib3hCLnN0eWxlLmJhY2tncm91bmQgPSBUSElTLmJhY2tncm91bmRDb2xvcjtcclxuXHRcdFx0anNjLnNldEJvcmRlclJhZGl1cyhwLmJveEIsIGJvcmRlclJhZGl1cyArICdweCcpO1xyXG5cclxuXHRcdFx0Ly8gSUUgaGFjazpcclxuXHRcdFx0Ly8gSWYgdGhlIGVsZW1lbnQgaXMgdHJhbnNwYXJlbnQsIElFIHdpbGwgdHJpZ2dlciB0aGUgZXZlbnQgb24gdGhlIGVsZW1lbnRzIHVuZGVyIGl0LFxyXG5cdFx0XHQvLyBlLmcuIG9uIENhbnZhcyBvciBvbiBlbGVtZW50cyB3aXRoIGJvcmRlclxyXG5cdFx0XHRwLnBhZE0uc3R5bGUuYmFja2dyb3VuZCA9ICdyZ2JhKDI1NSwwLDAsLjIpJztcclxuXHRcdFx0cC5zbGRNLnN0eWxlLmJhY2tncm91bmQgPSAncmdiYSgwLDI1NSwwLC4yKSc7XHJcblx0XHRcdHAuYXNsZE0uc3R5bGUuYmFja2dyb3VuZCA9ICdyZ2JhKDAsMCwyNTUsLjIpJztcclxuXHJcblx0XHRcdHAucGFkTS5zdHlsZS5vcGFjaXR5ID1cclxuXHRcdFx0cC5zbGRNLnN0eWxlLm9wYWNpdHkgPVxyXG5cdFx0XHRwLmFzbGRNLnN0eWxlLm9wYWNpdHkgPVxyXG5cdFx0XHRcdCcwJztcclxuXHJcblx0XHRcdC8vIHBhZFxyXG5cdFx0XHRwLnBhZC5zdHlsZS5wb3NpdGlvbiA9ICdyZWxhdGl2ZSc7XHJcblx0XHRcdHAucGFkLnN0eWxlLndpZHRoID0gVEhJUy53aWR0aCArICdweCc7XHJcblx0XHRcdHAucGFkLnN0eWxlLmhlaWdodCA9IFRISVMuaGVpZ2h0ICsgJ3B4JztcclxuXHJcblx0XHRcdC8vIHBhZCAtIGNvbG9yIHNwZWN0cnVtIChIU1YgYW5kIEhWUylcclxuXHRcdFx0cC5wYWRDYW52YXMuZHJhdyhUSElTLndpZHRoLCBUSElTLmhlaWdodCwganNjLmdldFBhZFlDaGFubmVsKFRISVMpKTtcclxuXHJcblx0XHRcdC8vIHBhZCBib3JkZXJcclxuXHRcdFx0cC5wYWRCLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcclxuXHRcdFx0cC5wYWRCLnN0eWxlLmxlZnQgPSBUSElTLnBhZGRpbmcgKyAncHgnO1xyXG5cdFx0XHRwLnBhZEIuc3R5bGUudG9wID0gVEhJUy5wYWRkaW5nICsgJ3B4JztcclxuXHRcdFx0cC5wYWRCLnN0eWxlLmJvcmRlciA9IFRISVMuY29udHJvbEJvcmRlcldpZHRoICsgJ3B4IHNvbGlkJztcclxuXHRcdFx0cC5wYWRCLnN0eWxlLmJvcmRlckNvbG9yID0gVEhJUy5jb250cm9sQm9yZGVyQ29sb3I7XHJcblxyXG5cdFx0XHQvLyBwYWQgbW91c2UgYXJlYVxyXG5cdFx0XHRwLnBhZE0uc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xyXG5cdFx0XHRwLnBhZE0uc3R5bGUubGVmdCA9IDAgKyAncHgnO1xyXG5cdFx0XHRwLnBhZE0uc3R5bGUudG9wID0gMCArICdweCc7XHJcblx0XHRcdHAucGFkTS5zdHlsZS53aWR0aCA9IChUSElTLnBhZGRpbmcgKyAyICogVEhJUy5jb250cm9sQm9yZGVyV2lkdGggKyBUSElTLndpZHRoICsgY29udHJvbFBhZGRpbmcpICsgJ3B4JztcclxuXHRcdFx0cC5wYWRNLnN0eWxlLmhlaWdodCA9ICgyICogVEhJUy5jb250cm9sQm9yZGVyV2lkdGggKyAyICogVEhJUy5wYWRkaW5nICsgVEhJUy5oZWlnaHQpICsgJ3B4JztcclxuXHRcdFx0cC5wYWRNLnN0eWxlLmN1cnNvciA9IHBhZEN1cnNvcjtcclxuXHRcdFx0anNjLnNldERhdGEocC5wYWRNLCB7XHJcblx0XHRcdFx0aW5zdGFuY2U6IFRISVMsXHJcblx0XHRcdFx0Y29udHJvbDogJ3BhZCcsXHJcblx0XHRcdH0pXHJcblxyXG5cdFx0XHQvLyBwYWQgY3Jvc3NcclxuXHRcdFx0cC5jcm9zcy5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XHJcblx0XHRcdHAuY3Jvc3Muc3R5bGUubGVmdCA9XHJcblx0XHRcdHAuY3Jvc3Muc3R5bGUudG9wID1cclxuXHRcdFx0XHQnMCc7XHJcblx0XHRcdHAuY3Jvc3Muc3R5bGUud2lkdGggPVxyXG5cdFx0XHRwLmNyb3NzLnN0eWxlLmhlaWdodCA9XHJcblx0XHRcdFx0Y3Jvc3NPdXRlclNpemUgKyAncHgnO1xyXG5cclxuXHRcdFx0Ly8gcGFkIGNyb3NzIGJvcmRlciBZIGFuZCBYXHJcblx0XHRcdHAuY3Jvc3NCWS5zdHlsZS5wb3NpdGlvbiA9XHJcblx0XHRcdHAuY3Jvc3NCWC5zdHlsZS5wb3NpdGlvbiA9XHJcblx0XHRcdFx0J2Fic29sdXRlJztcclxuXHRcdFx0cC5jcm9zc0JZLnN0eWxlLmJhY2tncm91bmQgPVxyXG5cdFx0XHRwLmNyb3NzQlguc3R5bGUuYmFja2dyb3VuZCA9XHJcblx0XHRcdFx0VEhJUy5wb2ludGVyQm9yZGVyQ29sb3I7XHJcblx0XHRcdHAuY3Jvc3NCWS5zdHlsZS53aWR0aCA9XHJcblx0XHRcdHAuY3Jvc3NCWC5zdHlsZS5oZWlnaHQgPVxyXG5cdFx0XHRcdCgyICogVEhJUy5wb2ludGVyQm9yZGVyV2lkdGggKyBUSElTLnBvaW50ZXJUaGlja25lc3MpICsgJ3B4JztcclxuXHRcdFx0cC5jcm9zc0JZLnN0eWxlLmhlaWdodCA9XHJcblx0XHRcdHAuY3Jvc3NCWC5zdHlsZS53aWR0aCA9XHJcblx0XHRcdFx0Y3Jvc3NPdXRlclNpemUgKyAncHgnO1xyXG5cdFx0XHRwLmNyb3NzQlkuc3R5bGUubGVmdCA9XHJcblx0XHRcdHAuY3Jvc3NCWC5zdHlsZS50b3AgPVxyXG5cdFx0XHRcdChNYXRoLmZsb29yKGNyb3NzT3V0ZXJTaXplIC8gMikgLSBNYXRoLmZsb29yKFRISVMucG9pbnRlclRoaWNrbmVzcyAvIDIpIC0gVEhJUy5wb2ludGVyQm9yZGVyV2lkdGgpICsgJ3B4JztcclxuXHRcdFx0cC5jcm9zc0JZLnN0eWxlLnRvcCA9XHJcblx0XHRcdHAuY3Jvc3NCWC5zdHlsZS5sZWZ0ID1cclxuXHRcdFx0XHQnMCc7XHJcblxyXG5cdFx0XHQvLyBwYWQgY3Jvc3MgbGluZSBZIGFuZCBYXHJcblx0XHRcdHAuY3Jvc3NMWS5zdHlsZS5wb3NpdGlvbiA9XHJcblx0XHRcdHAuY3Jvc3NMWC5zdHlsZS5wb3NpdGlvbiA9XHJcblx0XHRcdFx0J2Fic29sdXRlJztcclxuXHRcdFx0cC5jcm9zc0xZLnN0eWxlLmJhY2tncm91bmQgPVxyXG5cdFx0XHRwLmNyb3NzTFguc3R5bGUuYmFja2dyb3VuZCA9XHJcblx0XHRcdFx0VEhJUy5wb2ludGVyQ29sb3I7XHJcblx0XHRcdHAuY3Jvc3NMWS5zdHlsZS5oZWlnaHQgPVxyXG5cdFx0XHRwLmNyb3NzTFguc3R5bGUud2lkdGggPVxyXG5cdFx0XHRcdChjcm9zc091dGVyU2l6ZSAtIDIgKiBUSElTLnBvaW50ZXJCb3JkZXJXaWR0aCkgKyAncHgnO1xyXG5cdFx0XHRwLmNyb3NzTFkuc3R5bGUud2lkdGggPVxyXG5cdFx0XHRwLmNyb3NzTFguc3R5bGUuaGVpZ2h0ID1cclxuXHRcdFx0XHRUSElTLnBvaW50ZXJUaGlja25lc3MgKyAncHgnO1xyXG5cdFx0XHRwLmNyb3NzTFkuc3R5bGUubGVmdCA9XHJcblx0XHRcdHAuY3Jvc3NMWC5zdHlsZS50b3AgPVxyXG5cdFx0XHRcdChNYXRoLmZsb29yKGNyb3NzT3V0ZXJTaXplIC8gMikgLSBNYXRoLmZsb29yKFRISVMucG9pbnRlclRoaWNrbmVzcyAvIDIpKSArICdweCc7XHJcblx0XHRcdHAuY3Jvc3NMWS5zdHlsZS50b3AgPVxyXG5cdFx0XHRwLmNyb3NzTFguc3R5bGUubGVmdCA9XHJcblx0XHRcdFx0VEhJUy5wb2ludGVyQm9yZGVyV2lkdGggKyAncHgnO1xyXG5cclxuXHJcblx0XHRcdC8vIHNsaWRlclxyXG5cdFx0XHRwLnNsZC5zdHlsZS5vdmVyZmxvdyA9ICdoaWRkZW4nO1xyXG5cdFx0XHRwLnNsZC5zdHlsZS53aWR0aCA9IFRISVMuc2xpZGVyU2l6ZSArICdweCc7XHJcblx0XHRcdHAuc2xkLnN0eWxlLmhlaWdodCA9IFRISVMuaGVpZ2h0ICsgJ3B4JztcclxuXHJcblx0XHRcdC8vIHNsaWRlciBncmFkaWVudFxyXG5cdFx0XHRwLnNsZEdyYWQuZHJhdyhUSElTLnNsaWRlclNpemUsIFRISVMuaGVpZ2h0LCAnIzAwMCcsICcjMDAwJyk7XHJcblxyXG5cdFx0XHQvLyBzbGlkZXIgYm9yZGVyXHJcblx0XHRcdHAuc2xkQi5zdHlsZS5kaXNwbGF5ID0gZGlzcGxheVNsaWRlciA/ICdibG9jaycgOiAnbm9uZSc7XHJcblx0XHRcdHAuc2xkQi5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XHJcblx0XHRcdHAuc2xkQi5zdHlsZS5sZWZ0ID0gKFRISVMucGFkZGluZyArIFRISVMud2lkdGggKyAyICogVEhJUy5jb250cm9sQm9yZGVyV2lkdGggKyAyICogY29udHJvbFBhZGRpbmcpICsgJ3B4JztcclxuXHRcdFx0cC5zbGRCLnN0eWxlLnRvcCA9IFRISVMucGFkZGluZyArICdweCc7XHJcblx0XHRcdHAuc2xkQi5zdHlsZS5ib3JkZXIgPSBUSElTLmNvbnRyb2xCb3JkZXJXaWR0aCArICdweCBzb2xpZCc7XHJcblx0XHRcdHAuc2xkQi5zdHlsZS5ib3JkZXJDb2xvciA9IFRISVMuY29udHJvbEJvcmRlckNvbG9yO1xyXG5cclxuXHRcdFx0Ly8gc2xpZGVyIG1vdXNlIGFyZWFcclxuXHRcdFx0cC5zbGRNLnN0eWxlLmRpc3BsYXkgPSBkaXNwbGF5U2xpZGVyID8gJ2Jsb2NrJyA6ICdub25lJztcclxuXHRcdFx0cC5zbGRNLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcclxuXHRcdFx0cC5zbGRNLnN0eWxlLmxlZnQgPSAoVEhJUy5wYWRkaW5nICsgVEhJUy53aWR0aCArIDIgKiBUSElTLmNvbnRyb2xCb3JkZXJXaWR0aCArIGNvbnRyb2xQYWRkaW5nKSArICdweCc7XHJcblx0XHRcdHAuc2xkTS5zdHlsZS50b3AgPSAwICsgJ3B4JztcclxuXHRcdFx0cC5zbGRNLnN0eWxlLndpZHRoID0gKFxyXG5cdFx0XHRcdFx0KFRISVMuc2xpZGVyU2l6ZSArIDIgKiBjb250cm9sUGFkZGluZyArIDIgKiBUSElTLmNvbnRyb2xCb3JkZXJXaWR0aCkgK1xyXG5cdFx0XHRcdFx0KGRpc3BsYXlBbHBoYVNsaWRlciA/IDAgOiBNYXRoLm1heCgwLCBUSElTLnBhZGRpbmcgLSBjb250cm9sUGFkZGluZykpIC8vIHJlbWFpbmluZyBwYWRkaW5nIHRvIHRoZSByaWdodCBlZGdlXHJcblx0XHRcdFx0KSArICdweCc7XHJcblx0XHRcdHAuc2xkTS5zdHlsZS5oZWlnaHQgPSAoMiAqIFRISVMuY29udHJvbEJvcmRlcldpZHRoICsgMiAqIFRISVMucGFkZGluZyArIFRISVMuaGVpZ2h0KSArICdweCc7XHJcblx0XHRcdHAuc2xkTS5zdHlsZS5jdXJzb3IgPSAnZGVmYXVsdCc7XHJcblx0XHRcdGpzYy5zZXREYXRhKHAuc2xkTSwge1xyXG5cdFx0XHRcdGluc3RhbmNlOiBUSElTLFxyXG5cdFx0XHRcdGNvbnRyb2w6ICdzbGQnLFxyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdC8vIHNsaWRlciBwb2ludGVyIGlubmVyIGFuZCBvdXRlciBib3JkZXJcclxuXHRcdFx0cC5zbGRQdHJJQi5zdHlsZS5ib3JkZXIgPVxyXG5cdFx0XHRwLnNsZFB0ck9CLnN0eWxlLmJvcmRlciA9XHJcblx0XHRcdFx0VEhJUy5wb2ludGVyQm9yZGVyV2lkdGggKyAncHggc29saWQgJyArIFRISVMucG9pbnRlckJvcmRlckNvbG9yO1xyXG5cclxuXHRcdFx0Ly8gc2xpZGVyIHBvaW50ZXIgb3V0ZXIgYm9yZGVyXHJcblx0XHRcdHAuc2xkUHRyT0Iuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xyXG5cdFx0XHRwLnNsZFB0ck9CLnN0eWxlLmxlZnQgPSAtKDIgKiBUSElTLnBvaW50ZXJCb3JkZXJXaWR0aCArIFRISVMucG9pbnRlclRoaWNrbmVzcykgKyAncHgnO1xyXG5cdFx0XHRwLnNsZFB0ck9CLnN0eWxlLnRvcCA9ICcwJztcclxuXHJcblx0XHRcdC8vIHNsaWRlciBwb2ludGVyIG1pZGRsZSBib3JkZXJcclxuXHRcdFx0cC5zbGRQdHJNQi5zdHlsZS5ib3JkZXIgPSBUSElTLnBvaW50ZXJUaGlja25lc3MgKyAncHggc29saWQgJyArIFRISVMucG9pbnRlckNvbG9yO1xyXG5cclxuXHRcdFx0Ly8gc2xpZGVyIHBvaW50ZXIgc3BhY2VyXHJcblx0XHRcdHAuc2xkUHRyUy5zdHlsZS53aWR0aCA9IFRISVMuc2xpZGVyU2l6ZSArICdweCc7XHJcblx0XHRcdHAuc2xkUHRyUy5zdHlsZS5oZWlnaHQgPSBqc2MucHViLnNsaWRlcklubmVyU3BhY2UgKyAncHgnO1xyXG5cclxuXHJcblx0XHRcdC8vIGFscGhhIHNsaWRlclxyXG5cdFx0XHRwLmFzbGQuc3R5bGUub3ZlcmZsb3cgPSAnaGlkZGVuJztcclxuXHRcdFx0cC5hc2xkLnN0eWxlLndpZHRoID0gVEhJUy5zbGlkZXJTaXplICsgJ3B4JztcclxuXHRcdFx0cC5hc2xkLnN0eWxlLmhlaWdodCA9IFRISVMuaGVpZ2h0ICsgJ3B4JztcclxuXHJcblx0XHRcdC8vIGFscGhhIHNsaWRlciBncmFkaWVudFxyXG5cdFx0XHRwLmFzbGRHcmFkLmRyYXcoVEhJUy5zbGlkZXJTaXplLCBUSElTLmhlaWdodCwgJyMwMDAnKTtcclxuXHJcblx0XHRcdC8vIGFscGhhIHNsaWRlciBib3JkZXJcclxuXHRcdFx0cC5hc2xkQi5zdHlsZS5kaXNwbGF5ID0gZGlzcGxheUFscGhhU2xpZGVyID8gJ2Jsb2NrJyA6ICdub25lJztcclxuXHRcdFx0cC5hc2xkQi5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XHJcblx0XHRcdHAuYXNsZEIuc3R5bGUubGVmdCA9IChcclxuXHRcdFx0XHRcdChUSElTLnBhZGRpbmcgKyBUSElTLndpZHRoICsgMiAqIFRISVMuY29udHJvbEJvcmRlcldpZHRoICsgY29udHJvbFBhZGRpbmcpICtcclxuXHRcdFx0XHRcdChkaXNwbGF5U2xpZGVyID8gKFRISVMuc2xpZGVyU2l6ZSArIDMgKiBjb250cm9sUGFkZGluZyArIDIgKiBUSElTLmNvbnRyb2xCb3JkZXJXaWR0aCkgOiAwKVxyXG5cdFx0XHRcdCkgKyAncHgnO1xyXG5cdFx0XHRwLmFzbGRCLnN0eWxlLnRvcCA9IFRISVMucGFkZGluZyArICdweCc7XHJcblx0XHRcdHAuYXNsZEIuc3R5bGUuYm9yZGVyID0gVEhJUy5jb250cm9sQm9yZGVyV2lkdGggKyAncHggc29saWQnO1xyXG5cdFx0XHRwLmFzbGRCLnN0eWxlLmJvcmRlckNvbG9yID0gVEhJUy5jb250cm9sQm9yZGVyQ29sb3I7XHJcblxyXG5cdFx0XHQvLyBhbHBoYSBzbGlkZXIgbW91c2UgYXJlYVxyXG5cdFx0XHRwLmFzbGRNLnN0eWxlLmRpc3BsYXkgPSBkaXNwbGF5QWxwaGFTbGlkZXIgPyAnYmxvY2snIDogJ25vbmUnO1xyXG5cdFx0XHRwLmFzbGRNLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcclxuXHRcdFx0cC5hc2xkTS5zdHlsZS5sZWZ0ID0gKFxyXG5cdFx0XHRcdFx0KFRISVMucGFkZGluZyArIFRISVMud2lkdGggKyAyICogVEhJUy5jb250cm9sQm9yZGVyV2lkdGggKyBjb250cm9sUGFkZGluZykgK1xyXG5cdFx0XHRcdFx0KGRpc3BsYXlTbGlkZXIgPyAoVEhJUy5zbGlkZXJTaXplICsgMiAqIGNvbnRyb2xQYWRkaW5nICsgMiAqIFRISVMuY29udHJvbEJvcmRlcldpZHRoKSA6IDApXHJcblx0XHRcdFx0KSArICdweCc7XHJcblx0XHRcdHAuYXNsZE0uc3R5bGUudG9wID0gMCArICdweCc7XHJcblx0XHRcdHAuYXNsZE0uc3R5bGUud2lkdGggPSAoXHJcblx0XHRcdFx0XHQoVEhJUy5zbGlkZXJTaXplICsgMiAqIGNvbnRyb2xQYWRkaW5nICsgMiAqIFRISVMuY29udHJvbEJvcmRlcldpZHRoKSArXHJcblx0XHRcdFx0XHRNYXRoLm1heCgwLCBUSElTLnBhZGRpbmcgLSBjb250cm9sUGFkZGluZykgLy8gcmVtYWluaW5nIHBhZGRpbmcgdG8gdGhlIHJpZ2h0IGVkZ2VcclxuXHRcdFx0XHQpICsgJ3B4JztcclxuXHRcdFx0cC5hc2xkTS5zdHlsZS5oZWlnaHQgPSAoMiAqIFRISVMuY29udHJvbEJvcmRlcldpZHRoICsgMiAqIFRISVMucGFkZGluZyArIFRISVMuaGVpZ2h0KSArICdweCc7XHJcblx0XHRcdHAuYXNsZE0uc3R5bGUuY3Vyc29yID0gJ2RlZmF1bHQnO1xyXG5cdFx0XHRqc2Muc2V0RGF0YShwLmFzbGRNLCB7XHJcblx0XHRcdFx0aW5zdGFuY2U6IFRISVMsXHJcblx0XHRcdFx0Y29udHJvbDogJ2FzbGQnLFxyXG5cdFx0XHR9KVxyXG5cclxuXHRcdFx0Ly8gYWxwaGEgc2xpZGVyIHBvaW50ZXIgaW5uZXIgYW5kIG91dGVyIGJvcmRlclxyXG5cdFx0XHRwLmFzbGRQdHJJQi5zdHlsZS5ib3JkZXIgPVxyXG5cdFx0XHRwLmFzbGRQdHJPQi5zdHlsZS5ib3JkZXIgPVxyXG5cdFx0XHRcdFRISVMucG9pbnRlckJvcmRlcldpZHRoICsgJ3B4IHNvbGlkICcgKyBUSElTLnBvaW50ZXJCb3JkZXJDb2xvcjtcclxuXHJcblx0XHRcdC8vIGFscGhhIHNsaWRlciBwb2ludGVyIG91dGVyIGJvcmRlclxyXG5cdFx0XHRwLmFzbGRQdHJPQi5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XHJcblx0XHRcdHAuYXNsZFB0ck9CLnN0eWxlLmxlZnQgPSAtKDIgKiBUSElTLnBvaW50ZXJCb3JkZXJXaWR0aCArIFRISVMucG9pbnRlclRoaWNrbmVzcykgKyAncHgnO1xyXG5cdFx0XHRwLmFzbGRQdHJPQi5zdHlsZS50b3AgPSAnMCc7XHJcblxyXG5cdFx0XHQvLyBhbHBoYSBzbGlkZXIgcG9pbnRlciBtaWRkbGUgYm9yZGVyXHJcblx0XHRcdHAuYXNsZFB0ck1CLnN0eWxlLmJvcmRlciA9IFRISVMucG9pbnRlclRoaWNrbmVzcyArICdweCBzb2xpZCAnICsgVEhJUy5wb2ludGVyQ29sb3I7XHJcblxyXG5cdFx0XHQvLyBhbHBoYSBzbGlkZXIgcG9pbnRlciBzcGFjZXJcclxuXHRcdFx0cC5hc2xkUHRyUy5zdHlsZS53aWR0aCA9IFRISVMuc2xpZGVyU2l6ZSArICdweCc7XHJcblx0XHRcdHAuYXNsZFB0clMuc3R5bGUuaGVpZ2h0ID0ganNjLnB1Yi5zbGlkZXJJbm5lclNwYWNlICsgJ3B4JztcclxuXHJcblxyXG5cdFx0XHQvLyBwYWxldHRlXHJcblx0XHRcdHAucGFsLmNsYXNzTmFtZSA9ICdqc2NvbG9yLXBhbGV0dGUnO1xyXG5cdFx0XHRwLnBhbC5zdHlsZS5kaXNwbGF5ID0gcGlja2VyRGltcy5wYWxldHRlLnJvd3MgPyAnYmxvY2snIDogJ25vbmUnO1xyXG5cdFx0XHRwLnBhbC5zdHlsZS5sZWZ0ID0gVEhJUy5wYWRkaW5nICsgJ3B4JztcclxuXHRcdFx0cC5wYWwuc3R5bGUudG9wID0gKDIgKiBUSElTLmNvbnRyb2xCb3JkZXJXaWR0aCArIDIgKiBUSElTLnBhZGRpbmcgKyBUSElTLmhlaWdodCkgKyAncHgnO1xyXG5cclxuXHRcdFx0Ly8gcGFsZXR0ZSdzIGNvbG9yIHNhbXBsZXNcclxuXHJcblx0XHRcdHAucGFsLmlubmVySFRNTCA9ICcnO1xyXG5cclxuXHRcdFx0dmFyIGNoZXNzYm9hcmQgPSBqc2MuZ2VuQ29sb3JQcmV2aWV3Q2FudmFzKCdyZ2JhKDAsMCwwLDApJyk7XHJcblxyXG5cdFx0XHR2YXIgc2kgPSAwOyAvLyBjb2xvciBzYW1wbGUncyBpbmRleFxyXG5cdFx0XHRmb3IgKHZhciByID0gMDsgciA8IHBpY2tlckRpbXMucGFsZXR0ZS5yb3dzOyByKyspIHtcclxuXHRcdFx0XHRmb3IgKHZhciBjID0gMDsgYyA8IHBpY2tlckRpbXMucGFsZXR0ZS5jb2xzICYmIHNpIDwgVEhJUy5fcGFsZXR0ZS5sZW5ndGg7IGMrKywgc2krKykge1xyXG5cdFx0XHRcdFx0dmFyIHNhbXBsZUNvbG9yID0gVEhJUy5fcGFsZXR0ZVtzaV07XHJcblx0XHRcdFx0XHR2YXIgc2FtcGxlQ3NzQ29sb3IgPSBqc2MucmdiYUNvbG9yLmFwcGx5KG51bGwsIHNhbXBsZUNvbG9yLnJnYmEpO1xyXG5cclxuXHRcdFx0XHRcdHZhciBzYyA9IGpzYy5jcmVhdGVFbCgnZGl2Jyk7IC8vIGNvbG9yIHNhbXBsZSdzIGNvbG9yXHJcblx0XHRcdFx0XHRzYy5zdHlsZS53aWR0aCA9IChwaWNrZXJEaW1zLnBhbGV0dGUuY2VsbFcgLSAyICogVEhJUy5jb250cm9sQm9yZGVyV2lkdGgpICsgJ3B4JztcclxuXHRcdFx0XHRcdHNjLnN0eWxlLmhlaWdodCA9IChwaWNrZXJEaW1zLnBhbGV0dGUuY2VsbEggLSAyICogVEhJUy5jb250cm9sQm9yZGVyV2lkdGgpICsgJ3B4JztcclxuXHRcdFx0XHRcdHNjLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IHNhbXBsZUNzc0NvbG9yO1xyXG5cclxuXHRcdFx0XHRcdHZhciBzdyA9IGpzYy5jcmVhdGVFbCgnZGl2Jyk7IC8vIGNvbG9yIHNhbXBsZSdzIHdyYXBcclxuXHRcdFx0XHRcdHN3LmNsYXNzTmFtZSA9ICdqc2NvbG9yLXBhbGV0dGUtc3cnO1xyXG5cdFx0XHRcdFx0c3cuc3R5bGUubGVmdCA9XHJcblx0XHRcdFx0XHRcdChcclxuXHRcdFx0XHRcdFx0XHRwaWNrZXJEaW1zLnBhbGV0dGUuY29scyA8PSAxID8gMCA6XHJcblx0XHRcdFx0XHRcdFx0TWF0aC5yb3VuZCgxMCAqIChjICogKChwaWNrZXJEaW1zLmNvbnRlbnRXIC0gcGlja2VyRGltcy5wYWxldHRlLmNlbGxXKSAvIChwaWNrZXJEaW1zLnBhbGV0dGUuY29scyAtIDEpKSkpIC8gMTBcclxuXHRcdFx0XHRcdFx0KSArICdweCc7XHJcblx0XHRcdFx0XHRzdy5zdHlsZS50b3AgPSAociAqIChwaWNrZXJEaW1zLnBhbGV0dGUuY2VsbEggKyBUSElTLnBhbGV0dGVTcGFjaW5nKSkgKyAncHgnO1xyXG5cdFx0XHRcdFx0c3cuc3R5bGUuYm9yZGVyID0gVEhJUy5jb250cm9sQm9yZGVyV2lkdGggKyAncHggc29saWQnO1xyXG5cdFx0XHRcdFx0c3cuc3R5bGUuYm9yZGVyQ29sb3IgPSBUSElTLmNvbnRyb2xCb3JkZXJDb2xvcjtcclxuXHRcdFx0XHRcdGlmIChzYW1wbGVDb2xvci5yZ2JhWzNdICE9PSBudWxsICYmIHNhbXBsZUNvbG9yLnJnYmFbM10gPCAxLjApIHsgLy8gb25seSBjcmVhdGUgY2hlc3Nib2FyZCBiYWNrZ3JvdW5kIGlmIHRoZSBzYW1wbGUgaGFzIHRyYW5zcGFyZW5jeVxyXG5cdFx0XHRcdFx0XHRzdy5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSAndXJsKFxcJycgKyBjaGVzc2JvYXJkLmNhbnZhcy50b0RhdGFVUkwoKSArICdcXCcpJztcclxuXHRcdFx0XHRcdFx0c3cuc3R5bGUuYmFja2dyb3VuZFJlcGVhdCA9ICdyZXBlYXQnO1xyXG5cdFx0XHRcdFx0XHRzdy5zdHlsZS5iYWNrZ3JvdW5kUG9zaXRpb24gPSAnY2VudGVyIGNlbnRlcic7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRqc2Muc2V0RGF0YShzdywge1xyXG5cdFx0XHRcdFx0XHRpbnN0YW5jZTogVEhJUyxcclxuXHRcdFx0XHRcdFx0Y29udHJvbDogJ3BhbGV0dGUtc3cnLFxyXG5cdFx0XHRcdFx0XHRjb2xvcjogc2FtcGxlQ29sb3IsXHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdHN3LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywganNjLm9uUGFsZXR0ZVNhbXBsZUNsaWNrLCBmYWxzZSk7XHJcblx0XHRcdFx0XHRzdy5hcHBlbmRDaGlsZChzYyk7XHJcblx0XHRcdFx0XHRwLnBhbC5hcHBlbmRDaGlsZChzdyk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblxyXG5cclxuXHRcdFx0Ly8gdGhlIENsb3NlIGJ1dHRvblxyXG5cdFx0XHRmdW5jdGlvbiBzZXRCdG5Cb3JkZXIgKCkge1xyXG5cdFx0XHRcdHZhciBpbnNldENvbG9ycyA9IFRISVMuY29udHJvbEJvcmRlckNvbG9yLnNwbGl0KC9cXHMrLyk7XHJcblx0XHRcdFx0dmFyIG91dHNldENvbG9yID0gaW5zZXRDb2xvcnMubGVuZ3RoIDwgMiA/IGluc2V0Q29sb3JzWzBdIDogaW5zZXRDb2xvcnNbMV0gKyAnICcgKyBpbnNldENvbG9yc1swXSArICcgJyArIGluc2V0Q29sb3JzWzBdICsgJyAnICsgaW5zZXRDb2xvcnNbMV07XHJcblx0XHRcdFx0cC5idG4uc3R5bGUuYm9yZGVyQ29sb3IgPSBvdXRzZXRDb2xvcjtcclxuXHRcdFx0fVxyXG5cdFx0XHR2YXIgYnRuUGFkZGluZyA9IDE1OyAvLyBweFxyXG5cdFx0XHRwLmJ0bi5jbGFzc05hbWUgPSAnanNjb2xvci1idG4ganNjb2xvci1idG4tY2xvc2UnO1xyXG5cdFx0XHRwLmJ0bi5zdHlsZS5kaXNwbGF5ID0gVEhJUy5jbG9zZUJ1dHRvbiA/ICdibG9jaycgOiAnbm9uZSc7XHJcblx0XHRcdHAuYnRuLnN0eWxlLmxlZnQgPSBUSElTLnBhZGRpbmcgKyAncHgnO1xyXG5cdFx0XHRwLmJ0bi5zdHlsZS5ib3R0b20gPSBUSElTLnBhZGRpbmcgKyAncHgnO1xyXG5cdFx0XHRwLmJ0bi5zdHlsZS5wYWRkaW5nID0gJzAgJyArIGJ0blBhZGRpbmcgKyAncHgnO1xyXG5cdFx0XHRwLmJ0bi5zdHlsZS5tYXhXaWR0aCA9IChwaWNrZXJEaW1zLmNvbnRlbnRXIC0gMiAqIFRISVMuY29udHJvbEJvcmRlcldpZHRoIC0gMiAqIGJ0blBhZGRpbmcpICsgJ3B4JztcclxuXHRcdFx0cC5idG4uc3R5bGUuaGVpZ2h0ID0gVEhJUy5idXR0b25IZWlnaHQgKyAncHgnO1xyXG5cdFx0XHRwLmJ0bi5zdHlsZS5ib3JkZXIgPSBUSElTLmNvbnRyb2xCb3JkZXJXaWR0aCArICdweCBzb2xpZCc7XHJcblx0XHRcdHNldEJ0bkJvcmRlcigpO1xyXG5cdFx0XHRwLmJ0bi5zdHlsZS5jb2xvciA9IFRISVMuYnV0dG9uQ29sb3I7XHJcblx0XHRcdHAuYnRuLm9ubW91c2Vkb3duID0gZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRcdFRISVMuaGlkZSgpO1xyXG5cdFx0XHR9O1xyXG5cdFx0XHRwLmJ0blQuc3R5bGUuZGlzcGxheSA9ICdpbmxpbmUnO1xyXG5cdFx0XHRwLmJ0blQuc3R5bGUubGluZUhlaWdodCA9IFRISVMuYnV0dG9uSGVpZ2h0ICsgJ3B4JztcclxuXHRcdFx0cC5idG5ULmlubmVyVGV4dCA9IFRISVMuY2xvc2VUZXh0O1xyXG5cclxuXHRcdFx0Ly8gcmVwb3NpdGlvbiB0aGUgcG9pbnRlcnNcclxuXHRcdFx0cmVkcmF3UGFkKCk7XHJcblx0XHRcdHJlZHJhd1NsZCgpO1xyXG5cdFx0XHRyZWRyYXdBU2xkKCk7XHJcblxyXG5cdFx0XHQvLyBJZiB3ZSBhcmUgY2hhbmdpbmcgdGhlIG93bmVyIHdpdGhvdXQgZmlyc3QgY2xvc2luZyB0aGUgcGlja2VyLFxyXG5cdFx0XHQvLyBtYWtlIHN1cmUgdG8gZmlyc3QgZGVhbCB3aXRoIHRoZSBvbGQgb3duZXJcclxuXHRcdFx0aWYgKGpzYy5waWNrZXIub3duZXIgJiYganNjLnBpY2tlci5vd25lciAhPT0gVEhJUykge1xyXG5cdFx0XHRcdGpzYy5yZW1vdmVDbGFzcyhqc2MucGlja2VyLm93bmVyLnRhcmdldEVsZW1lbnQsIGpzYy5wdWIuYWN0aXZlQ2xhc3NOYW1lKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Ly8gU2V0IGEgbmV3IHBpY2tlciBvd25lclxyXG5cdFx0XHRqc2MucGlja2VyLm93bmVyID0gVEhJUztcclxuXHJcblx0XHRcdC8vIFRoZSByZWRyYXdQb3NpdGlvbigpIG1ldGhvZCBuZWVkcyBwaWNrZXIub3duZXIgdG8gYmUgc2V0LCB0aGF0J3Mgd2h5IHdlIGNhbGwgaXQgaGVyZSxcclxuXHRcdFx0Ly8gYWZ0ZXIgc2V0dGluZyB0aGUgb3duZXJcclxuXHRcdFx0anNjLnJlZHJhd1Bvc2l0aW9uKCk7XHJcblxyXG5cdFx0XHRpZiAocC53cmFwLnBhcmVudE5vZGUgIT09IFRISVMuY29udGFpbmVyKSB7XHJcblx0XHRcdFx0VEhJUy5jb250YWluZXIuYXBwZW5kQ2hpbGQocC53cmFwKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0anNjLmFkZENsYXNzKFRISVMudGFyZ2V0RWxlbWVudCwganNjLnB1Yi5hY3RpdmVDbGFzc05hbWUpO1xyXG5cdFx0fVxyXG5cclxuXHJcblx0XHRmdW5jdGlvbiByZWRyYXdQYWQgKCkge1xyXG5cdFx0XHQvLyByZWRyYXcgdGhlIHBhZCBwb2ludGVyXHJcblx0XHRcdHZhciB5Q2hhbm5lbCA9IGpzYy5nZXRQYWRZQ2hhbm5lbChUSElTKTtcclxuXHRcdFx0dmFyIHggPSBNYXRoLnJvdW5kKChUSElTLmNoYW5uZWxzLmggLyAzNjApICogKFRISVMud2lkdGggLSAxKSk7XHJcblx0XHRcdHZhciB5ID0gTWF0aC5yb3VuZCgoMSAtIFRISVMuY2hhbm5lbHNbeUNoYW5uZWxdIC8gMTAwKSAqIChUSElTLmhlaWdodCAtIDEpKTtcclxuXHRcdFx0dmFyIGNyb3NzT3V0ZXJTaXplID0gKDIgKiBUSElTLnBvaW50ZXJCb3JkZXJXaWR0aCArIFRISVMucG9pbnRlclRoaWNrbmVzcyArIDIgKiBUSElTLmNyb3NzU2l6ZSk7XHJcblx0XHRcdHZhciBvZnMgPSAtTWF0aC5mbG9vcihjcm9zc091dGVyU2l6ZSAvIDIpO1xyXG5cdFx0XHRqc2MucGlja2VyLmNyb3NzLnN0eWxlLmxlZnQgPSAoeCArIG9mcykgKyAncHgnO1xyXG5cdFx0XHRqc2MucGlja2VyLmNyb3NzLnN0eWxlLnRvcCA9ICh5ICsgb2ZzKSArICdweCc7XHJcblxyXG5cdFx0XHQvLyByZWRyYXcgdGhlIHNsaWRlclxyXG5cdFx0XHRzd2l0Y2ggKGpzYy5nZXRTbGlkZXJDaGFubmVsKFRISVMpKSB7XHJcblx0XHRcdGNhc2UgJ3MnOlxyXG5cdFx0XHRcdHZhciByZ2IxID0ganNjLkhTVl9SR0IoVEhJUy5jaGFubmVscy5oLCAxMDAsIFRISVMuY2hhbm5lbHMudik7XHJcblx0XHRcdFx0dmFyIHJnYjIgPSBqc2MuSFNWX1JHQihUSElTLmNoYW5uZWxzLmgsIDAsIFRISVMuY2hhbm5lbHMudik7XHJcblx0XHRcdFx0dmFyIGNvbG9yMSA9ICdyZ2IoJyArXHJcblx0XHRcdFx0XHRNYXRoLnJvdW5kKHJnYjFbMF0pICsgJywnICtcclxuXHRcdFx0XHRcdE1hdGgucm91bmQocmdiMVsxXSkgKyAnLCcgK1xyXG5cdFx0XHRcdFx0TWF0aC5yb3VuZChyZ2IxWzJdKSArICcpJztcclxuXHRcdFx0XHR2YXIgY29sb3IyID0gJ3JnYignICtcclxuXHRcdFx0XHRcdE1hdGgucm91bmQocmdiMlswXSkgKyAnLCcgK1xyXG5cdFx0XHRcdFx0TWF0aC5yb3VuZChyZ2IyWzFdKSArICcsJyArXHJcblx0XHRcdFx0XHRNYXRoLnJvdW5kKHJnYjJbMl0pICsgJyknO1xyXG5cdFx0XHRcdGpzYy5waWNrZXIuc2xkR3JhZC5kcmF3KFRISVMuc2xpZGVyU2l6ZSwgVEhJUy5oZWlnaHQsIGNvbG9yMSwgY29sb3IyKTtcclxuXHRcdFx0XHRicmVhaztcclxuXHRcdFx0Y2FzZSAndic6XHJcblx0XHRcdFx0dmFyIHJnYiA9IGpzYy5IU1ZfUkdCKFRISVMuY2hhbm5lbHMuaCwgVEhJUy5jaGFubmVscy5zLCAxMDApO1xyXG5cdFx0XHRcdHZhciBjb2xvcjEgPSAncmdiKCcgK1xyXG5cdFx0XHRcdFx0TWF0aC5yb3VuZChyZ2JbMF0pICsgJywnICtcclxuXHRcdFx0XHRcdE1hdGgucm91bmQocmdiWzFdKSArICcsJyArXHJcblx0XHRcdFx0XHRNYXRoLnJvdW5kKHJnYlsyXSkgKyAnKSc7XHJcblx0XHRcdFx0dmFyIGNvbG9yMiA9ICcjMDAwJztcclxuXHRcdFx0XHRqc2MucGlja2VyLnNsZEdyYWQuZHJhdyhUSElTLnNsaWRlclNpemUsIFRISVMuaGVpZ2h0LCBjb2xvcjEsIGNvbG9yMik7XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdC8vIHJlZHJhdyB0aGUgYWxwaGEgc2xpZGVyXHJcblx0XHRcdGpzYy5waWNrZXIuYXNsZEdyYWQuZHJhdyhUSElTLnNsaWRlclNpemUsIFRISVMuaGVpZ2h0LCBUSElTLnRvSEVYU3RyaW5nKCkpO1xyXG5cdFx0fVxyXG5cclxuXHJcblx0XHRmdW5jdGlvbiByZWRyYXdTbGQgKCkge1xyXG5cdFx0XHR2YXIgc2xkQ2hhbm5lbCA9IGpzYy5nZXRTbGlkZXJDaGFubmVsKFRISVMpO1xyXG5cdFx0XHRpZiAoc2xkQ2hhbm5lbCkge1xyXG5cdFx0XHRcdC8vIHJlZHJhdyB0aGUgc2xpZGVyIHBvaW50ZXJcclxuXHRcdFx0XHR2YXIgeSA9IE1hdGgucm91bmQoKDEgLSBUSElTLmNoYW5uZWxzW3NsZENoYW5uZWxdIC8gMTAwKSAqIChUSElTLmhlaWdodCAtIDEpKTtcclxuXHRcdFx0XHRqc2MucGlja2VyLnNsZFB0ck9CLnN0eWxlLnRvcCA9ICh5IC0gKDIgKiBUSElTLnBvaW50ZXJCb3JkZXJXaWR0aCArIFRISVMucG9pbnRlclRoaWNrbmVzcykgLSBNYXRoLmZsb29yKGpzYy5wdWIuc2xpZGVySW5uZXJTcGFjZSAvIDIpKSArICdweCc7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdC8vIHJlZHJhdyB0aGUgYWxwaGEgc2xpZGVyXHJcblx0XHRcdGpzYy5waWNrZXIuYXNsZEdyYWQuZHJhdyhUSElTLnNsaWRlclNpemUsIFRISVMuaGVpZ2h0LCBUSElTLnRvSEVYU3RyaW5nKCkpO1xyXG5cdFx0fVxyXG5cclxuXHJcblx0XHRmdW5jdGlvbiByZWRyYXdBU2xkICgpIHtcclxuXHRcdFx0dmFyIHkgPSBNYXRoLnJvdW5kKCgxIC0gVEhJUy5jaGFubmVscy5hKSAqIChUSElTLmhlaWdodCAtIDEpKTtcclxuXHRcdFx0anNjLnBpY2tlci5hc2xkUHRyT0Iuc3R5bGUudG9wID0gKHkgLSAoMiAqIFRISVMucG9pbnRlckJvcmRlcldpZHRoICsgVEhJUy5wb2ludGVyVGhpY2tuZXNzKSAtIE1hdGguZmxvb3IoanNjLnB1Yi5zbGlkZXJJbm5lclNwYWNlIC8gMikpICsgJ3B4JztcclxuXHRcdH1cclxuXHJcblxyXG5cdFx0ZnVuY3Rpb24gaXNQaWNrZXJPd25lciAoKSB7XHJcblx0XHRcdHJldHVybiBqc2MucGlja2VyICYmIGpzYy5waWNrZXIub3duZXIgPT09IFRISVM7XHJcblx0XHR9XHJcblxyXG5cclxuXHRcdGZ1bmN0aW9uIG9uVmFsdWVLZXlEb3duIChldikge1xyXG5cdFx0XHRpZiAoanNjLmV2ZW50S2V5KGV2KSA9PT0gJ0VudGVyJykge1xyXG5cdFx0XHRcdGlmIChUSElTLnZhbHVlRWxlbWVudCkge1xyXG5cdFx0XHRcdFx0VEhJUy5wcm9jZXNzVmFsdWVJbnB1dChUSElTLnZhbHVlRWxlbWVudC52YWx1ZSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdFRISVMudHJ5SGlkZSgpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cclxuXHRcdGZ1bmN0aW9uIG9uQWxwaGFLZXlEb3duIChldikge1xyXG5cdFx0XHRpZiAoanNjLmV2ZW50S2V5KGV2KSA9PT0gJ0VudGVyJykge1xyXG5cdFx0XHRcdGlmIChUSElTLmFscGhhRWxlbWVudCkge1xyXG5cdFx0XHRcdFx0VEhJUy5wcm9jZXNzQWxwaGFJbnB1dChUSElTLmFscGhhRWxlbWVudC52YWx1ZSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdFRISVMudHJ5SGlkZSgpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cclxuXHRcdGZ1bmN0aW9uIG9uVmFsdWVDaGFuZ2UgKGV2KSB7XHJcblx0XHRcdGlmIChqc2MuZ2V0RGF0YShldiwgJ2ludGVybmFsJykpIHtcclxuXHRcdFx0XHRyZXR1cm47IC8vIHNraXAgaWYgdGhlIGV2ZW50IHdhcyBpbnRlcm5hbGx5IHRyaWdnZXJlZCBieSBqc2NvbG9yXHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHZhciBvbGRWYWwgPSBUSElTLnZhbHVlRWxlbWVudC52YWx1ZTtcclxuXHJcblx0XHRcdFRISVMucHJvY2Vzc1ZhbHVlSW5wdXQoVEhJUy52YWx1ZUVsZW1lbnQudmFsdWUpOyAvLyB0aGlzIG1pZ2h0IGNoYW5nZSB0aGUgdmFsdWVcclxuXHJcblx0XHRcdGpzYy50cmlnZ2VyQ2FsbGJhY2soVEhJUywgJ29uQ2hhbmdlJyk7XHJcblxyXG5cdFx0XHRpZiAoVEhJUy52YWx1ZUVsZW1lbnQudmFsdWUgIT09IG9sZFZhbCkge1xyXG5cdFx0XHRcdC8vIHZhbHVlIHdhcyBhZGRpdGlvbmFsbHkgY2hhbmdlZCAtPiBsZXQncyB0cmlnZ2VyIHRoZSBjaGFuZ2UgZXZlbnQgYWdhaW4sIGV2ZW4gdGhvdWdoIGl0IHdhcyBuYXRpdmVseSBkaXNwYXRjaGVkXHJcblx0XHRcdFx0anNjLnRyaWdnZXJJbnB1dEV2ZW50KFRISVMudmFsdWVFbGVtZW50LCAnY2hhbmdlJywgdHJ1ZSwgdHJ1ZSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblxyXG5cdFx0ZnVuY3Rpb24gb25BbHBoYUNoYW5nZSAoZXYpIHtcclxuXHRcdFx0aWYgKGpzYy5nZXREYXRhKGV2LCAnaW50ZXJuYWwnKSkge1xyXG5cdFx0XHRcdHJldHVybjsgLy8gc2tpcCBpZiB0aGUgZXZlbnQgd2FzIGludGVybmFsbHkgdHJpZ2dlcmVkIGJ5IGpzY29sb3JcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0dmFyIG9sZFZhbCA9IFRISVMuYWxwaGFFbGVtZW50LnZhbHVlO1xyXG5cclxuXHRcdFx0VEhJUy5wcm9jZXNzQWxwaGFJbnB1dChUSElTLmFscGhhRWxlbWVudC52YWx1ZSk7IC8vIHRoaXMgbWlnaHQgY2hhbmdlIHRoZSB2YWx1ZVxyXG5cclxuXHRcdFx0anNjLnRyaWdnZXJDYWxsYmFjayhUSElTLCAnb25DaGFuZ2UnKTtcclxuXHJcblx0XHRcdC8vIHRyaWdnZXJpbmcgdmFsdWVFbGVtZW50J3Mgb25DaGFuZ2UgKGJlY2F1c2UgY2hhbmdpbmcgYWxwaGEgY2hhbmdlcyB0aGUgZW50aXJlIGNvbG9yLCBlLmcuIHdpdGggcmdiYSBmb3JtYXQpXHJcblx0XHRcdGpzYy50cmlnZ2VySW5wdXRFdmVudChUSElTLnZhbHVlRWxlbWVudCwgJ2NoYW5nZScsIHRydWUsIHRydWUpO1xyXG5cclxuXHRcdFx0aWYgKFRISVMuYWxwaGFFbGVtZW50LnZhbHVlICE9PSBvbGRWYWwpIHtcclxuXHRcdFx0XHQvLyB2YWx1ZSB3YXMgYWRkaXRpb25hbGx5IGNoYW5nZWQgLT4gbGV0J3MgdHJpZ2dlciB0aGUgY2hhbmdlIGV2ZW50IGFnYWluLCBldmVuIHRob3VnaCBpdCB3YXMgbmF0aXZlbHkgZGlzcGF0Y2hlZFxyXG5cdFx0XHRcdGpzYy50cmlnZ2VySW5wdXRFdmVudChUSElTLmFscGhhRWxlbWVudCwgJ2NoYW5nZScsIHRydWUsIHRydWUpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cclxuXHRcdGZ1bmN0aW9uIG9uVmFsdWVJbnB1dCAoZXYpIHtcclxuXHRcdFx0aWYgKGpzYy5nZXREYXRhKGV2LCAnaW50ZXJuYWwnKSkge1xyXG5cdFx0XHRcdHJldHVybjsgLy8gc2tpcCBpZiB0aGUgZXZlbnQgd2FzIGludGVybmFsbHkgdHJpZ2dlcmVkIGJ5IGpzY29sb3JcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0aWYgKFRISVMudmFsdWVFbGVtZW50KSB7XHJcblx0XHRcdFx0VEhJUy5mcm9tU3RyaW5nKFRISVMudmFsdWVFbGVtZW50LnZhbHVlLCBqc2MuZmxhZ3MubGVhdmVWYWx1ZSk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGpzYy50cmlnZ2VyQ2FsbGJhY2soVEhJUywgJ29uSW5wdXQnKTtcclxuXHJcblx0XHRcdC8vIHRyaWdnZXJpbmcgdmFsdWVFbGVtZW50J3Mgb25JbnB1dFxyXG5cdFx0XHQvLyAobm90IG5lZWRlZCwgaXQgd2FzIGRpc3BhdGNoZWQgbm9ybWFsbHkgYnkgdGhlIGJyb3dzZXIpXHJcblx0XHR9XHJcblxyXG5cclxuXHRcdGZ1bmN0aW9uIG9uQWxwaGFJbnB1dCAoZXYpIHtcclxuXHRcdFx0aWYgKGpzYy5nZXREYXRhKGV2LCAnaW50ZXJuYWwnKSkge1xyXG5cdFx0XHRcdHJldHVybjsgLy8gc2tpcCBpZiB0aGUgZXZlbnQgd2FzIGludGVybmFsbHkgdHJpZ2dlcmVkIGJ5IGpzY29sb3JcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0aWYgKFRISVMuYWxwaGFFbGVtZW50KSB7XHJcblx0XHRcdFx0VEhJUy5mcm9tSFNWQShudWxsLCBudWxsLCBudWxsLCBwYXJzZUZsb2F0KFRISVMuYWxwaGFFbGVtZW50LnZhbHVlKSwganNjLmZsYWdzLmxlYXZlQWxwaGEpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRqc2MudHJpZ2dlckNhbGxiYWNrKFRISVMsICdvbklucHV0Jyk7XHJcblxyXG5cdFx0XHQvLyB0cmlnZ2VyaW5nIHZhbHVlRWxlbWVudCdzIG9uSW5wdXQgKGJlY2F1c2UgY2hhbmdpbmcgYWxwaGEgY2hhbmdlcyB0aGUgZW50aXJlIGNvbG9yLCBlLmcuIHdpdGggcmdiYSBmb3JtYXQpXHJcblx0XHRcdGpzYy50cmlnZ2VySW5wdXRFdmVudChUSElTLnZhbHVlRWxlbWVudCwgJ2lucHV0JywgdHJ1ZSwgdHJ1ZSk7XHJcblx0XHR9XHJcblxyXG5cclxuXHRcdC8vIGxldCdzIHByb2Nlc3MgdGhlIERFUFJFQ0FURUQgJ29wdGlvbnMnIHByb3BlcnR5ICh0aGlzIHdpbGwgYmUgbGF0ZXIgcmVtb3ZlZClcclxuXHRcdGlmIChqc2MucHViLm9wdGlvbnMpIHtcclxuXHRcdFx0Ly8gbGV0J3Mgc2V0IGN1c3RvbSBkZWZhdWx0IG9wdGlvbnMsIGlmIHNwZWNpZmllZFxyXG5cdFx0XHRmb3IgKHZhciBvcHQgaW4ganNjLnB1Yi5vcHRpb25zKSB7XHJcblx0XHRcdFx0aWYgKGpzYy5wdWIub3B0aW9ucy5oYXNPd25Qcm9wZXJ0eShvcHQpKSB7XHJcblx0XHRcdFx0XHR0cnkge1xyXG5cdFx0XHRcdFx0XHRzZXRPcHRpb24ob3B0LCBqc2MucHViLm9wdGlvbnNbb3B0XSk7XHJcblx0XHRcdFx0XHR9IGNhdGNoIChlKSB7XHJcblx0XHRcdFx0XHRcdGNvbnNvbGUud2FybihlKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblxyXG5cdFx0Ly8gbGV0J3MgYXBwbHkgY29uZmlndXJhdGlvbiBwcmVzZXRzXHJcblx0XHQvL1xyXG5cdFx0dmFyIHByZXNldHNBcnIgPSBbXTtcclxuXHJcblx0XHRpZiAob3B0cy5wcmVzZXQpIHtcclxuXHRcdFx0aWYgKHR5cGVvZiBvcHRzLnByZXNldCA9PT0gJ3N0cmluZycpIHtcclxuXHRcdFx0XHRwcmVzZXRzQXJyID0gb3B0cy5wcmVzZXQuc3BsaXQoL1xccysvKTtcclxuXHRcdFx0fSBlbHNlIGlmIChBcnJheS5pc0FycmF5KG9wdHMucHJlc2V0KSkge1xyXG5cdFx0XHRcdHByZXNldHNBcnIgPSBvcHRzLnByZXNldC5zbGljZSgpOyAvLyBzbGljZSgpIHRvIGNsb25lXHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0Y29uc29sZS53YXJuKCdVbnJlY29nbml6ZWQgcHJlc2V0IHZhbHVlJyk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHQvLyBhbHdheXMgdXNlIHRoZSAnZGVmYXVsdCcgcHJlc2V0LiBJZiBpdCdzIG5vdCBsaXN0ZWQsIGFwcGVuZCBpdCB0byB0aGUgZW5kLlxyXG5cdFx0aWYgKHByZXNldHNBcnIuaW5kZXhPZignZGVmYXVsdCcpID09PSAtMSkge1xyXG5cdFx0XHRwcmVzZXRzQXJyLnB1c2goJ2RlZmF1bHQnKTtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBsZXQncyBhcHBseSB0aGUgcHJlc2V0cyBpbiByZXZlcnNlIG9yZGVyLCBzbyB0aGF0IHNob3VsZCB0aGVyZSBiZSBhbnkgb3ZlcmxhcHBpbmcgb3B0aW9ucyxcclxuXHRcdC8vIHRoZSBmb3JtZXJseSBsaXN0ZWQgcHJlc2V0IHdpbGwgb3ZlcnJpZGUgdGhlIGxhdHRlclxyXG5cdFx0Zm9yICh2YXIgaSA9IHByZXNldHNBcnIubGVuZ3RoIC0gMTsgaSA+PSAwOyBpIC09IDEpIHtcclxuXHRcdFx0dmFyIHByZXMgPSBwcmVzZXRzQXJyW2ldO1xyXG5cdFx0XHRpZiAoIXByZXMpIHtcclxuXHRcdFx0XHRjb250aW51ZTsgLy8gcHJlc2V0IGlzIGVtcHR5IHN0cmluZ1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmICghanNjLnB1Yi5wcmVzZXRzLmhhc093blByb3BlcnR5KHByZXMpKSB7XHJcblx0XHRcdFx0Y29uc29sZS53YXJuKCdVbmtub3duIHByZXNldDogJXMnLCBwcmVzKTtcclxuXHRcdFx0XHRjb250aW51ZTtcclxuXHRcdFx0fVxyXG5cdFx0XHRmb3IgKHZhciBvcHQgaW4ganNjLnB1Yi5wcmVzZXRzW3ByZXNdKSB7XHJcblx0XHRcdFx0aWYgKGpzYy5wdWIucHJlc2V0c1twcmVzXS5oYXNPd25Qcm9wZXJ0eShvcHQpKSB7XHJcblx0XHRcdFx0XHR0cnkge1xyXG5cdFx0XHRcdFx0XHRzZXRPcHRpb24ob3B0LCBqc2MucHViLnByZXNldHNbcHJlc11bb3B0XSk7XHJcblx0XHRcdFx0XHR9IGNhdGNoIChlKSB7XHJcblx0XHRcdFx0XHRcdGNvbnNvbGUud2FybihlKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblxyXG5cdFx0Ly8gbGV0J3Mgc2V0IHNwZWNpZmljIG9wdGlvbnMgZm9yIHRoaXMgY29sb3IgcGlja2VyXHJcblx0XHR2YXIgbm9uUHJvcGVydGllcyA9IFtcclxuXHRcdFx0Ly8gdGhlc2Ugb3B0aW9ucyB3b24ndCBiZSBzZXQgYXMgaW5zdGFuY2UgcHJvcGVydGllc1xyXG5cdFx0XHQncHJlc2V0JyxcclxuXHRcdF07XHJcblx0XHRmb3IgKHZhciBvcHQgaW4gb3B0cykge1xyXG5cdFx0XHRpZiAob3B0cy5oYXNPd25Qcm9wZXJ0eShvcHQpKSB7XHJcblx0XHRcdFx0aWYgKG5vblByb3BlcnRpZXMuaW5kZXhPZihvcHQpID09PSAtMSkge1xyXG5cdFx0XHRcdFx0dHJ5IHtcclxuXHRcdFx0XHRcdFx0c2V0T3B0aW9uKG9wdCwgb3B0c1tvcHRdKTtcclxuXHRcdFx0XHRcdH0gY2F0Y2ggKGUpIHtcclxuXHRcdFx0XHRcdFx0Y29uc29sZS53YXJuKGUpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHJcblx0XHQvL1xyXG5cdFx0Ly8gSW5zdGFsbCB0aGUgY29sb3IgcGlja2VyIG9uIGNob3NlbiBlbGVtZW50KHMpXHJcblx0XHQvL1xyXG5cclxuXHJcblx0XHQvLyBEZXRlcm1pbmUgcGlja2VyJ3MgY29udGFpbmVyIGVsZW1lbnRcclxuXHRcdGlmICh0aGlzLmNvbnRhaW5lciA9PT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdHRoaXMuY29udGFpbmVyID0gd2luZG93LmRvY3VtZW50LmJvZHk7IC8vIGRlZmF1bHQgY29udGFpbmVyIGlzIEJPRFkgZWxlbWVudFxyXG5cclxuXHRcdH0gZWxzZSB7IC8vIGV4cGxpY2l0bHkgc2V0IHRvIGN1c3RvbSBlbGVtZW50XHJcblx0XHRcdHRoaXMuY29udGFpbmVyID0ganNjLm5vZGUodGhpcy5jb250YWluZXIpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmICghdGhpcy5jb250YWluZXIpIHtcclxuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdDYW5ub3QgaW5zdGFudGlhdGUgY29sb3IgcGlja2VyIHdpdGhvdXQgYSBjb250YWluZXIgZWxlbWVudCcpO1xyXG5cdFx0fVxyXG5cclxuXHJcblx0XHQvLyBGZXRjaCB0aGUgdGFyZ2V0IGVsZW1lbnRcclxuXHRcdHRoaXMudGFyZ2V0RWxlbWVudCA9IGpzYy5ub2RlKHRhcmdldEVsZW1lbnQpO1xyXG5cclxuXHRcdGlmICghdGhpcy50YXJnZXRFbGVtZW50KSB7XHJcblx0XHRcdC8vIHRlbXBvcmFyaWx5IGN1c3RvbWl6ZWQgZXJyb3IgbWVzc2FnZSB0byBoZWxwIHdpdGggbWlncmF0aW5nIGZyb20gdmVyc2lvbnMgcHJpb3IgdG8gMi4yXHJcblx0XHRcdGlmICh0eXBlb2YgdGFyZ2V0RWxlbWVudCA9PT0gJ3N0cmluZycgJiYgL15bYS16QS1aXVtcXHc6Li1dKiQvLnRlc3QodGFyZ2V0RWxlbWVudCkpIHtcclxuXHRcdFx0XHQvLyB0YXJnZXRFbGVtZW50IGxvb2tzIGxpa2UgdmFsaWQgSURcclxuXHRcdFx0XHR2YXIgcG9zc2libHlJZCA9IHRhcmdldEVsZW1lbnQ7XHJcblx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKCdJZiBcXCcnICsgcG9zc2libHlJZCArICdcXCcgaXMgc3VwcG9zZWQgdG8gYmUgYW4gSUQsIHBsZWFzZSB1c2UgXFwnIycgKyBwb3NzaWJseUlkICsgJ1xcJyBvciBhbnkgdmFsaWQgQ1NTIHNlbGVjdG9yLicpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0Nhbm5vdCBpbnN0YW50aWF0ZSBjb2xvciBwaWNrZXIgd2l0aG91dCBhIHRhcmdldCBlbGVtZW50Jyk7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKHRoaXMudGFyZ2V0RWxlbWVudC5qc2NvbG9yICYmIHRoaXMudGFyZ2V0RWxlbWVudC5qc2NvbG9yIGluc3RhbmNlb2YganNjLnB1Yikge1xyXG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0NvbG9yIHBpY2tlciBhbHJlYWR5IGluc3RhbGxlZCBvbiB0aGlzIGVsZW1lbnQnKTtcclxuXHRcdH1cclxuXHJcblxyXG5cdFx0Ly8gbGluayB0aGlzIGluc3RhbmNlIHdpdGggdGhlIHRhcmdldCBlbGVtZW50XHJcblx0XHR0aGlzLnRhcmdldEVsZW1lbnQuanNjb2xvciA9IHRoaXM7XHJcblx0XHRqc2MuYWRkQ2xhc3ModGhpcy50YXJnZXRFbGVtZW50LCBqc2MucHViLmNsYXNzTmFtZSk7XHJcblxyXG5cdFx0Ly8gcmVnaXN0ZXIgdGhpcyBpbnN0YW5jZVxyXG5cdFx0anNjLmluc3RhbmNlcy5wdXNoKHRoaXMpO1xyXG5cclxuXHJcblx0XHQvLyBpZiB0YXJnZXQgaXMgQlVUVE9OXHJcblx0XHRpZiAoanNjLmlzQnV0dG9uKHRoaXMudGFyZ2V0RWxlbWVudCkpIHtcclxuXHJcblx0XHRcdGlmICh0aGlzLnRhcmdldEVsZW1lbnQudHlwZS50b0xvd2VyQ2FzZSgpICE9PSAnYnV0dG9uJykge1xyXG5cdFx0XHRcdC8vIG9uIGJ1dHRvbnMsIGFsd2F5cyBmb3JjZSB0eXBlIHRvIGJlICdidXR0b24nLCBlLmcuIGluIHNpdHVhdGlvbnMgdGhlIHRhcmdldCA8YnV0dG9uPiBoYXMgbm8gdHlwZVxyXG5cdFx0XHRcdC8vIGFuZCB0aHVzIGRlZmF1bHRzIHRvICdzdWJtaXQnIGFuZCB3b3VsZCBzdWJtaXQgdGhlIGZvcm0gd2hlbiBjbGlja2VkXHJcblx0XHRcdFx0dGhpcy50YXJnZXRFbGVtZW50LnR5cGUgPSAnYnV0dG9uJztcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0aWYgKGpzYy5pc0J1dHRvbkVtcHR5KHRoaXMudGFyZ2V0RWxlbWVudCkpIHsgLy8gZW1wdHkgYnV0dG9uXHJcblx0XHRcdFx0Ly8gaXQgaXMgaW1wb3J0YW50IHRvIGNsZWFyIGVsZW1lbnQncyBjb250ZW50cyBmaXJzdC5cclxuXHRcdFx0XHQvLyBpZiB3ZSdyZSByZS1pbnN0YW50aWF0aW5nIGNvbG9yIHBpY2tlcnMgb24gRE9NIHRoYXQgaGFzIGJlZW4gbW9kaWZpZWQgYnkgY2hhbmdpbmcgcGFnZSdzIGlubmVySFRNTCxcclxuXHRcdFx0XHQvLyB3ZSB3b3VsZCBrZWVwIGFkZGluZyBtb3JlIG5vbi1icmVha2luZyBzcGFjZXMgdG8gZWxlbWVudCdzIGNvbnRlbnQgKGJlY2F1c2UgZWxlbWVudCdzIGNvbnRlbnRzIHN1cnZpdmVcclxuXHRcdFx0XHQvLyBpbm5lckhUTUwgY2hhbmdlcywgYnV0IHBpY2tlciBpbnN0YW5jZXMgZG9uJ3QpXHJcblx0XHRcdFx0anNjLnJlbW92ZUNoaWxkcmVuKHRoaXMudGFyZ2V0RWxlbWVudCk7XHJcblxyXG5cdFx0XHRcdC8vIGxldCdzIGluc2VydCBhIG5vbi1icmVha2luZyBzcGFjZVxyXG5cdFx0XHRcdHRoaXMudGFyZ2V0RWxlbWVudC5hcHBlbmRDaGlsZCh3aW5kb3cuZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJ1xceGEwJykpO1xyXG5cclxuXHRcdFx0XHQvLyBzZXQgbWluLXdpZHRoID0gcHJldmlld1NpemUsIGlmIG5vdCBhbHJlYWR5IGdyZWF0ZXJcclxuXHRcdFx0XHR2YXIgY29tcFN0eWxlID0ganNjLmdldENvbXBTdHlsZSh0aGlzLnRhcmdldEVsZW1lbnQpO1xyXG5cdFx0XHRcdHZhciBjdXJyTWluV2lkdGggPSBwYXJzZUZsb2F0KGNvbXBTdHlsZVsnbWluLXdpZHRoJ10pIHx8IDA7XHJcblx0XHRcdFx0aWYgKGN1cnJNaW5XaWR0aCA8IHRoaXMucHJldmlld1NpemUpIHtcclxuXHRcdFx0XHRcdGpzYy5zZXRTdHlsZSh0aGlzLnRhcmdldEVsZW1lbnQsIHtcclxuXHRcdFx0XHRcdFx0J21pbi13aWR0aCc6IHRoaXMucHJldmlld1NpemUgKyAncHgnLFxyXG5cdFx0XHRcdFx0fSwgdGhpcy5mb3JjZVN0eWxlKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHQvLyBEZXRlcm1pbmUgdGhlIHZhbHVlIGVsZW1lbnRcclxuXHRcdGlmICh0aGlzLnZhbHVlRWxlbWVudCA9PT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdGlmIChqc2MuaXNUZXh0SW5wdXQodGhpcy50YXJnZXRFbGVtZW50KSkge1xyXG5cdFx0XHRcdC8vIGZvciB0ZXh0IGlucHV0cywgZGVmYXVsdCB2YWx1ZUVsZW1lbnQgaXMgdGFyZ2V0RWxlbWVudFxyXG5cdFx0XHRcdHRoaXMudmFsdWVFbGVtZW50ID0gdGhpcy50YXJnZXRFbGVtZW50O1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdC8vIGxlYXZlIGl0IHVuZGVmaW5lZFxyXG5cdFx0XHR9XHJcblxyXG5cdFx0fSBlbHNlIGlmICh0aGlzLnZhbHVlRWxlbWVudCA9PT0gbnVsbCkgeyAvLyBleHBsaWNpdGx5IHNldCB0byBudWxsXHJcblx0XHRcdC8vIGxlYXZlIGl0IG51bGxcclxuXHJcblx0XHR9IGVsc2UgeyAvLyBleHBsaWNpdGx5IHNldCB0byBjdXN0b20gZWxlbWVudFxyXG5cdFx0XHR0aGlzLnZhbHVlRWxlbWVudCA9IGpzYy5ub2RlKHRoaXMudmFsdWVFbGVtZW50KTtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBEZXRlcm1pbmUgdGhlIGFscGhhIGVsZW1lbnRcclxuXHRcdGlmICh0aGlzLmFscGhhRWxlbWVudCkge1xyXG5cdFx0XHR0aGlzLmFscGhhRWxlbWVudCA9IGpzYy5ub2RlKHRoaXMuYWxwaGFFbGVtZW50KTtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBEZXRlcm1pbmUgdGhlIHByZXZpZXcgZWxlbWVudFxyXG5cdFx0aWYgKHRoaXMucHJldmlld0VsZW1lbnQgPT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHR0aGlzLnByZXZpZXdFbGVtZW50ID0gdGhpcy50YXJnZXRFbGVtZW50OyAvLyBkZWZhdWx0IHByZXZpZXdFbGVtZW50IGlzIHRhcmdldEVsZW1lbnRcclxuXHJcblx0XHR9IGVsc2UgaWYgKHRoaXMucHJldmlld0VsZW1lbnQgPT09IG51bGwpIHsgLy8gZXhwbGljaXRseSBzZXQgdG8gbnVsbFxyXG5cdFx0XHQvLyBsZWF2ZSBpdCBudWxsXHJcblxyXG5cdFx0fSBlbHNlIHsgLy8gZXhwbGljaXRseSBzZXQgdG8gY3VzdG9tIGVsZW1lbnRcclxuXHRcdFx0dGhpcy5wcmV2aWV3RWxlbWVudCA9IGpzYy5ub2RlKHRoaXMucHJldmlld0VsZW1lbnQpO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIHZhbHVlRWxlbWVudFxyXG5cdFx0aWYgKHRoaXMudmFsdWVFbGVtZW50ICYmIGpzYy5pc1RleHRJbnB1dCh0aGlzLnZhbHVlRWxlbWVudCkpIHtcclxuXHJcblx0XHRcdC8vIElmIHRoZSB2YWx1ZSBlbGVtZW50IGhhcyBvbklucHV0IGV2ZW50IGFscmVhZHkgc2V0LCB3ZSBuZWVkIHRvIGRldGFjaCBpdCBhbmQgYXR0YWNoIEFGVEVSIG91ciBsaXN0ZW5lci5cclxuXHRcdFx0Ly8gb3RoZXJ3aXNlIHRoZSBwaWNrZXIgaW5zdGFuY2Ugd291bGQgc3RpbGwgY29udGFpbiB0aGUgb2xkIGNvbG9yIHdoZW4gYWNjZXNzZWQgZnJvbSB0aGUgb25JbnB1dCBoYW5kbGVyLlxyXG5cdFx0XHR2YXIgdmFsdWVFbGVtZW50T3JpZ0V2ZW50cyA9IHtcclxuXHRcdFx0XHRvbklucHV0OiB0aGlzLnZhbHVlRWxlbWVudC5vbmlucHV0XHJcblx0XHRcdH07XHJcblx0XHRcdHRoaXMudmFsdWVFbGVtZW50Lm9uaW5wdXQgPSBudWxsO1xyXG5cclxuXHRcdFx0dGhpcy52YWx1ZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIG9uVmFsdWVLZXlEb3duLCBmYWxzZSk7XHJcblx0XHRcdHRoaXMudmFsdWVFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIG9uVmFsdWVDaGFuZ2UsIGZhbHNlKTtcclxuXHRcdFx0dGhpcy52YWx1ZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBvblZhbHVlSW5wdXQsIGZhbHNlKTtcclxuXHRcdFx0Ly8gdGhlIG9yaWdpbmFsIGV2ZW50IGxpc3RlbmVyIG11c3QgYmUgYXR0YWNoZWQgQUZURVIgb3VyIGhhbmRsZXIgKHRvIGxldCBpdCBmaXJzdCBzZXQgcGlja2VyJ3MgY29sb3IpXHJcblx0XHRcdGlmICh2YWx1ZUVsZW1lbnRPcmlnRXZlbnRzLm9uSW5wdXQpIHtcclxuXHRcdFx0XHR0aGlzLnZhbHVlRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIHZhbHVlRWxlbWVudE9yaWdFdmVudHMub25JbnB1dCwgZmFsc2UpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR0aGlzLnZhbHVlRWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2F1dG9jb21wbGV0ZScsICdvZmYnKTtcclxuXHRcdFx0dGhpcy52YWx1ZUVsZW1lbnQuc2V0QXR0cmlidXRlKCdhdXRvY29ycmVjdCcsICdvZmYnKTtcclxuXHRcdFx0dGhpcy52YWx1ZUVsZW1lbnQuc2V0QXR0cmlidXRlKCdhdXRvY2FwaXRhbGl6ZScsICdvZmYnKTtcclxuXHRcdFx0dGhpcy52YWx1ZUVsZW1lbnQuc2V0QXR0cmlidXRlKCdzcGVsbGNoZWNrJywgZmFsc2UpO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIGFscGhhRWxlbWVudFxyXG5cdFx0aWYgKHRoaXMuYWxwaGFFbGVtZW50ICYmIGpzYy5pc1RleHRJbnB1dCh0aGlzLmFscGhhRWxlbWVudCkpIHtcclxuXHRcdFx0dGhpcy5hbHBoYUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIG9uQWxwaGFLZXlEb3duLCBmYWxzZSk7XHJcblx0XHRcdHRoaXMuYWxwaGFFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIG9uQWxwaGFDaGFuZ2UsIGZhbHNlKTtcclxuXHRcdFx0dGhpcy5hbHBoYUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBvbkFscGhhSW5wdXQsIGZhbHNlKTtcclxuXHJcblx0XHRcdHRoaXMuYWxwaGFFbGVtZW50LnNldEF0dHJpYnV0ZSgnYXV0b2NvbXBsZXRlJywgJ29mZicpO1xyXG5cdFx0XHR0aGlzLmFscGhhRWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2F1dG9jb3JyZWN0JywgJ29mZicpO1xyXG5cdFx0XHR0aGlzLmFscGhhRWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2F1dG9jYXBpdGFsaXplJywgJ29mZicpO1xyXG5cdFx0XHR0aGlzLmFscGhhRWxlbWVudC5zZXRBdHRyaWJ1dGUoJ3NwZWxsY2hlY2snLCBmYWxzZSk7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gZGV0ZXJtaW5lIGluaXRpYWwgY29sb3IgdmFsdWVcclxuXHRcdC8vXHJcblx0XHR2YXIgaW5pdFZhbHVlID0gJ0ZGRkZGRic7XHJcblxyXG5cdFx0aWYgKHRoaXMudmFsdWUgIT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRpbml0VmFsdWUgPSB0aGlzLnZhbHVlOyAvLyBnZXQgaW5pdGlhbCBjb2xvciBmcm9tIHRoZSAndmFsdWUnIHByb3BlcnR5XHJcblx0XHR9IGVsc2UgaWYgKHRoaXMudmFsdWVFbGVtZW50ICYmIHRoaXMudmFsdWVFbGVtZW50LnZhbHVlICE9PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0aW5pdFZhbHVlID0gdGhpcy52YWx1ZUVsZW1lbnQudmFsdWU7IC8vIGdldCBpbml0aWFsIGNvbG9yIGZyb20gdmFsdWVFbGVtZW50J3MgdmFsdWVcclxuXHRcdH1cclxuXHJcblx0XHQvLyBkZXRlcm1pbmUgaW5pdGlhbCBhbHBoYSB2YWx1ZVxyXG5cdFx0Ly9cclxuXHRcdHZhciBpbml0QWxwaGEgPSB1bmRlZmluZWQ7XHJcblxyXG5cdFx0aWYgKHRoaXMuYWxwaGEgIT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRpbml0QWxwaGEgPSAoJycrdGhpcy5hbHBoYSk7IC8vIGdldCBpbml0aWFsIGFscGhhIHZhbHVlIGZyb20gdGhlICdhbHBoYScgcHJvcGVydHlcclxuXHRcdH0gZWxzZSBpZiAodGhpcy5hbHBoYUVsZW1lbnQgJiYgdGhpcy5hbHBoYUVsZW1lbnQudmFsdWUgIT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRpbml0QWxwaGEgPSB0aGlzLmFscGhhRWxlbWVudC52YWx1ZTsgLy8gZ2V0IGluaXRpYWwgY29sb3IgZnJvbSBhbHBoYUVsZW1lbnQncyB2YWx1ZVxyXG5cdFx0fVxyXG5cclxuXHRcdC8vIGRldGVybWluZSBjdXJyZW50IGZvcm1hdCBiYXNlZCBvbiB0aGUgaW5pdGlhbCBjb2xvciB2YWx1ZVxyXG5cdFx0Ly9cclxuXHRcdHRoaXMuX2N1cnJlbnRGb3JtYXQgPSBudWxsO1xyXG5cclxuXHRcdGlmIChbJ2F1dG8nLCAnYW55J10uaW5kZXhPZih0aGlzLmZvcm1hdC50b0xvd2VyQ2FzZSgpKSA+IC0xKSB7XHJcblx0XHRcdC8vIGZvcm1hdCBpcyAnYXV0bycgb3IgJ2FueScgLT4gbGV0J3MgYXV0by1kZXRlY3QgY3VycmVudCBmb3JtYXRcclxuXHRcdFx0dmFyIGNvbG9yID0ganNjLnBhcnNlQ29sb3JTdHJpbmcoaW5pdFZhbHVlKTtcclxuXHRcdFx0dGhpcy5fY3VycmVudEZvcm1hdCA9IGNvbG9yID8gY29sb3IuZm9ybWF0IDogJ2hleCc7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHQvLyBmb3JtYXQgaXMgc3BlY2lmaWVkXHJcblx0XHRcdHRoaXMuX2N1cnJlbnRGb3JtYXQgPSB0aGlzLmZvcm1hdC50b0xvd2VyQ2FzZSgpO1xyXG5cdFx0fVxyXG5cclxuXHJcblx0XHQvLyBsZXQncyBwYXJzZSB0aGUgaW5pdGlhbCBjb2xvciB2YWx1ZSBhbmQgZXhwb3NlIGNvbG9yJ3MgcHJldmlld1xyXG5cdFx0dGhpcy5wcm9jZXNzVmFsdWVJbnB1dChpbml0VmFsdWUpO1xyXG5cclxuXHRcdC8vIGxldCdzIGFsc28gcGFyc2UgYW5kIGV4cG9zZSB0aGUgaW5pdGlhbCBhbHBoYSB2YWx1ZSwgaWYgYW55XHJcblx0XHQvL1xyXG5cdFx0Ly8gTm90ZTogSWYgdGhlIGluaXRpYWwgY29sb3IgdmFsdWUgY29udGFpbnMgYWxwaGEgdmFsdWUgaW4gaXQgKGUuZy4gaW4gcmdiYSBmb3JtYXQpLFxyXG5cdFx0Ly8gdGhpcyB3aWxsIG92ZXJ3cml0ZSBpdC4gU28gd2Ugc2hvdWxkIG9ubHkgcHJvY2VzcyBhbHBoYSBpbnB1dCBpZiB0aGVyZSB3YXMgaW5pdGlhbFxyXG5cdFx0Ly8gYWxwaGEgZXhwbGljaXRseSBzZXQsIG90aGVyd2lzZSB3ZSBjb3VsZCBuZWVkbGVzc2x5IGxvc2UgaW5pdGlhbCB2YWx1ZSdzIGFscGhhXHJcblx0XHRpZiAoaW5pdEFscGhhICE9PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0dGhpcy5wcm9jZXNzQWxwaGFJbnB1dChpbml0QWxwaGEpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmICh0aGlzLnJhbmRvbSkge1xyXG5cdFx0XHQvLyByYW5kb21pemUgdGhlIGluaXRpYWwgY29sb3IgdmFsdWVcclxuXHRcdFx0dGhpcy5yYW5kb21pemUuYXBwbHkodGhpcywgQXJyYXkuaXNBcnJheSh0aGlzLnJhbmRvbSkgPyB0aGlzLnJhbmRvbSA6IFtdKTtcclxuXHRcdH1cclxuXHJcblx0fVxyXG5cclxufTtcclxuXHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFB1YmxpYyBwcm9wZXJ0aWVzIGFuZCBtZXRob2RzXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8vXHJcbi8vIFRoZXNlIHdpbGwgYmUgcHVibGljbHkgYXZhaWxhYmxlIHZpYSBqc2NvbG9yLjxuYW1lPiBhbmQgSlNDb2xvci48bmFtZT5cclxuLy9cclxuXHJcblxyXG4vLyBjbGFzcyB0aGF0IHdpbGwgYmUgc2V0IHRvIGVsZW1lbnRzIGhhdmluZyBqc2NvbG9yIGluc3RhbGxlZCBvbiB0aGVtXHJcbmpzYy5wdWIuY2xhc3NOYW1lID0gJ2pzY29sb3InO1xyXG5cclxuXHJcbi8vIGNsYXNzIHRoYXQgd2lsbCBiZSBzZXQgdG8gZWxlbWVudHMgaGF2aW5nIGpzY29sb3IgYWN0aXZlIG9uIHRoZW1cclxuanNjLnB1Yi5hY3RpdmVDbGFzc05hbWUgPSAnanNjb2xvci1hY3RpdmUnO1xyXG5cclxuXHJcbi8vIHdoZXRoZXIgdG8gdHJ5IHRvIHBhcnNlIHRoZSBvcHRpb25zIHN0cmluZyBieSBldmFsdWF0aW5nIGl0IHVzaW5nICduZXcgRnVuY3Rpb24oKSdcclxuLy8gaW4gY2FzZSBpdCBjb3VsZCBub3QgYmUgcGFyc2VkIHdpdGggSlNPTi5wYXJzZSgpXHJcbmpzYy5wdWIubG9vc2VKU09OID0gdHJ1ZTtcclxuXHJcblxyXG4vLyBwcmVzZXRzXHJcbmpzYy5wdWIucHJlc2V0cyA9IHt9O1xyXG5cclxuLy8gYnVpbHQtaW4gcHJlc2V0c1xyXG5qc2MucHViLnByZXNldHNbJ2RlZmF1bHQnXSA9IHt9OyAvLyBiYXNlbGluZSBmb3IgY3VzdG9taXphdGlvblxyXG5cclxuanNjLnB1Yi5wcmVzZXRzWydsaWdodCddID0geyAvLyBkZWZhdWx0IGNvbG9yIHNjaGVtZVxyXG5cdGJhY2tncm91bmRDb2xvcjogJ3JnYmEoMjU1LDI1NSwyNTUsMSknLFxyXG5cdGNvbnRyb2xCb3JkZXJDb2xvcjogJ3JnYmEoMTg3LDE4NywxODcsMSknLFxyXG5cdGJ1dHRvbkNvbG9yOiAncmdiYSgwLDAsMCwxKScsXHJcbn07XHJcbmpzYy5wdWIucHJlc2V0c1snZGFyayddID0ge1xyXG5cdGJhY2tncm91bmRDb2xvcjogJ3JnYmEoNTEsNTEsNTEsMSknLFxyXG5cdGNvbnRyb2xCb3JkZXJDb2xvcjogJ3JnYmEoMTUzLDE1MywxNTMsMSknLFxyXG5cdGJ1dHRvbkNvbG9yOiAncmdiYSgyNDAsMjQwLDI0MCwxKScsXHJcbn07XHJcblxyXG5qc2MucHViLnByZXNldHNbJ3NtYWxsJ10gPSB7IHdpZHRoOjEwMSwgaGVpZ2h0OjEwMSwgcGFkZGluZzoxMCwgc2xpZGVyU2l6ZToxNCwgcGFsZXR0ZUNvbHM6OCB9O1xyXG5qc2MucHViLnByZXNldHNbJ21lZGl1bSddID0geyB3aWR0aDoxODEsIGhlaWdodDoxMDEsIHBhZGRpbmc6MTIsIHNsaWRlclNpemU6MTYsIHBhbGV0dGVDb2xzOjEwIH07IC8vIGRlZmF1bHQgc2l6ZVxyXG5qc2MucHViLnByZXNldHNbJ2xhcmdlJ10gPSB7IHdpZHRoOjI3MSwgaGVpZ2h0OjE1MSwgcGFkZGluZzoxMiwgc2xpZGVyU2l6ZToyNCwgcGFsZXR0ZUNvbHM6MTUgfTtcclxuXHJcbmpzYy5wdWIucHJlc2V0c1sndGhpbiddID0geyBib3JkZXJXaWR0aDoxLCBjb250cm9sQm9yZGVyV2lkdGg6MSwgcG9pbnRlckJvcmRlcldpZHRoOjEgfTsgLy8gZGVmYXVsdCB0aGlja25lc3NcclxuanNjLnB1Yi5wcmVzZXRzWyd0aGljayddID0geyBib3JkZXJXaWR0aDoyLCBjb250cm9sQm9yZGVyV2lkdGg6MiwgcG9pbnRlckJvcmRlcldpZHRoOjIgfTtcclxuXHJcblxyXG4vLyBzaXplIG9mIHNwYWNlIGluIHRoZSBzbGlkZXJzXHJcbmpzYy5wdWIuc2xpZGVySW5uZXJTcGFjZSA9IDM7IC8vIHB4XHJcblxyXG4vLyB0cmFuc3BhcmVuY3kgY2hlc3Nib2FyZFxyXG5qc2MucHViLmNoZXNzYm9hcmRTaXplID0gODsgLy8gcHhcclxuanNjLnB1Yi5jaGVzc2JvYXJkQ29sb3IxID0gJyM2NjY2NjYnO1xyXG5qc2MucHViLmNoZXNzYm9hcmRDb2xvcjIgPSAnIzk5OTk5OSc7XHJcblxyXG4vLyBwcmV2aWV3IHNlcGFyYXRvclxyXG5qc2MucHViLnByZXZpZXdTZXBhcmF0b3IgPSBbJ3JnYmEoMjU1LDI1NSwyNTUsLjY1KScsICdyZ2JhKDEyOCwxMjgsMTI4LC42NSknXTtcclxuXHJcblxyXG4vLyBJbml0aWFsaXplcyBqc2NvbG9yXHJcbmpzYy5wdWIuaW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuXHRpZiAoanNjLmluaXRpYWxpemVkKSB7XHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG5cclxuXHQvLyBhdHRhY2ggc29tZSBuZWNlc3NhcnkgaGFuZGxlcnNcclxuXHR3aW5kb3cuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywganNjLm9uRG9jdW1lbnRNb3VzZURvd24sIGZhbHNlKTtcclxuXHR3aW5kb3cuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBqc2Mub25Eb2N1bWVudEtleVVwLCBmYWxzZSk7XHJcblx0d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIGpzYy5vbldpbmRvd1Jlc2l6ZSwgZmFsc2UpO1xyXG5cdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCBqc2Mub25XaW5kb3dTY3JvbGwsIGZhbHNlKTtcclxuXHJcblx0Ly8gYXBwZW5kIGRlZmF1bHQgQ1NTIHRvIEhFQURcclxuXHRqc2MuYXBwZW5kRGVmYXVsdENzcygpO1xyXG5cclxuXHQvLyBpbnN0YWxsIGpzY29sb3Igb24gY3VycmVudCBET01cclxuXHRqc2MucHViLmluc3RhbGwoKTtcclxuXHJcblx0anNjLmluaXRpYWxpemVkID0gdHJ1ZTtcclxuXHJcblx0Ly8gY2FsbCBmdW5jdGlvbnMgd2FpdGluZyBpbiB0aGUgcXVldWVcclxuXHR3aGlsZSAoanNjLnJlYWR5UXVldWUubGVuZ3RoKSB7XHJcblx0XHR2YXIgZnVuYyA9IGpzYy5yZWFkeVF1ZXVlLnNoaWZ0KCk7XHJcblx0XHRmdW5jKCk7XHJcblx0fVxyXG59O1xyXG5cclxuXHJcbi8vIEluc3RhbGxzIGpzY29sb3Igb24gY3VycmVudCBET00gdHJlZVxyXG5qc2MucHViLmluc3RhbGwgPSBmdW5jdGlvbiAocm9vdE5vZGUpIHtcclxuXHR2YXIgc3VjY2VzcyA9IHRydWU7XHJcblxyXG5cdHRyeSB7XHJcblx0XHRqc2MuaW5zdGFsbEJ5U2VsZWN0b3IoJ1tkYXRhLWpzY29sb3JdJywgcm9vdE5vZGUpO1xyXG5cdH0gY2F0Y2ggKGUpIHtcclxuXHRcdHN1Y2Nlc3MgPSBmYWxzZTtcclxuXHRcdGNvbnNvbGUud2FybihlKTtcclxuXHR9XHJcblxyXG5cdC8vIGZvciBiYWNrd2FyZCBjb21wYXRpYmlsaXR5IHdpdGggREVQUkVDQVRFRCBpbnN0YWxsYXRpb24gdXNpbmcgY2xhc3MgbmFtZVxyXG5cdGlmIChqc2MucHViLmxvb2t1cENsYXNzKSB7XHJcblx0XHR0cnkge1xyXG5cdFx0XHRqc2MuaW5zdGFsbEJ5U2VsZWN0b3IoXHJcblx0XHRcdFx0KFxyXG5cdFx0XHRcdFx0J2lucHV0LicgKyBqc2MucHViLmxvb2t1cENsYXNzICsgJywgJyArXHJcblx0XHRcdFx0XHQnYnV0dG9uLicgKyBqc2MucHViLmxvb2t1cENsYXNzXHJcblx0XHRcdFx0KSxcclxuXHRcdFx0XHRyb290Tm9kZVxyXG5cdFx0XHQpO1xyXG5cdFx0fSBjYXRjaCAoZSkge31cclxuXHR9XHJcblxyXG5cdHJldHVybiBzdWNjZXNzO1xyXG59O1xyXG5cclxuXHJcbi8vIFJlZ2lzdGVycyBmdW5jdGlvbiB0byBiZSBjYWxsZWQgYXMgc29vbiBhcyBqc2NvbG9yIGlzIGluaXRpYWxpemVkIChvciBpbW1lZGlhdGVseSwgaWYgaXQgYWxyZWFkeSBpcykuXHJcbi8vXHJcbmpzYy5wdWIucmVhZHkgPSBmdW5jdGlvbiAoZnVuYykge1xyXG5cdGlmICh0eXBlb2YgZnVuYyAhPT0gJ2Z1bmN0aW9uJykge1xyXG5cdFx0Y29uc29sZS53YXJuKCdQYXNzZWQgdmFsdWUgaXMgbm90IGEgZnVuY3Rpb24nKTtcclxuXHRcdHJldHVybiBmYWxzZTtcclxuXHR9XHJcblxyXG5cdGlmIChqc2MuaW5pdGlhbGl6ZWQpIHtcclxuXHRcdGZ1bmMoKTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0anNjLnJlYWR5UXVldWUucHVzaChmdW5jKTtcclxuXHR9XHJcblx0cmV0dXJuIHRydWU7XHJcbn07XHJcblxyXG5cclxuLy8gVHJpZ2dlcnMgZ2l2ZW4gaW5wdXQgZXZlbnQocykgKGUuZy4gJ2lucHV0JyBvciAnY2hhbmdlJykgb24gYWxsIGNvbG9yIHBpY2tlcnMuXHJcbi8vXHJcbi8vIEl0IGlzIHBvc3NpYmxlIHRvIHNwZWNpZnkgbXVsdGlwbGUgZXZlbnRzIHNlcGFyYXRlZCB3aXRoIGEgc3BhY2UuXHJcbi8vIElmIGNhbGxlZCBiZWZvcmUganNjb2xvciBpcyBpbml0aWFsaXplZCwgdGhlbiB0aGUgZXZlbnRzIHdpbGwgYmUgdHJpZ2dlcmVkIGFmdGVyIGluaXRpYWxpemF0aW9uLlxyXG4vL1xyXG5qc2MucHViLnRyaWdnZXIgPSBmdW5jdGlvbiAoZXZlbnROYW1lcykge1xyXG5cdHZhciB0cmlnZ2VyTm93ID0gZnVuY3Rpb24gKCkge1xyXG5cdFx0anNjLnRyaWdnZXJHbG9iYWwoZXZlbnROYW1lcyk7XHJcblx0fTtcclxuXHJcblx0aWYgKGpzYy5pbml0aWFsaXplZCkge1xyXG5cdFx0dHJpZ2dlck5vdygpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHRqc2MucHViLnJlYWR5KHRyaWdnZXJOb3cpO1xyXG5cdH1cclxufTtcclxuXHJcblxyXG4vLyBIaWRlcyBjdXJyZW50IGNvbG9yIHBpY2tlciBib3hcclxuanNjLnB1Yi5oaWRlID0gZnVuY3Rpb24gKCkge1xyXG5cdGlmIChqc2MucGlja2VyICYmIGpzYy5waWNrZXIub3duZXIpIHtcclxuXHRcdGpzYy5waWNrZXIub3duZXIuaGlkZSgpO1xyXG5cdH1cclxufTtcclxuXHJcblxyXG4vLyBSZXR1cm5zIGEgZGF0YSBVUkwgb2YgYSBncmF5IGNoZXNzYm9hcmQgaW1hZ2UgdGhhdCBpbmRpY2F0ZXMgdHJhbnNwYXJlbmN5XHJcbmpzYy5wdWIuY2hlc3Nib2FyZCA9IGZ1bmN0aW9uIChjb2xvcikge1xyXG5cdGlmICghY29sb3IpIHtcclxuXHRcdGNvbG9yID0gJ3JnYmEoMCwwLDAsMCknO1xyXG5cdH1cclxuXHR2YXIgcHJldmlldyA9IGpzYy5nZW5Db2xvclByZXZpZXdDYW52YXMoY29sb3IpO1xyXG5cdHJldHVybiBwcmV2aWV3LmNhbnZhcy50b0RhdGFVUkwoKTtcclxufTtcclxuXHJcblxyXG4vLyBSZXR1cm5zIGEgZGF0YSBVUkwgb2YgYSBncmF5IGNoZXNzYm9hcmQgaW1hZ2UgdGhhdCBpbmRpY2F0ZXMgdHJhbnNwYXJlbmN5XHJcbmpzYy5wdWIuYmFja2dyb3VuZCA9IGZ1bmN0aW9uIChjb2xvcikge1xyXG5cdHZhciBiYWNrZ3JvdW5kcyA9IFtdO1xyXG5cclxuXHQvLyBDU1MgZ3JhZGllbnQgZm9yIGJhY2tncm91bmQgY29sb3IgcHJldmlld1xyXG5cdGJhY2tncm91bmRzLnB1c2goanNjLmdlbkNvbG9yUHJldmlld0dyYWRpZW50KGNvbG9yKSk7XHJcblxyXG5cdC8vIGRhdGEgVVJMIG9mIGdlbmVyYXRlZCBQTkcgaW1hZ2Ugd2l0aCBhIGdyYXkgdHJhbnNwYXJlbmN5IGNoZXNzYm9hcmRcclxuXHR2YXIgcHJldmlldyA9IGpzYy5nZW5Db2xvclByZXZpZXdDYW52YXMoKTtcclxuXHRiYWNrZ3JvdW5kcy5wdXNoKFtcclxuXHRcdCd1cmwoXFwnJyArIHByZXZpZXcuY2FudmFzLnRvRGF0YVVSTCgpICsgJ1xcJyknLFxyXG5cdFx0J2xlZnQgdG9wJyxcclxuXHRcdCdyZXBlYXQnLFxyXG5cdF0uam9pbignICcpKTtcclxuXHJcblx0cmV0dXJuIGJhY2tncm91bmRzLmpvaW4oJywgJyk7XHJcbn07XHJcblxyXG5cclxuLy9cclxuLy8gREVQUkVDQVRFRCBwcm9wZXJ0aWVzIGFuZCBtZXRob2RzXHJcbi8vXHJcblxyXG5cclxuLy8gREVQUkVDQVRFRC4gVXNlIGpzY29sb3IucHJlc2V0cy5kZWZhdWx0IGluc3RlYWQuXHJcbi8vXHJcbi8vIEN1c3RvbSBkZWZhdWx0IG9wdGlvbnMgZm9yIGFsbCBjb2xvciBwaWNrZXJzLCBlLmcuIHsgaGFzaDogdHJ1ZSwgd2lkdGg6IDMwMCB9XHJcbmpzYy5wdWIub3B0aW9ucyA9IHt9O1xyXG5cclxuXHJcbi8vIERFUFJFQ0FURUQuIFVzZSBkYXRhLWpzY29sb3IgYXR0cmlidXRlIGluc3RlYWQsIHdoaWNoIGluc3RhbGxzIGpzY29sb3Igb24gZ2l2ZW4gZWxlbWVudC5cclxuLy9cclxuLy8gQnkgZGVmYXVsdCwgd2UnbGwgc2VhcmNoIGZvciBhbGwgZWxlbWVudHMgd2l0aCBjbGFzcz1cImpzY29sb3JcIiBhbmQgaW5zdGFsbCBhIGNvbG9yIHBpY2tlciBvbiB0aGVtLlxyXG4vL1xyXG4vLyBZb3UgY2FuIGNoYW5nZSB3aGF0IGNsYXNzIG5hbWUgd2lsbCBiZSBsb29rZWQgZm9yIGJ5IHNldHRpbmcgdGhlIHByb3BlcnR5IGpzY29sb3IubG9va3VwQ2xhc3NcclxuLy8gYW55d2hlcmUgaW4geW91ciBIVE1MIGRvY3VtZW50LiBUbyBjb21wbGV0ZWx5IGRpc2FibGUgdGhlIGF1dG9tYXRpYyBsb29rdXAsIHNldCBpdCB0byBudWxsLlxyXG4vL1xyXG5qc2MucHViLmxvb2t1cENsYXNzID0gJ2pzY29sb3InO1xyXG5cclxuXHJcbi8vIERFUFJFQ0FURUQuIFVzZSBkYXRhLWpzY29sb3IgYXR0cmlidXRlIGluc3RlYWQsIHdoaWNoIGluc3RhbGxzIGpzY29sb3Igb24gZ2l2ZW4gZWxlbWVudC5cclxuLy9cclxuLy8gSW5zdGFsbCBqc2NvbG9yIG9uIGFsbCBlbGVtZW50cyB0aGF0IGhhdmUgdGhlIHNwZWNpZmllZCBjbGFzcyBuYW1lXHJcbmpzYy5wdWIuaW5zdGFsbEJ5Q2xhc3NOYW1lID0gZnVuY3Rpb24gKCkge1xyXG5cdGNvbnNvbGUuZXJyb3IoJ2pzY29sb3IuaW5zdGFsbEJ5Q2xhc3NOYW1lKCkgaXMgREVQUkVDQVRFRC4gVXNlIGRhdGEtanNjb2xvcj1cIlwiIGF0dHJpYnV0ZSBpbnN0ZWFkIG9mIGEgY2xhc3MgbmFtZS4nICsganNjLmRvY3NSZWYpO1xyXG5cdHJldHVybiBmYWxzZTtcclxufTtcclxuXHJcblxyXG5qc2MucmVnaXN0ZXIoKTtcclxuXHJcblxyXG5yZXR1cm4ganNjLnB1YjtcclxuXHJcblxyXG59KSgpOyAvLyBFTkQganNjb2xvclxyXG5cclxuXHJcbmlmICh0eXBlb2Ygd2luZG93LmpzY29sb3IgPT09ICd1bmRlZmluZWQnKSB7XHJcblx0d2luZG93LmpzY29sb3IgPSB3aW5kb3cuSlNDb2xvciA9IGpzY29sb3I7XHJcbn1cclxuXHJcblxyXG4vLyBFTkQganNjb2xvciBjb2RlXHJcblxyXG5yZXR1cm4ganNjb2xvcjtcclxuXHJcbn0pOyAvLyBFTkQgZmFjdG9yeVxyXG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./js/jscolor/jscolor.js\n");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The require scope
/******/ 	var __webpack_require__ = {};
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module can't be inlined because the eval-source-map devtool is used.
/******/ 	var __webpack_exports__ = {};
/******/ 	__webpack_modules__["./js/jscolor/jscolor.js"](0, __webpack_exports__, __webpack_require__);
/******/ 	
/******/ })()
;